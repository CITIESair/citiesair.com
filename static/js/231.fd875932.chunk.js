"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[231],{66231:(t,e,r)=>{r.r(e),r.d(e,{default:()=>M});var n=r(72791),a=r(57689),i=r(31781),s=r(84852),o=r(49900),c=r(20890),l=r(61889),u=r(36314),h=r(697),d=r(90493),f=r(52069),p=r(56593);const g=t=>{const e="screen",r=t.split(e);return"".concat(e).concat(r.pop())};var m=r(29019),x=r(44709),v=(r(30604),r(64377)),y=r(30970),j=r(62564),b=r(80184);const w=t=>{const{data:e}=t,r=(0,j.u)(),a=(0,n.useRef)(),i=(0,n.useRef)(),s=(0,n.useRef)(),o=(0,n.useRef)(),c=(0,n.useRef)();let l,u,d,f,g,w=200;const S=30,Z=80,k=70,R=m.jvg().x((function(t){return f(t.timestamp)})).y((function(t){return g(t.aqi.val)})).curve(m.YY7.tension(0));return(0,n.useEffect)((()=>{if(!e)return;if(!a.current)return;if(!i.current)return;if(!s.current)return;if(!o.current)return;if(!c.current)return;l=m.Ys(a.current),u=a.current.clientWidth,d=a.current.clientHeight-S,m.Ys(i.current).selectAll("*").remove(),m.Ys(s.current).selectAll("*").remove(),m.Ys(o.current).selectAll("*").remove(),m.Ys(c.current).selectAll("*").remove(),m.Ys(i.current).attr("opacity",.5),m.Ys(s.current).attr("filter","brightness(0.8) contrast(1.2) saturate(1.2)"),Object.entries(e).forEach((t=>{var e;let[r,n]=t;if(null===(e=n.historical)||void 0===e||e.forEach((function(t){t.timestamp=new Date(t.timestamp)})),n.historical&&Array.isArray(n.historical)){const t=m.Fp7(n.historical,(function(t){return t.aqi.val}));t>w&&(w=t)}})),w=50*Math.ceil(w/50);for(let e of x._R)if(w>=e.aqiUS.low&&w<=e.aqiUS.high){w=e.aqiUS.high===1/0?w:e.aqiUS.high;break}let t=new Date,n=new Date;n.setHours(n.getHours()-6),f=m.Xf().domain([n,t]).rangeRound([k,u-Z]),g=m.BYU().domain([0,w]).range([d+S,S]);let h=Math.max(Math.floor((x._R[1].aqiUS.high-x._R[0].aqiUS.high)/w*d/2),20),j=Math.floor(h/5);for(let e=0;e<x._R.length;e++){const t=x._R[e],r=t.aqiUS.high===1/0?w:t.aqiUS.high,n=t.aqiUS.low;if(w<=n)break;const a=50*Math.ceil((r-n)/50);m.Ys(i.current).append("rect").attr("x",0).attr("y",d-r/w*d+S).attr("width",u).attr("height",a/w*d).attr("fill",t.color.Light),m.Ys(s.current).append("text").attr("x",j).attr("y",d-t.aqiUS.low/w*d-3.5*j+S).attr("fill",t.color.Light).attr("font-size",h).text(50*Math.floor(t.aqiUS.low/50)),m.Ys(s.current).append("text").attr("class","category-text-graph-sm").attr("x",j+2).attr("y",d-t.aqiUS.low/w*d-j+S).attr("fill",t.color.Light).attr("font-size",h/2).text(t.category)}m.Ys(o.current).append("rect").attr("x",0).attr("y",0).attr("width",u).attr("height",S).attr("fill","white");let b=m.i$Z("%H:%M");m.Ys(o.current).append("g").attr("transform","translate(0,".concat(S,")")).call(m.F5q(f).tickSize(-d).ticks(m.Z_i.every(120)).tickFormat((function(t){return b(t)}))).attr("font-size",d/20).attr("color",y.WW.screen).select(".domain").remove(),m.Ys(o.current).selectAll("line").attr("stroke","white").attr("stroke-width",2).attr("opacity",.5),Object.entries(e).forEach((t=>{var e,n,a;let[i,s]=t;m.Ys(c.current).append("path").datum(s.historical||[]).attr("x",k).attr("class","line").attr("d",R).attr("fill","transparent").attr("stroke","black").attr("stroke-width","5px").attr("opacity","outdoors"===(null===(e=s.sensor)||void 0===e?void 0:e.location_type)?1:.5);const o=(null===(n=s.historical)||void 0===n?void 0:n.length)>0?null===(a=s.historical)||void 0===a?void 0:a[0]:null;if(o&&o.aqi.val&&o.timestamp){var l,u,h,x;const t=m.Ys(c.current).append("g").attr("transform","translate("+f(o.timestamp)+","+g(o.aqi.val)+")").attr("fill",null!==s&&void 0!==s&&null!==(l=s.current)&&void 0!==l&&l.category?r.palette.text.aqi[s.current.category]:y.WW.screen);(null===(u=s.sensor)||void 0===u?void 0:u.sensor_status)===p.vI.active&&t.append("circle").attr("cx",0).attr("cy",0).attr("filter","brightness(0.5)").attr("class","pulse-ring").attr("r",25),t.append("circle").attr("cx",0).attr("cy",0).attr("stroke","#666").attr("class",(null===(h=s.sensor)||void 0===h?void 0:h.sensor_status)===p.vI.active&&"pulse-dot").attr("r",10),t.append("text").attr("class","location-label").attr("x",15).attr("y",0).attr("fill","black").attr("alignment-baseline","middle").attr("text-anchor","left").attr("font-size",d/25).text((0,v.Fb)(null===(x=s.sensor)||void 0===x?void 0:x.location_short));const e=document.getElementsByClassName("location-label");for(let r=1;r<e.length;r++){const t=e[r-1],n=e[r],a=(j=t.getBoundingClientRect(),b=n.getBoundingClientRect(),j.bottom<b.top||j.top>b.bottom?0:j.top<b.top?-1:1);0!==a&&(t.setAttribute("y",10*a),n.setAttribute("y",10*-a))}}var j,b}))}),[e]),(0,b.jsx)(h.Z,{sx:{"& .pulse-ring":{animation:"pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite","@keyframes pulse-ring":{"0%":{transform:"scale(0.2)"},"80%":{},"100%":{opacity:0}}},"& .pulse-dot":{animation:"pulse-dot 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite","@keyframes pulse-dot":{"0%":{transform:"scale(0.5)"},"50%":{transform:"scale(1)",filter:"brightness(1.2) contrast(1.2) saturate(1.2)"},"100%":{transform:"scale(0.5)"}}}},width:"100%",height:"100%",children:(0,b.jsxs)("svg",{id:"recent-historical-graph",width:"100%",height:"100%",ref:a,children:[(0,b.jsx)("g",{ref:i}),(0,b.jsx)("g",{ref:o}),(0,b.jsx)("g",{ref:s}),(0,b.jsx)("g",{ref:c})]})})};var S=r(80925),Z=r(1414),k=r(87505),R=r(63867),q=r(47896),I=r(41009),P=r(85332),U=r(19132),Y=r(41212);function _(t){const e=new URLSearchParams(t.search).get("displayHours");if(!e)return!0;const[r,n]=e.split("-").map((t=>parseInt(t.replace(":",""),10))),a=parseInt((new Date).toTimeString().slice(0,5).replace(":",""),10);return r<=n?r<=a&&a<n:a>=r||a<n}const M=t=>{let{title:e}=t;const{temperatureUnitPreference:r,themePreference:m}=(0,n.useContext)(U.p),{user:v}=(0,n.useContext)(i.S),j=(0,a.s0)(),M=(0,a.TH)(),C=M.pathname,[A,W]=(0,n.useState)(_(M));(0,n.useEffect)((()=>{const t=setInterval((()=>{W(_(M))}),6e4);return()=>clearInterval(t)}),[]),(0,n.useEffect)((()=>{document.title=e}),[e]);const[F,z]=(0,n.useState)(),[E,L]=(0,n.useState)({});(0,n.useEffect)((()=>{function t(){return 0!==[0,0,1,1,0,0,1,1,0,0,1,1][(new Date).getMonth()]}z(t());const e=setInterval((()=>{z(t())}),864e5);return()=>{clearInterval(e)}}),[]),(0,n.useEffect)((()=>{if(!1!==v.checkedAuthentication){if(!0===v.authenticated){if(0!=Object.keys(E).length)return;const t=(0,R.kG)({endpoint:q.eV.screen});if(!t)return;(0,I.m)(t).then((t=>{L(t)})).catch((t=>{console.log(t)}));const e=setInterval((()=>{(0,I.m)(t).then((t=>{L(t)})).catch((t=>console.log(t)))}),3e5);return()=>{clearInterval(e)}}j("".concat(P.$.login,"?").concat(P.$.redirectQuery,"=").concat(C))}}),[v]);const D=()=>{if(!Object.values(E).every((t=>{var e;return(null===(e=t.sensor)||void 0===e?void 0:e.sensor_status)===p.vI.active})))return null;let t,e;for(let i=0;i<Object.values(E).length;i++){var r;const n=Object.values(E)[i];if("outdoors"===(null===(r=n.sensor)||void 0===r?void 0:r.location_type)){if(t=n.current.aqi,t<=x._R[0].aqiUS.high)return null}else e=n.current.aqi}const n=t/e;let a;if(n>=2)a="".concat(parseFloat(n).toFixed(1)," times");else{if(!(n>1.2))return null;a="".concat(Math.round((t-e)/e*100),"%")}return(0,b.jsx)(s.ZP,{children:(0,b.jsx)(o.Z,{primary:(0,b.jsxs)(b.Fragment,{children:["Indoors air is",(0,b.jsx)(c.Z,{component:"span",color:"".concat(x._R[0].color[m]," !important"),children:" ".concat(a," ")}),"better than outdoors"]})})})};return A?(0,b.jsxs)(l.ZP,{container:!0,alignContent:"stretch",alignItems:"stretch",height:"100vh",sx:{overflow:"hidden",background:"white","& *":{fontWeight:"500 !important"},"& .condensedFont":{fontFamily:"IBM Plex Sans Condensed, sans-serif !important","& *":{fontFamily:"IBM Plex Sans Condensed, sans-serif !important"}},"& .flashingRed":{"& .MuiTypography-root ":{color:"".concat(x._R[3].color.Light," !important"),opacity:.8},color:"".concat(x._R[3].color.Light," !important"),animation:"flashingRed 3s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite","@keyframes flashingRed":{"0%":{opacity:1},"50%":{opacity:.5},"100%":{opacity:1}}}},children:[(0,b.jsx)(l.ZP,{item:!0,xs:6,sx:{py:3,px:2,order:F?1:0,background:"#212529"},children:(0,b.jsxs)(u.Z,{direction:"column",justifyContent:"space-between",height:"100%",textAlign:"center",children:[(0,b.jsxs)(h.Z,{children:[(0,b.jsx)(c.Z,{variant:"h3",fontWeight:"500",color:"white",children:"AIR QUALITY INDEX"}),(0,b.jsx)(c.Z,{variant:"h4",className:"condensedFont",color:y.WW.screen,children:"Particulate Matter PM2.5"})]}),(0,b.jsx)(l.ZP,{container:!0,justifyContent:"space-around",children:(0,b.jsx)(Z.Z,{currentSensorsData:E,temperatureUnitPreference:r,isScreen:!0,size:k.l.large})}),(0,b.jsxs)(d.Z,{className:"condensedFont",sx:{listStyleType:"disclosure-closed","& .MuiTypography-root":{fontSize:"1.5rem"},"& .MuiListItem-root":{display:"list-item",ml:3,p:0,pr:3},"& .MuiTypography-root, .MuiListItem-root":{color:y.WW.screen}},children:[(0,b.jsx)(D,{}),Object.entries(E).map((t=>{var e,r,n;let[a,i]=t;return(null===(e=i.current)||void 0===e?void 0:e.healthSuggestion)&&(0,b.jsx)(s.ZP,{className:(null===(r=i.current)||void 0===r?void 0:r.aqi)>=x._R[2].aqiUS.low?"flashingRed":"",children:(0,b.jsx)(o.Z,{primary:null===(n=i.current)||void 0===n?void 0:n.healthSuggestion})},a)}))]})]})}),(0,b.jsxs)(l.ZP,{item:!0,xs:6,sx:{order:F?0:1},children:[(0,b.jsx)(h.Z,{sx:{position:"absolute",top:0,right:!F&&0,left:F&&0,width:"5vw",height:"5vw",m:1},children:(0,b.jsx)(f.Z,{})}),(0,b.jsxs)(l.ZP,{container:!0,alignContent:"space-between",justifyContent:"center",height:"100%",textAlign:"center",children:[(0,b.jsx)(l.ZP,{item:!0,xs:12,sx:{pt:3,px:2},children:(0,b.jsx)(c.Z,{variant:"h3",fontWeight:"500",sx:{color:"black"},children:Y.DE})}),(0,b.jsx)(l.ZP,{item:!0,xs:2,children:(0,b.jsx)(h.Z,{height:"auto",width:"100%",children:(0,b.jsx)(S.ZP,{size:256,style:{height:"auto",maxWidth:"100%",width:"100%"},value:"".concat((B=document.location.href,new URL(B).hostname),"?source=").concat(g(document.location.href)),viewBox:"0 0 256 256"})})}),(0,b.jsx)(l.ZP,{item:!0,xs:12,height:"70%",className:"condensedFont",sx:{"& *":{fontWeight:"600 !important"}},children:(0,b.jsx)(w,{data:E})})]})]})]}):(0,b.jsx)(l.ZP,{container:!0,alignContent:"stretch",alignItems:"stretch",height:"100vh",sx:{overflow:"hidden",background:"black"}});var B}}}]);
//# sourceMappingURL=231.fd875932.chunk.js.map