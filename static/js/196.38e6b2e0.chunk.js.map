{"version":3,"file":"static/js/196.38e6b2e0.chunk.js","mappings":"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","sources":["hooks/useSchoolMetadata.jsx","Components/UppercaseTitle.jsx","Components/AirQuality/AirQualityIndexTable.jsx","Components/ExpandableSection/ExpandableSection.jsx","Graphs/Subchart/SubchartUtils/SeriesSelector.jsx","Graphs/GoogleChartHelper.jsx","Utils/Gradient/GradientUtils.jsx","Graphs/Subchart/NivoCharts/NivoCalendarChart/ValueRangeBox.jsx","Graphs/Subchart/NivoCharts/NivoCalendarChart/TooltipCalendarChart.jsx","Graphs/Subchart/NivoCharts/NivoChartHelper.jsx","Graphs/Subchart/NivoCharts/NivoCalendarChart/NivoCalendarChart.jsx","Components/DateRangePicker/DateRangePickerUtils.jsx","Components/DateRangePicker/AggregationTypeToggle.jsx","hooks/useChartData.jsx","Components/DateRangePicker/CustomDateRangePicker.jsx","ContextProviders/AxesPickerContext.jsx","Components/AxesPicker/AxesPicker.jsx","Graphs/Subchart/NoChartToRender.jsx","Components/TimeRange/TimeRangeUtils.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/SimplePicker.jsx","Components/TimeRange/TimeRangeSelector.jsx","Components/TimeRange/TimeRangeSelectorWrapperForDataHook.jsx","Graphs/Subchart/SubChart.jsx","Components/CollapsibleSubtitle.jsx","Graphs/DataTypeDropDown.jsx","Components/StyledTabs.jsx","Graphs/ChartComponentWrapper.jsx","Components/AirQuality/AirQualityIndexLegendQuickGlance.jsx","Components/AirQuality/AirQualityScreen/ScreenDropDownMenu.jsx","Components/CustomDialog/CustomDialog.jsx","Components/Account/useLoginHandler.jsx","hooks/useDatasetDownload.jsx","Components/DatasetDownload/DatasetDownloadDialog.jsx","Components/AirQuality/AirQualityAlerts/EmailsInput.jsx","Components/AirQuality/AirQualityAlerts/AlertTypes.jsx","Components/AirQuality/AirQualityAlerts/AlertUtils.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertDeletionDialog.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/DialogData.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/OptionalMessage.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/DAYS_OF_WEEK.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/MultiDaysCalendarPicker.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/DaySelector.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/ThresholdAlertComponents/ThresholdSlider.jsx","ContextProviders/AirQualityAlertContext.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/ThresholdAlertComponents/ThresholdComponentWrapper.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/MaxOnceADayCheckbox.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/ThresholdAlertComponents/ThresholdTypeToggle.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/AlertPropertyComponents.jsx","hooks/alerts/useEditAlertMutation.jsx","Components/AirQuality/AirQualityAlerts/AlertModificationDialog/AlertModificationDialog.jsx","hooks/alerts/useCreateAlertMutation.jsx","hooks/alerts/useDeleteAlertMutation.jsx","Components/AirQuality/AirQualityAlerts/AlertsTable.jsx","Components/AirQuality/AirQualityAlerts/AlertsTabs.jsx","hooks/alerts/useAlerts.jsx","Components/AirQuality/AirQualityAlerts/AirQualityAlert.jsx","Components/Account/LoginPopupHandler.jsx","Pages/Project/ProjectReservedArea.jsx","Components/CustomChip.jsx","Components/SchoolSelector.jsx","Pages/Project/GridOfMetadataChips.jsx","Pages/Project/ProjectDescription.jsx","Pages/Project/LoadMoreButton.jsx","Pages/Project/Project.jsx","Pages/Dashboard.jsx","Components/AirQuality/AQIexplanation.jsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\nimport { useContext } from 'react';\n\nimport { fetchDataFromURL } from '../API/ApiFetch';\nimport { DashboardContext } from '../ContextProviders/DashboardContext';\nimport { getApiUrl } from '../API/ApiUrls';\nimport { GeneralAPIendpoints } from '../API/Utils';\n\nconst useSchoolMetadata = () => {\n    const { currentSchoolID } = useContext(DashboardContext);\n\n    return useQuery({\n        queryKey: [GeneralAPIendpoints.schoolmetadata, currentSchoolID],\n        queryFn: async () => {\n            const url = getApiUrl({\n                paths: [GeneralAPIendpoints.schoolmetadata, currentSchoolID]\n            });\n\n            return fetchDataFromURL({ url });\n        },\n        enabled: !!currentSchoolID, // only run when ready\n        staleTime: 1000 * 60 * 60, // 1-hour cache,\n        placeholderData: (prev) => prev // Keep data from previous queryKey to avoid flashing charts\n    });\n}\n\nexport default useSchoolMetadata;","import { Skeleton, Typography } from '@mui/material';\n\nexport default function UppercaseTitle({ text, sx, ...otherProps }) {\n  return (\n    <Typography\n      variant=\"h4\"\n      color=\"text.primary\"\n      sx={{\n        fontWeight: 'medium',\n        display: 'block',\n        textTransform: 'uppercase',\n        pb: 3,\n        lineHeight: 1,\n        ...sx\n      }}\n      {...otherProps}\n    >\n      {text || <Skeleton variant='text' />}\n    </Typography>\n  );\n}\n","import { Box, Table, TableBody, TableCell, TableHead, TableRow, styled } from '@mui/material';\nimport parse from 'html-react-parser';\nimport { getTranslation, replacePlainHTMLWithMuiComponents } from '../../Utils/UtilFunctions';\nimport { AQI_Database } from '../../Utils/AirQuality/AirQualityIndexHelper';\nimport { useContext } from 'react';\nimport { PreferenceContext } from '../../ContextProviders/PreferenceContext';\nimport { CITIESair } from '../../Utils/GlobalVariables';\n\nexport const StyledTable = styled(Table, {\n  shouldForwardProp: (prop) => prop !== 'tiny',\n})(({ theme, tiny }) => ({\n  minWidth: tiny || 700,\n  '& th, td': {\n    fontSize: tiny ? '0.625rem' : '0.6875rem',\n    color: theme.palette.text.secondary,\n    [theme.breakpoints.down('sm')]: {\n      fontSize: tiny ? '0.5rem' : '0.6875rem',\n    },\n  },\n  '& th': {\n    fontWeight: 500,\n    color: theme.palette.text.primary,\n    lineHeight: '1rem'\n  }\n}));\n\nfunction AirQualityIndexTable(props) {\n  const { themePreference, language } = useContext(PreferenceContext);\n\n  const { tiny, hideAQIDescription } = props;\n\n  const returnFormattedBreakpoints = (low, high) => {\n    if (high === Infinity) return `${low}+`;\n    else return `${low} - ${high}`;\n  }\n\n  return (\n    <>\n      <Box overflow=\"auto\">\n        <StyledTable size=\"small\" tiny={tiny}>\n          <TableHead>\n            <TableRow>\n              <TableCell sx={{ pr: 0 }}>\n                <Box sx={{ width: '1em', height: '1em' }} />\n              </TableCell>\n              <TableCell sx={{ pl: 1 }}>\n                Category\n              </TableCell>\n              <TableCell align=\"right\">US AQI</TableCell>\n              <TableCell align=\"right\">\n                PM2.5\n                (g/m\n                <sup>3</sup>\n                )\n              </TableCell>\n              {!hideAQIDescription && <TableCell align=\"left\">Description</TableCell>}\n\n              {!hideAQIDescription &&\n                <TableCell align=\"left\">\n                  {CITIESair}&apos; Suggested Actions\n                </TableCell>\n              }\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {AQI_Database.map((element, index) => (\n              <TableRow\n                key={index}\n                sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\n              >\n                <TableCell sx={{ pr: 0 }}>\n                  <Box sx={{ width: '1em', height: '1em', backgroundColor: element.color[themePreference] }} />\n                </TableCell>\n                <TableCell sx={{ pl: 1 }}>\n                  {getTranslation(element.category, language)}\n                </TableCell>\n                <TableCell align=\"right\" sx={{ whiteSpace: \"nowrap\" }}>\n                  {returnFormattedBreakpoints(element.aqiUS.low, element.aqiUS.high)}\n                </TableCell>\n                <TableCell align=\"right\" sx={{ whiteSpace: \"nowrap\" }}>\n                  {returnFormattedBreakpoints(element.rawPM2_5.low, element.rawPM2_5.high)}\n                </TableCell>\n                {!hideAQIDescription && <TableCell align=\"left\">{element.description}</TableCell>}\n                {!hideAQIDescription\n                  && (\n                    <TableCell align=\"left\">\n                      {\n                        parse(getTranslation(element.healthSuggestions.outdoors, language), {\n                          replace: replacePlainHTMLWithMuiComponents,\n                        })\n                      }\n                    </TableCell>\n                  )}\n              </TableRow>\n            ))}\n          </TableBody>\n        </StyledTable>\n      </Box>\n    </>\n  );\n}\n\nexport default AirQualityIndexTable;\n","// disable eslint for this file\n/* eslint-disable */\nimport { useState } from 'react';\nimport { styled } from '@mui/material/styles';\n\nimport MuiAccordion from '@mui/material/Accordion';\nimport MuiAccordionSummary from '@mui/material/AccordionSummary';\nimport MuiAccordionDetails from '@mui/material/AccordionDetails';\nimport { Box, Typography, Tooltip } from '@mui/material';\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\nimport * as Tracking from '../../Utils/Tracking';\n\nconst StyledAccordion = styled(MuiAccordion)(({ theme, expanded }) => ({\n  color: theme.palette.text.secondary,\n  backgroundImage: 'none',\n  backgroundColor: expanded ? theme.palette.background.default : 'transparent',\n  boxShadow: expanded ? theme.shadows : 'none',\n  transition: 'none',\n}));\n\nconst StyledAccordionSummary = styled(MuiAccordionSummary)(({ theme, expanded }) => ({\n  marginTop: expanded ? theme.spacing(1) : 0,\n  flexDirection: 'row-reverse',\n  paddingLeft: expanded ? theme.spacing(1) : 0,\n  '& .MuiTypography-root': {\n    color: theme.palette.text.primary,\n    textDecoration: 'underline',\n    transition: 'none',\n    '&:hover': {\n      color: theme.palette.primary.main,\n    },\n  },\n  '& .MuiAccordionSummary-content.Mui-expanded': {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  }\n}));\n\nconst TooltipText = {\n  expand: \"Click to expand section\",\n  collapse: \"Click to collapse section\"\n}\n\nconst ExpandableSection = (props) => {\n  const { title, content, icon, disabled } = props;\n  const [expanded, setExpanded] = useState(undefined);\n\n  const handleAccordionChange = (panel) => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : undefined);\n    Tracking.sendEventAnalytics(\n      isExpanded ? Tracking.Events.expandSection : Tracking.Events.collapseSection,\n      {\n        section: title\n      }\n    );\n  };\n\n  return (\n    <Box sx={{\n      '& .MuiAccordion-root.Mui-disabled': {\n        backgroundColor: \"transparent\"\n      }\n    }}>\n      <StyledAccordion\n        expanded={expanded === \"panel1\"}\n        onChange={handleAccordionChange(\"panel1\")}\n        disabled={disabled}\n      >\n        <StyledAccordionSummary expanded={expanded} expandIcon={<ArrowDropDownIcon />} aria-controls=\"panel1a-content\" id=\"panel1a-header\">\n          <Tooltip title={expanded ? TooltipText.collapse : TooltipText.expand} enterDelay={0} leaveDelay={200}>\n            <Typography component=\"a\" variant=\"body1\">\n              {title}\n              <Box component=\"span\" sx={{ ml: 0.25 }}>\n                {icon}\n              </Box>\n            </Typography>\n          </Tooltip>\n        </StyledAccordionSummary>\n        <MuiAccordionDetails sx={{ pt: 0 }}>\n          {content}\n        </MuiAccordionDetails>\n      </StyledAccordion>\n    </Box>\n  );\n}\n\nexport default ExpandableSection;","/* eslint-disable */\nimport { useState, useEffect } from 'react';\nimport { Stack, Grid, MenuItem, FormControl, Select, Chip, Radio, Checkbox, Typography, Switch, useMediaQuery } from \"@mui/material\";\nimport { useTheme } from '@mui/material/styles';\n\nimport VisibilityIcon from '@mui/icons-material/Visibility';\n\nconst SELECT_ALL = 'Show All Sensors';\n\nconst ITEM_HEIGHT = 48;\nconst ITEM_PADDING_TOP = 8;\n\nexport default function SeriesSelector(props) {\n  const { items: itemsFromChart,\n    selectorID,\n    allowMultiple,\n    seriesLabel,\n    onSeriesSelection,\n    displayChip = true\n  } = props;\n\n  const theme = useTheme();\n  const isLargeScreen = useMediaQuery(theme => theme.breakpoints.up('lg'));\n\n  const MenuProps = {\n    PaperProps: {\n      style: {\n        maxHeight: ITEM_HEIGHT * 5.55 + ITEM_PADDING_TOP,\n        overflow: 'visible !important',\n        background: theme.palette.customAlternateBackground\n      }\n    },\n    anchorOrigin: {\n      vertical: \"bottom\",\n      horizontal: \"left\"\n    },\n    transformOrigin: {\n      vertical: \"top\",\n      horizontal: \"left\"\n    },\n    getContentAnchorEl: null\n  };\n\n  const [items, setItems] = useState(itemsFromChart);\n  const [selectAll, setSelectAll] = useState(allowMultiple); // default: all is selected if multiSelect is true\n\n  // When parent/props change, reconcile selections:\n  // - If the incoming item has an explicit `selected` boolean, prefer it (parent-controlled change).\n  // - Otherwise preserve the previous selection for matching labels.\n  useEffect(() => {\n    setItems(prevItems => {\n      const prevMap = new Map(prevItems.map(i => [i.label, i.selected]));\n      return itemsFromChart.map(newIt => {\n        const incomingHasSelected = typeof newIt.selected === 'boolean';\n        if (incomingHasSelected) {\n          // Prefer parent's selection (keeps component in sync when parent updates selection)\n          return { ...newIt };\n        } else {\n          // No explicit selected flag from parent  preserve previous selection if available\n          return { ...newIt, selected: prevMap.has(newIt.label) ? prevMap.get(newIt.label) : !!newIt.selected };\n        }\n      });\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [itemsFromChart])\n\n  useEffect(() => {\n    setSelectAll(items.every(item => item.selected)); // set selectAll if all items are selected\n  }, [items]);\n\n  const handleChange = (event) => {\n    // Get the array of the currently selected value(s)\n    const {\n      target: { value }\n    } = event;\n\n    // If the current selection has SELECT_ALL\n    // Behavior:\n    // - If SELECT_ALL is being selected now, then set all items to selected\n    // - IF SELECT_ALL is being de-selected now, then set all items but the first one to be unselected \n    // (to make sure there's always at least 1 item being selected)\n    if (value.includes(SELECT_ALL)) {\n      const updatedItems = items.map((item, index) => ({ ...item, selected: index == 0 ? true : !selectAll }));\n      onSeriesSelection({ newDataColumns: updatedItems });\n      setSelectAll(!selectAll);\n    }\n    // Else, if an ordinary item is selected/de-selected:\n    else {\n      const selectedItems = items.filter(item => value.includes(item.label));\n      const updatedItems = items.map(item => ({\n        ...item,\n        selected: selectedItems.some(selectedItem => selectedItem.label === item.label)\n      }));\n      onSeriesSelection({ newDataColumns: updatedItems });\n      setSelectAll(false);\n    }\n  };\n\n  const handleItemToggle = (item) => {\n    const updatedItems = items.map(existingItem =>\n      existingItem.label === item.label ? { ...existingItem, selected: !existingItem.selected } : existingItem\n    );\n    onSeriesSelection({ newDataColumns: updatedItems });\n  };\n\n  const renderedLabel = (selected) => {\n    const returnNumSeriesDisplayed = () => {\n      return `${selected.length}/${items.length} ${seriesLabel || \"\"} shown`;\n    };\n\n    return (\n      <Stack direction=\"row\" alignItems=\"center\" spacing={0.5}>\n        <VisibilityIcon fontSize=\"1.5rem\" sx={{ color: theme.palette.text.secondary }} />\n        <Typography variant=\"caption\" color=\"text.secondary\">\n          {/* show # of series selected if multiSelect. show cur selected serie if singleSelect */}\n          {allowMultiple ? returnNumSeriesDisplayed() : selected}\n        </Typography>\n      </Stack>\n    );\n  };\n\n  return (\n    <Stack direction=\"column\" alignItems=\"stretch\" gap={0.5} width=\"100%\">\n      {\n        isLargeScreen ? <Typography color=\"text.secondary\" sx={{ textTransform: \"uppercase\" }}>Show/Hide</Typography> : null\n      }\n\n      <Stack spacing={1} direction=\"row\" alignItems=\"center\">\n        <FormControl\n          sx={{\n            width: \"100%\",\n            minWidth: '10rem',\n            '& .MuiInputBase-root': { borderRadius: `${theme.shape.borderRadius}px` }\n          }}\n          size=\"small\"\n        >\n          <Select\n            labelId={`${selectorID}-label`}\n            id={selectorID}\n            multiple={allowMultiple}\n            value={items.filter(item => item.selected).map(item => item.label)}\n            onChange={handleChange}\n            MenuProps={MenuProps}\n            renderValue={(selected) => renderedLabel(selected)}\n            sx={{\n              fontSize: '0.75em',\n              '& .MuiSelect-select': { py: \"6.5px\" },\n              '& .MuiSvgIcon-root': { color: 'text.secondary' }\n            }}\n          >\n            {/* Display all available items, together with checkbox for each item to select from */}\n            {items.map((item) => (\n              <MenuItem\n                disabled={\n                  // If there is only 1 selected item and this is the selected item\n                  // Then, prevent user from de-select this item too\n                  // To ensure at least there is 1 selected item at all times\n                  (items.filter(item => item.selected).length === 1 && item.selected) ? true : false\n                }\n                key={item.label}\n                value={item.label}\n                sx={{\n                  backgroundColor: 'unset !important',\n                  \"&:hover\": {\n                    backgroundColor: 'inherit !important',\n                  }\n                }}\n              >\n                { /* checkboxes for MultiSelect, radioButtons for singleSelect*/}\n                {allowMultiple ? <Checkbox\n                  checked={item.selected}\n                  onClick={() => handleItemToggle(item)}\n\n                  sx={{ p: 0.25, transform: 'scale(0.8)' }} />\n                  : <Radio\n                    checked={item.selected}\n                    onChange={() => handleChange(item)}\n\n                    sx={{ p: 0.25, transform: 'scale(0.8)' }} />\n                }\n                <Typography variant='caption'>{item.label}</Typography>\n              </MenuItem>\n            ))}\n\n            {/* Show the option to select all if multiSelect is true*/}\n            {allowMultiple ?\n              (\n                <MenuItem\n                  key={SELECT_ALL}\n                  value={SELECT_ALL}\n                  sx={{\n                    borderTop: 'solid 0.5px', borderColor: theme.palette.text.secondary,\n                    position: 'sticky', bottom: 0, zIndex: 1, marginBottom: theme.spacing(-1),\n                    background: theme.palette.customAlternateBackground,\n                    \"&:hover\": {\n                      background: theme.palette.customAlternateBackground\n                    }\n                  }}\n                >\n                  <Stack direction='row' width='100%' alignItems='center' justifyContent='space-between'>\n                    <Typography fontWeight={500} variant='caption' sx={{ pl: 1 }}>{SELECT_ALL}</Typography>\n                    <Switch\n                      checked={selectAll}\n                      onClick={() => handleItemToggle(SELECT_ALL)}\n                      sx={{ transform: 'scale(0.8)' }}\n                    />\n                  </Stack>\n                </MenuItem>\n              ) : null\n            }\n          </Select>\n        </FormControl>\n\n        {/* Display only selected items in the Grids, and only in landscape mode and if multiSelect is true*/}\n        {(displayChip && allowMultiple) && <Grid container spacing={1}\n          sx={{\n            [theme.breakpoints.down('sm')]: {\n              display: 'none'\n            },\n          }}\n        >\n          {items.filter(item => item.selected).map((item) => (\n            <Grid item key={item.label}>\n              <Chip\n                label={<Typography variant='caption'>{item.label}</Typography>}\n                size=\"small\"\n                {...(items.filter(item => item.selected).length !== 1 && { onDelete: () => handleItemToggle(item) })}\n              />\n            </Grid>\n          ))}\n        </Grid>}\n      </Stack>\n    </Stack>\n  );\n}\n","/* eslint-disable */\n\n// Function to generate a random ID for the google chart container\nexport const generateRandomID = () => {\n  return Math.random().toString(36).substr(2, 9); // Generates a random string of length 9\n}\n\n// -------- Chart options --------\n\nconst hideAnnotations = {\n  stem: {\n    length: 0,\n  },\n  textStyle: {\n    opacity: 0,\n  },\n  boxStyle: null,\n};\n\nconst returnResponsiveFontSizeInPixels = ({ isPortrait, isSmaller }) => {\n  return (\n    isSmaller ? (isPortrait ? 6 : 8) : (isPortrait ? 8 : 10)\n  );\n}\n\nexport const returnGenericOptions = (props) => {\n  const { chartData, subchartIndex, isPortrait, theme } = props;\n\n  // Define some shared styling rules for the chart\n  const axisTitleTextStyle = {\n    italic: false,\n    bold: true,\n    color: theme.palette.chart.axisTitle,\n    fontSize: returnResponsiveFontSizeInPixels({ isPortrait })\n  };\n  const axisTextStyle = {\n    color: theme.palette.chart.axisText,\n    fontSize: returnResponsiveFontSizeInPixels({ isPortrait })\n  };\n\n  // ---- Formulate the options for this specific chart:\n  // 1. Populate first with subchart's options (if any)\n  let options = chartData.subcharts?.[subchartIndex]?.options\n    ? { ...chartData.subcharts[subchartIndex].options }\n    : {};\n\n  // 2. Append own chart's options and then populate with universal options for all charts\n  options = {\n    ...options,\n    ...chartData.options,\n    theme: 'material',\n    curveType: options.curveType || chartData.options?.curveType || 'function',\n    crosshair: { orientation: 'both', trigger: 'focus', opacity: 0.5 },\n    backgroundColor: { fill: chartData.options?.backgroundColor?.fill || 'transparent' },\n    chartArea: {\n      ...chartData.options?.chartArea,\n      width: isPortrait ? (chartData.options?.chartArea?.width?.portrait || '80%') : (chartData.options?.chartArea?.width?.landscape || '80%'),\n      height: isPortrait ? (chartData.options?.chartArea?.height?.portrait || '60%') : (chartData.options?.chartArea?.height?.landscape || '80%'),\n      top: !isPortrait && 20\n    },\n    width: isPortrait ? (chartData.options?.width?.portrait || '100%') : (chartData.options?.width?.landscape || '100%'),\n    // if there is a filter, we make space for the chartFilter from the chart's height.\n    // value is divided in 2 because the calculation is applied twice due to\n    // how react-google-charts nest components\n    height: chartData.height || '100%',\n    tooltip: {\n      isHtml: true,\n      showColorCode: false\n    },\n    legend: {\n      alignment: isPortrait ? 'center' : 'start',\n      position:\n        chartData.options?.legend?.position\n        ?? (isPortrait ? 'top' : 'right'),\n      scrollArrows: {\n        activeColor: theme.palette.chart.axisTitle,\n        inactiveColor: theme.palette.text.secondary,\n      },\n      pagingTextStyle: {\n        fontSize: 10,\n        color: theme.palette.chart.axisTitle,\n        bold: true,\n      }\n    }\n  };\n\n  // 3. Append to vAxis and hAxis properties\n  options.vAxis = {\n    ...options.vAxis,\n    format: options.vAxis?.format ?? 'decimal',\n    title: options.vAxis?.title ?? '',\n    viewWindow: {\n      min: options.vAxis?.viewWindow?.min ?? 0,\n      max: options.vAxis?.viewWindow?.max ?? null,\n      max: options.vAxis?.viewWindow?.max ?? null,\n    },\n  };\n  options.hAxis = {\n    ...options.hAxis,\n    title: options.hAxis?.title ?? '',\n  };\n  // 3.1. If in portrait mode, slant the text of the hAxis\n  if (isPortrait) {\n    options.hAxis = {\n      ...options.hAxis,\n      slantedText: true,\n      slantedTextAngle: 30,\n    };\n  }\n\n  // 4. Override with custom colors:\n  // 4.1. Color scheme of all the series of this chart\n  if (typeof options.colors === 'string' || !options.colors) options.colors = theme.palette.chart.optionsColors[options.colors || 'multiColor'];\n  // 4.2. Individual color of a single serie (if given)\n  if (options.series) {\n    Object.values(options.series).forEach((_serie) => {\n      const serie = _serie;\n      if (serie.color === 'default') {\n        serie.color = theme.palette.primary.main;\n      }\n    });\n  }\n  // 4.3. Color of the trendline\n  if (options.trendlines) {\n    options.trendlines.forEach((_item) => {\n      const item = _item;\n      item.color = theme.palette.primary.main;\n    });\n  }\n  // 4.4. Color axis of the Calendar chart\n  if (options.colorAxis) {\n    switch (options.colorAxis.colors) {\n      case 'matchingColor':\n        options.colorAxis.colors = [\n          theme.palette.chart.colorAxisFirstColor,\n          theme.palette.chart.optionsColors.multiColor[options.colorAxis.colorIndex],\n        ];\n        break;\n      case 'default':\n        options.colorAxis.colors = [\n          theme.palette.chart.colorAxisFirstColor,\n          theme.palette.NYUpurple,\n        ];\n        break\n      // If not any of the above, then the colorAxis should be from the chart (aqi/temperature/humidity...)\n      default:\n        try {\n          options.colorAxis = theme.palette.chart.colorAxes[options.colorAxis.colors]\n        } catch {\n          options.colorAxis = []\n        }\n        break;\n    }\n  }\n  // 4.5. Colors of other elements of the chart (typographies and gridlines)\n  options.vAxis = {\n    ...options.vAxis,\n    titleTextStyle: axisTitleTextStyle,\n    textStyle: axisTextStyle,\n    gridlines: {\n      ...options.vAxis?.gridlines,\n      color: options.vAxis?.gridlines?.color || theme.palette.chart.gridlines\n    },\n    minorGridlines: { count: 0 },\n  };\n  options.hAxis = {\n    ...options.hAxis,\n    titleTextStyle: axisTitleTextStyle,\n    textStyle: axisTextStyle,\n    gridlines: {\n      ...options.hAxis?.gridlines,\n      color: options.hAxis?.gridlines?.color || theme.palette.chart.gridlines\n    },\n    minorGridlines: {\n      ...options.hAxis?.minorGridlines,\n      color: options.hAxis?.gridlines?.color || theme.palette.chart.gridlines,\n    },\n  };\n  options.legend = {\n    ...options.legend,\n    textStyle: axisTextStyle,\n  };\n  options.annotations = {\n    ...options.annotations,\n    highContrast: true,\n    textStyle: {\n      color: theme.palette.primary.contrastText,\n      fontSize: returnResponsiveFontSizeInPixels({ isPortrait, isSmaller: true }),\n      opacity: 0.8\n    },\n    stem: {\n      ...options.annotations?.stem,\n      color: theme.palette.chart.axisTitle,\n      thickness: 2\n    },\n    boxStyle: {\n      rx: theme.shape.borderRadius, // rounded corners\n      ry: theme.shape.borderRadius,\n      fill: theme.palette.chart.annotationBoxFill,\n      fillOpacity: 0.5\n    },\n  };\n\n  if (isPortrait && chartData?.chartType === \"LineChart\") {\n    options.pointSize = 0;\n  }\n\n  return options;\n}\n\nexport const returnChartControlUI = (props) => {\n  const { chartControl, mainChartData, mainChartOptions, subchartIndex, theme, isPortrait } = props;\n  let chartControlUI = {\n    ...chartControl.options?.ui,\n    snapToData: true\n  };\n\n  // Assign the appropriate UI for chartControl based on controlType (if existed)\n  if (chartControl.controlType === 'ChartRangeFilter') {\n    chartControlUI = {\n      ...chartControlUI,\n      chartType: mainChartData.chartType,\n      chartView: {\n        columns:\n          mainChartData.columns\n          || (mainChartData.subcharts\n            && mainChartData.subcharts[subchartIndex].columns)\n          || null\n          || null,\n      },\n      chartOptions: {\n        ...mainChartOptions,\n        hAxis: {\n          ...mainChartOptions.hAxis,\n          textPosition: 'out',\n          textStyle: { color: theme.palette.chart.axisText, fontSize: returnResponsiveFontSizeInPixels({ isPortrait, isSmaller: true }) },\n          title: null\n        },\n        vAxis: {\n          ...mainChartOptions.vAxis,\n          title: null\n        },\n        annotations: hideAnnotations,\n        legend: null,\n        pointSize: 0\n      }\n    };\n  }\n  return chartControlUI;\n}\n\nexport const addTouchEventListenerForChartControl = ({ controlWrapper, chartID }) => {\n  const touchHandler = (event) => {\n    var touches = event.changedTouches,\n      first = touches[0],\n      type = '';\n\n    switch (event.type) {\n      case 'touchstart':\n        type = 'mousedown';\n        break;\n      case 'touchmove':\n        type = 'mousemove';\n        break;\n      case 'touchend':\n        type = 'mouseup';\n        break;\n      default:\n        return;\n    }\n\n    var simulatedEvent = new MouseEvent(type, {\n      bubbles: true,\n      cancelable: true,\n      view: window,\n      detail: 1,\n      screenX: first.screenX,\n      screenY: first.screenY,\n      clientX: first.clientX,\n      clientY: first.clientY,\n      button: 0, // left button\n      relatedTarget: null,\n    });\n\n    first.target.dispatchEvent(simulatedEvent);\n    event.preventDefault();\n  }\n\n  let isMounted = true; // Flag to track component's mount status\n  if (!controlWrapper) return;\n\n  const controlDOM = document.querySelector(`#other-chart-control-${chartID}`);\n  if (!controlDOM) return;\n\n  ['touchstart', 'touchmove', 'touchend', 'touchcancel']\n    .forEach((touchEvent) => {\n      controlDOM.addEventListener(touchEvent, touchHandler, { capture: true });\n    });\n\n  return () => {\n    isMounted = false; // Component is unmounting\n\n    ['touchstart', 'touchmove', 'touchend', 'touchcancel'].forEach((touchEvent) => {\n      controlDOM.removeEventListener(touchEvent, touchHandler, { capture: true });\n    });\n  };\n}","import { isValidArray } from \"../UtilFunctions\";\n\nconst normalizeColorStopOffsets = ({ offsets, minOffset, maxOffset }) => {\n  return offsets.map(offset => (offset - minOffset) / (maxOffset - minOffset));\n}\n\nconst normalizeColorStops = ({ colors, optionalMinValue, optionalMaxValue }) => {\n  if (!isValidArray(colors)) return [\n    { color: \"#fff\", offset: 0 },\n    { color: \"#fff\", offset: 1 }\n  ];\n\n  // No offsets provided, generate equally spaced offsets\n  if (typeof colors[0] === 'string') {\n    const totalColors = colors.length;\n    return colors.map((color, index) => ({\n      color: color,\n      offset: index / (totalColors - 1)\n    }));\n  }\n  // Offsets are provided, normalize them\n  else {\n    let clampedStops = colors;\n    if (optionalMinValue) {\n      clampedStops = colors.filter(colorStop => colorStop.offset >= optionalMinValue);\n    }\n    if (optionalMaxValue) {\n      clampedStops = colors.filter(colorStop => colorStop.offset <= optionalMaxValue);\n    }\n    const offsets = clampedStops.map(colorStop => colorStop.offset);\n\n    const minOffset = optionalMinValue || Math.min(...offsets);\n    const maxOffset = optionalMaxValue || Math.max(...offsets);\n\n    const normalizedOffsets = normalizeColorStopOffsets({ offsets, minOffset, maxOffset });\n\n    return clampedStops.map((colorStop, index) => ({\n      color: colorStop.color,\n      offset: normalizedOffsets[index]\n    }));\n  }\n}\n\n// Function to return an array of STEPS discrete colors in a gradient from an array of starting colors\n// Used for NivoCalendarChart\nfunction hexToRgb(hex) {\n  const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  hex = hex.replace(shorthandRegex, function (m, r, g, b) {\n    return r + r + g + g + b + b;\n  });\n\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)]\n    : [null, null, null];\n}\nfunction rgbToHex(r, g, b) {\n  return \"#\" + [r, g, b].map(x => {\n    const hex = x.toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  }).join('');\n}\nfunction interpolateColor(color1, color2, factor) {\n  // Return immediately if the 2 colors are the same\n  if (color1.every((element, index) => element === color2[index])) return color1;\n\n  // Else, calculate the middle of the 2 colors\n  let result = color1.slice();\n  for (let i = 0; i < 3; i++) {\n    result[i] = Math.round(result[i] + factor * (color2[i] - color1[i]));\n  }\n  return result;\n}\nexport const generateDiscreteColorGradientArray = ({ colors, numSteps = 100 }) => {\n  const normalizedColors = normalizeColorStops({ colors });\n  normalizedColors.forEach((colorStop) => {\n    colorStop.color = hexToRgb(colorStop.color)\n  });\n\n  let colorArray = [];\n  const stepPositions = Array.from({ length: numSteps }, (_, i) => i / (numSteps - 1));\n\n  for (let i = 0; i < stepPositions.length; i++) {\n    const pos = stepPositions[i];\n    let color1, color2, offset1, offset2;\n\n    for (let j = 0; j < normalizedColors.length - 1; j++) {\n      if (pos >= normalizedColors[j].offset && pos <= normalizedColors[j + 1].offset) {\n        color1 = normalizedColors[j].color;\n        color2 = normalizedColors[j + 1].color;\n        offset1 = normalizedColors[j].offset;\n        offset2 = normalizedColors[j + 1].offset;\n        break;\n      }\n    }\n\n    const localFactor = (pos - offset1) / (offset2 - offset1);\n    const interpolatedColor = interpolateColor(color1, color2, localFactor);\n    colorArray.push(rgbToHex(...interpolatedColor));\n  }\n\n  return colorArray;\n};\n\n// Function to return CSS background from an array of colors (with or without offsets)\nexport const generateCssBackgroundGradient = ({ gradientDirection, colors, optionalMinValue, optionalMaxValue }) => {\n  const normalizedColors = normalizeColorStops({ colors, optionalMinValue, optionalMaxValue });\n\n  return `linear-gradient(${gradientDirection}, ${normalizedColors.map(colorStop => `${colorStop.color} ${colorStop.offset * 100}%`).join(', ')})`;\n}\n\nexport const generateSvgFillGradient = ({ colors, optionalMinValue, optionalMaxValue }) => {\n  const normalizedColors = normalizeColorStops({ colors, optionalMinValue, optionalMaxValue });\n\n  return normalizedColors.map(colorStop => ({\n    color: colorStop.color,\n    offset: colorStop.offset * 100 + '%'\n  }));\n};\n\n// Gradient for background of the Google Charts\nexport const BackgroundGradient = ({ id, colors }) => (\n  <svg width={0} height={0} visibility=\"hidden\">\n    <defs>\n      <linearGradient id={id} x1=\"0\" y1=\"1\" x2=\"0\" y2=\"0\">\n        {colors.map((colorStop, index) => (\n          <stop key={index} offset={colorStop.offset} stopColor={colorStop.color} />\n        ))}\n      </linearGradient>\n    </defs>\n  </svg>\n);","import { useTheme } from '@mui/material/styles';\nimport { Box, Typography } from '@mui/material';\nimport { generateCssBackgroundGradient } from '../../../../Utils/Gradient/GradientUtils';\n\nconst ValueRangeBox = ({ title, valueRange, colorAxis, isPortrait }) => {\n  const theme = useTheme();\n\n  if (valueRange?.min === null || valueRange?.max === null) return null;\n\n  const { colors, minValue, maxValue } = colorAxis;\n  let rangeBoxMinValue = minValue, rangeBoxMaxValue = maxValue;\n\n  if (minValue === undefined) rangeBoxMinValue = valueRange.min;\n  if (maxValue === undefined) rangeBoxMaxValue = valueRange.max;\n\n  if (valueRange.min < rangeBoxMinValue) rangeBoxMinValue = valueRange.min;\n  if (valueRange.max > rangeBoxMaxValue) rangeBoxMaxValue = valueRange.max;\n\n  const calculateMarkerPositionOnRangeBox = (value) => {\n    const position = ((value - rangeBoxMinValue) / (rangeBoxMaxValue - rangeBoxMinValue)) * 100;\n    return `${position}%`;\n  };\n\n  const labelStyle = {\n    position: 'absolute',\n    fontSize: '0.75rem',\n    color: theme.palette.text.secondary,\n    lineHeight: 1,\n    textAlign: 'center',\n    transform: 'translateX(-50%)',\n    minWidth: '75px',\n    whiteSpace: 'nowrap',\n  };\n  const topLabelStyle = {\n    top: '-1.5rem',\n    transform: 'translateX(-50%)'\n  };\n  const bottomLabelStyle = {\n    bottom: '-1.25rem',\n    transform: isPortrait ? 'translateX(-100%)' : 'translateX(-50%)'\n  };\n\n  const triangleStyle = {\n    position: 'absolute',\n    width: 0,\n    height: 0,\n    borderLeft: '0.25rem solid transparent',\n    borderRight: '0.25rem solid transparent',\n    transform: 'translateX(-50%)',\n  };\n  const topTriangleStyle = {\n    top: '-0.5rem',\n    borderTop: `0.25rem solid ${theme.palette.text.secondary}`\n  };\n  const bottomTriangleStyle = {\n    bottom: '-0.5rem',\n    borderBottom: `0.25rem solid ${theme.palette.text.secondary}`\n  };\n\n  return (\n    <Box sx={{\n      position: 'sticky',\n      width: 'fit-content',\n      my: 4,\n      float: 'right',\n      right: (isPortrait ? '0' : '50px')\n    }}>\n      <Typography sx={{\n        display: 'inline',\n        position: 'absolute',\n        textAlign: 'right',\n        transform: 'translateX(calc(-100% - 0.5rem))',\n        fontSize: '0.75rem',\n        lineHeight: 1.25,\n        fontWeight: 500,\n        color: 'text.secondary'\n      }}>\n        {title}\n      </Typography>\n      <Box sx={{\n        background: generateCssBackgroundGradient({ gradientDirection: 'to right', colors: colors, optionalMaxValue: rangeBoxMaxValue }),\n        color: theme.palette.text.secondary,\n        border: `1px solid ${theme.palette.text.secondary}`,\n        width: isPortrait ? '250px' : '300px',\n        height: '1rem',\n        position: 'relative',\n        justifyContent: 'space-between',\n      }}>\n        <span style={{ ...labelStyle, ...topLabelStyle, left: calculateMarkerPositionOnRangeBox(valueRange.min) }}>min: {Math.round(valueRange.min)}</span>\n        <span style={{ ...labelStyle, ...bottomLabelStyle, left: calculateMarkerPositionOnRangeBox(valueRange.max) }}>max: {Math.round(valueRange.max)}</span>\n        <div style={{ ...triangleStyle, ...topTriangleStyle, left: calculateMarkerPositionOnRangeBox(valueRange.min) }}></div>\n        <div style={{ ...triangleStyle, ...bottomTriangleStyle, left: calculateMarkerPositionOnRangeBox(valueRange.max) }}></div>\n      </Box>\n    </Box>\n  );\n};\n\nexport default ValueRangeBox;","import { useEffect, useRef } from 'react';\nimport { Box, Chip } from '@mui/material';\n\nimport parse from 'html-react-parser';\nimport { replacePlainHTMLWithMuiComponents } from '../../../../Utils/UtilFunctions';\n\nconst TooltipCalendarChart = ({ day, color, tooltipText, dateRange, inFirstTwoRowsOfChart }) => {\n  const tooltipBoxRef = useRef(null);\n\n  // If the cell hovered over is in the first two rows of the chart,\n  // move the tooltip to the bottom of the chart\n  // Read subsequent comments to understand why we need to do this\n  useEffect(() => {\n    if (tooltipBoxRef.current && inFirstTwoRowsOfChart(day, dateRange)) {\n      const parentDiv = tooltipBoxRef.current.parentElement;\n      if (parentDiv) {\n        parentDiv.style.top = '11vh';\n      }\n    }\n  }, [tooltipBoxRef, inFirstTwoRowsOfChart]);\n\n\n  // Note that our Box is just a container 'inside' the tooltip\n  // The tooltip itself is actually the Box's parent div\n  return (\n    <Box ref={tooltipBoxRef} className='nivo-tooltip'>\n      <Chip sx={{ backgroundColor: color, mr: 0.5, height: '10px', width: '10px', borderRadius: '50%' }} />\n      {parse(tooltipText, { replace: replacePlainHTMLWithMuiComponents })}\n    </Box>\n  );\n};\n\nexport default TooltipCalendarChart;","\nexport const getDateRangeForCalendarChart = (dateStrings) => {\n  return {\n    min: dateStrings.reduce((min, current) => (current < min ? current : min)),\n    max: dateStrings.reduce((max, current) => (current > max ? current : max))\n  }\n};\n\nexport const getValueRangeForCalendarChart = (values) => {\n  return { min: Math.min(...values), max: Math.max(...values) };\n};\n\nexport const getCalendarChartMargin = (isPortrait) => {\n  return isPortrait\n    ? { top: 30, right: 0, bottom: 20, left: 20 }\n    : { top: 30, right: 40, bottom: 20, left: 40 };\n};\n\nexport const calculateValueRange = (data) => {\n  const values = data.map((item) => item.value);\n  return { min: Math.min(...values), max: Math.max(...values) };\n};\n\n","/* eslint-disable */\nimport { ResponsiveCalendar } from '@nivo/calendar';\nimport { useTheme } from '@mui/material/styles';\nimport { generateDiscreteColorGradientArray } from '../../../../Utils/Gradient/GradientUtils';\n\nimport ValueRangeBox from './ValueRangeBox';\nimport TooltipCalendarChart from './TooltipCalendarChart';\nimport { getCalendarChartMargin, getDateRangeForCalendarChart, getValueRangeForCalendarChart } from '../NivoChartHelper';\nimport { useEffect, useState } from 'react';\nimport { isValidArray } from '../../../../Utils/UtilFunctions';\nimport GoogleChartStyleWrapper from '../../SubchartUtils/GoogleChartStyleWrapper';\nimport { Box } from '@mui/material';\n\nconst YEAR_SPACING = 40;\n\nconst NivoCalendarChart = (props) => {\n    const { dataArray, valueRangeBoxTitle, isPortrait, options, windowSize } = props;\n\n    const [dateRange, setDateRange] = useState({ min: null, max: null });\n    const [valueRange, setValueRange] = useState({ min: null, max: null });\n    const [calendarHeight, setCalendarHeight] = useState(400);\n\n    useEffect(() => {\n        if (!isValidArray(dataArray)) return;\n\n        const dateStrings = dataArray.map(item => item.day);\n        const thisDateRange = getDateRangeForCalendarChart(dateStrings)\n        setDateRange(thisDateRange);\n\n        const values = dataArray.map(item => item.value);\n        setValueRange(getValueRangeForCalendarChart(values));\n\n        // Get the number of years we have data for and the number of years to display\n        const lastYear = new Date(thisDateRange.max).getFullYear();\n        const firstYear = new Date(thisDateRange.min).getFullYear();\n        const numberOfYears = lastYear - firstYear + 1;\n        const calendarChartMargin = getCalendarChartMargin(isPortrait);\n\n        const cellSize = Math.min(windowSize[0] / 60, 20); // windowSize[0]: innerWidth\n        // max cell size of 20\n        const yearHeight = cellSize * 7; // Height for one year\n        const totalHeight = numberOfYears * (yearHeight + YEAR_SPACING) + calendarChartMargin.top + calendarChartMargin.bottom;\n        setCalendarHeight(totalHeight);\n    }, [dataArray, windowSize]);\n\n    const displayLegend = options?.legend?.position && options.legend.position !== \"none\";\n\n    const calendarChartMargin = getCalendarChartMargin(isPortrait, displayLegend);\n\n    const theme = useTheme();\n\n    // Function to extract tooltip text from HTML tooltip\n    const extractTooltipText = (tooltip) => {\n        const parser = new DOMParser();\n        const doc = parser.parseFromString(tooltip, 'text/html');\n        return doc.body.innerHTML;\n    };\n\n    // Function to check if a date is in the first two rows of the chart\n    // Used to anchor the tooltip to the bottom while hovering over\n    // the first two rows of the chart\n    const inFirstTwoRowsOfChart = (dateStr, dateRange) => {\n        const date = new Date(dateStr);\n        const dayOfWeek = date.getDay();\n\n        // Check if the date is Sunday (0) or Monday (1)\n        const isFirstTwoDaysOfWeek = dayOfWeek === 0 || dayOfWeek === 1;\n\n        // Extract the first year from the date range once\n        const firstYear = new Date(dateRange.min).getFullYear();\n\n        // Check if the date is in the first year of the date range\n        const isInFirstYear = date.getFullYear() === firstYear;\n\n        return isFirstTwoDaysOfWeek && isInFirstYear;\n    };\n\n    const calendarCellColors = generateDiscreteColorGradientArray({\n        colors: options?.colorAxis?.colors,\n        numSteps: options?.colorAxis?.gradientSteps\n    });\n\n    return (\n        <GoogleChartStyleWrapper\n            isPortrait={isPortrait}\n            className=\"Calendar\"\n            position=\"relative\"\n            minWidth=\"550px\"\n            height=\"100%\"\n        >\n            {displayLegend ? (\n                <ValueRangeBox\n                    title={valueRangeBoxTitle}\n                    valueRange={valueRange}\n                    colorAxis={options?.colorAxis}\n                    isPortrait={isPortrait}\n                />\n            ) : null}\n\n\n            <Box sx={{\n                height: `${calendarHeight}px`,\n                maxHeight: \"450px\",\n                overflowY: 'auto',\n                width: '100%',\n                position: 'relative'\n            }}>\n                <Box sx={{\n                    height: `${calendarHeight}px`,\n                    position: 'absolute',\n                    width: '100%'\n                }}>\n                    <ResponsiveCalendar\n                        data={dataArray}\n                        from={dateRange.min}\n                        to={dateRange.max}\n                        emptyColor=\"transparent\"\n                        align=\"top\"\n                        theme={{\n                            text: {\n                                fill: theme.palette.text.secondary,\n                            },\n                            fontSize: '0.75rem'\n                        }}\n                        colors={calendarCellColors}\n                        minValue={options?.colorAxis?.minValue}\n                        maxValue={options?.colorAxis?.maxValue}\n                        margin={calendarChartMargin}\n                        yearSpacing={YEAR_SPACING}\n                        monthBorderColor={theme.palette.text.primary}\n                        monthBorderWidth={1}\n                        daySpacing={0.25}\n                        dayBorderWidth={0}\n                        tooltip={({ day, value, color }) => {\n                            const tooltipData = dataArray.find(item => item.day === day);\n                            const tooltipText = tooltipData ? extractTooltipText(tooltipData.tooltip) : '';\n\n                            return (\n                                <TooltipCalendarChart\n                                    day={day}\n                                    color={color}\n                                    tooltipText={tooltipText}\n                                    dateRange={dateRange}\n                                    inFirstTwoRowsOfChart={inFirstTwoRowsOfChart}\n                                />\n                            );\n                        }}\n                    />\n                </Box>\n            </Box>\n\n        </GoogleChartStyleWrapper>\n    );\n};\n\nexport default NivoCalendarChart;\n\n","/* eslint-disable */\n\nimport { styled } from '@mui/material/styles';\nimport { Paper } from '@mui/material';\n\nimport { addDays, endOfDay, startOfDay, format, addHours } from \"date-fns\";\nimport AggregationType from './AggregationType';\n\nconst today = new Date();\n\nconst yesterday = {\n  label: \"Yesterday\",\n  range: () => ({\n    startDate: startOfDay(addHours(today, -48)),\n    endDate: today\n  })\n};\n\nconst last14Days = {\n  label: \"Last 14d\",\n  range: () => ({\n    startDate: startOfDay(addDays(today, -14)),\n    endDate: endOfDay(today)\n  })\n};\n\nconst last30Days = {\n  label: \"Last 30d\",\n  range: () => ({\n    startDate: startOfDay(addDays(today, -30)),\n    endDate: endOfDay(today)\n  })\n};\n\nconst last365Days = {\n  label: \"Last 365d\",\n  range: () => ({\n    startDate: startOfDay(addDays(today, -365)),\n    endDate: endOfDay(today)\n  })\n};\n\nconst allTime = ({ minDateOfDataset }) => {\n  const formattedMinDate = format(minDateOfDataset, \"MMM yyyy\");\n  return {\n    label: `All Time (${formattedMinDate} - Now)`,\n    range: () => ({\n      startDate: minDateOfDataset,\n      endDate: endOfDay(today)\n    })\n  }\n};\n\nexport const returnCustomStaticRanges = ({ minDateOfDataset, aggregationType }) => {\n  switch (aggregationType) {\n    case AggregationType.minute:\n      return [yesterday];\n    case AggregationType.day:\n      return [last30Days, last365Days];\n    case AggregationType.month:\n    case AggregationType.year:\n      return [allTime({ minDateOfDataset })];\n    default:\n      return [last14Days, last30Days];\n  }\n};\n\nexport const AggregationTypeMetadata = {\n  [AggregationType.minute]: {\n    maxDays: 2,\n    label: \"Live\"\n  },\n  [AggregationType.hour]: {\n    maxDays: 30,\n    label: \"Hourly\"\n  },\n  [AggregationType.day]: {\n    maxDays: 365,\n    label: \"Daily\"\n  },\n  [AggregationType.month]: {\n    maxDays: Infinity,\n    label: \"Monthly\"\n  },\n  [AggregationType.year]: {\n    maxDays: Infinity,\n    label: \"Yearly\"\n  }\n}\n\nexport const StyledDateRangePicker = styled(Paper, {\n  shouldForwardProp: (prop) => prop !== 'showPickerPanel' && prop !== 'smallScreen',\n})(({ theme, showPickerPanel, smallScreen }) => ({\n  zIndex: showPickerPanel === true && 1,\n  position: \"relative\",\n  padding: showPickerPanel ? theme.spacing(1) : 0,\n  margin: (showPickerPanel && !smallScreen) ? theme.spacing(-1) : 0,\n  maxWidth: '100%',\n  background: showPickerPanel ? theme.palette.customAlternateBackground : 'transparent',\n  boxShadow: showPickerPanel === false && 'none',\n  '& .rdrDateInput::before': {\n    display: \"none !important\"\n  },\n  '& .rdrDateInput': {\n    borderRadius: theme.shape.borderRadius,\n    boxShadow: 'none',\n    padding: 0\n  },\n  '& .rdrDayToday .rdrDayNumber span:after': {\n    background: theme.palette.secondary\n  },\n  '& .rdrDateDisplayWrapper, .rdrCalendarWrapper, .rdrDefinedRangesWrapper, .rdrStaticRange, .rdrDateDisplayItem': {\n    background: 'transparent'\n  },\n  '& .rdrDateDisplayItemActive': {\n    border: showPickerPanel === false && 'none'\n  },\n  '& .rdrDateDisplay': {\n    margin: 0,\n    minWidth: \"10rem\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    height: \"2rem\"\n  },\n  '& .rdrDateDisplayItem': {\n    margin: 0,\n    borderRadius: showPickerPanel ? theme.shape.borderRadius : 0,\n    \"&:hover:not(.rdrDateDisplayItemActive)\": {\n      border: showPickerPanel ? `1px solid ${theme.palette.action.disabled}` : \"none\"\n    }\n  },\n  '& .rdrDateDisplayItem:hover:not(.rdrDateDisplayItemActive)': {\n    border: showPickerPanel === false && '1px solid transparent'\n  },\n  '& .rdrDateDisplayItem + .rdrDateDisplayItem': {\n    margin: 0\n  },\n  '& .rdrDateDisplayItem:first-of-type': {\n    borderRight: showPickerPanel === false && `1px solid ${theme.palette.action.disabled} !important`\n  },\n  '& .rdrMonthAndYearWrapper, .rdrInputRanges': {\n    display: showPickerPanel === false && 'none !important',\n    padding: 0\n  },\n  '& .rdrMonthName': {\n    display: 'none',\n  },\n  '& .rdrDefinedRangesWrapper, .rdrMonths': {\n    display: showPickerPanel === false && 'none'\n  },\n  '&  .rdrInfiniteMonths': {\n    visibility: showPickerPanel === false && 'hidden',\n    width: \"100% !important\",\n    maxWidth: \"675px\",\n    margin: \"auto\"\n  },\n  '& .rdrDateDisplayWrapper': {\n    minWidth: '9rem',\n    height: '2rem',\n    borderRadius: theme.shape.borderRadius,\n    border: showPickerPanel ? \"none\" : `1px solid ${theme.palette.action.disabled}`,\n    \"&:hover\": {\n      border: showPickerPanel ? \"none\" : `1px solid ${theme.palette.text.primary}`,\n    }\n  },\n  '& .rdrDateRangePickerWrapper': {\n    width: '100%',\n    flexDirection: 'column-reverse'\n  },\n  '& .rdrStaticRanges': {\n    flexDirection: 'row',\n    minWidth: '10.5rem'\n  },\n  '& .rdrStaticRangeLabel': {\n    color: theme.palette.text.secondary,\n    borderRadius: theme.shape.borderRadius,\n    padding: `${theme.spacing(0.5)} ${theme.spacing(1)}`\n  },\n  '& .rdrDefinedRangesWrapper': {\n    border: 'none',\n    width: '100%'\n  },\n  '& .rdrNextPrevButton': {\n    background: theme.palette.primary.main,\n    borderRadius: theme.shape.borderRadius,\n    opacity: 1,\n    '&:hover': {\n      opacity: 0.5,\n      background: theme.palette.primary.main\n    }\n  },\n  '& .rdrNextPrevButton > i': {\n    color: \"white\"\n  },\n  '& .rdrNextButton > i': {\n    borderColor: `transparent transparent transparent white`\n  },\n  '& .rdrPprevButton > i': {\n    borderColor: `transparent white transparent transparent`\n  },\n  '& .rdrStaticRange': {\n    border: 'none'\n  },\n  '& .rdrStaticRangeSelected > .rdrStaticRangeLabel, .rdrMonthAndYearPickers': {\n    color: theme.palette.primary.main\n  },\n  '& .rdrMonthAndYearPickers': {\n    fontSize: '1rem'\n  },\n  '& .rdrStaticRange:hover .rdrStaticRangeLabel, .rdrStaticRange:focus .rdrStaticRangeLabel': {\n    background: theme.palette.customBackground.toString()\n  },\n  '& .rdrDayNumber span': {\n    color: theme.palette.text.primary.toString()\n  },\n  '& .rdrDayPassive .rdrDayNumber span': {\n    opacity: 0.5\n  },\n  '& .rdrMonthAndYearWrapper select': {\n    color: theme.palette.text.secondary.toString(),\n    background: 'none',\n    padding: `${theme.spacing(1)} ${theme.spacing(2)}`,\n    '&:hover': {\n      border: `1px solid ${theme.palette.text.secondary}`\n    }\n  },\n  '& .rdrDateDisplayItem input': {\n    color: theme.palette.text.secondary\n  },\n  '& .rdrDayDisabled': {\n    backgroundColor: theme.palette.customBackground\n  },\n  '& .rdrDayEndOfMonth .rdrInRange, .rdrDayEndOfMonth .rdrStartEdge, .rdrDayEndOfWeek .rdrInRange, .rdrDayEndOfWeek .rdrStartEdge, .rdrEndEdge, .rdrDayEndOfMonth .rdrDayInPreview, .rdrDayEndOfMonth .rdrDayStartPreview, .rdrDayEndOfWeek .rdrDayInPreview, .rdrDayEndOfWeek .rdrDayStartPreview, .rdrDayEndPreview': {\n    borderTopRightRadius: '2rem',\n    borderBottomRightRadius: '2rem'\n  },\n  '& .rdrStartEdge, .rdrDayStartOfMonth .rdrInRange, .rdrDayStartOfMonth .rdrEndEdge, .rdrDayStartOfWeek .rdrInRange, .rdrDayStartOfWeek .rdrEndEdge, .rdrDayStartOfMonth .rdrDayInPreview, .rdrDayStartOfMonth .rdrDayEndPreview, .rdrDayStartOfWeek .rdrDayInPreview, .rdrDayStartOfWeek .rdrDayEndPreview, .rdrDayStartPreview': {\n    borderTopLeftRadius: '2rem',\n    borderBottomLeftRadius: '2rem'\n  },\n  '& .rdrStartEdge, .rdrDayStartOfWeek .rdrInRange, .rdrDayStartOfMonth .rdrInRange, .rdrDayStartOfMonth .rdrEndEdge, .rdrDayStartOfWeek .rdrEndEdge': {\n    left: 0\n  },\n  '& .rdrEndEdge, .rdrDayEndOfWeek .rdrInRange, .rdrDayEndOfMonth .rdrInRange, .rdrDayEndOfWeek .rdrStartEdge': {\n    right: 0\n  },\n  '& .rdrSelected, .rdrInRange, .rdrStartEdge, .rdrEndEdge': {\n    top: '0px',\n    bottom: '0px',\n  },\n  '& .rdrMonths': {\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  '& .rdrDay': {\n    marginBottom: \"1px\",\n    '& span': {\n      top: '0px',\n      bottom: '0px'\n    }\n  },\n  '& .rdrMonthsHorizontal': {\n    overflowY: 'hidden'\n  },\n  '& .rdrDateInput:first-of-type:before': {\n    content: '\"\"',\n    backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' class='MuiSvgIcon-root' focusable='false' aria-hidden='true' viewBox='0 0 24 24' data-testid='DateRangeIcon'%3E%3Cpath d='M9 11H7v2h2zm4 0h-2v2h2zm4 0h-2v2h2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V9h14z' fill='${theme.palette.text.secondary}'/%3E%3C/svg%3E\")`,\n    width: \"0.75rem\",\n    height: \"0.75rem\",\n    display: \"block\",\n    position: \"absolute\",\n    top: \"50%\",\n    transform: \"translateY(-50%)\",\n    left: \"0.75rem\"\n  },\n  '& .rdrStaticRangeSelected span': {\n    color: theme.palette.primary.main\n  },\n  '& .rdrDayToday .rdrDayNumber span:after': {\n    background: theme.palette.secondary.main,\n    width: \"0.25rem\",\n    height: \"0.25rem\",\n    borderRadius: \"50%\"\n  }\n}));\n\nexport const returnFormattedDates = ({ startDateObject, endDateObject }) => {\n  return {\n    startDate: format(startDateObject, 'yyyy-MM-dd'),\n    endDate: format(endDateObject, 'yyyy-MM-dd')\n  }\n}","import { ToggleButton, ToggleButtonGroup } from '@mui/material';\nimport { useMediaQuery } from '@mui/material';\nimport { keyframes } from '@mui/system';\n\nimport AggregationType from './AggregationType';\nimport { AggregationTypeMetadata } from './DateRangePickerUtils';\nimport { useTheme } from '@emotion/react';\nimport RadioButtonCheckedIcon from '@mui/icons-material/RadioButtonChecked';\nimport { AQI_Database } from '../../Utils/AirQuality/AirQualityIndexHelper';\n\nconst pulse = keyframes`\n  0% { opacity: 1; }\n  50% { opacity: 0.6; }\n  100% { opacity: 1; }\n`;\n\nexport default function AggregationTypeToggle({ aggregationType, setAggregationType }) {\n  const theme = useTheme();\n\n  const isLargeScreen = useMediaQuery(theme => theme.breakpoints.up('lg'));\n  const extraSmallScreen = useMediaQuery((theme) => theme.breakpoints.down('sm'));\n\n  const handleChange = (_, newType) => {\n    if (newType !== null) {\n      setAggregationType(newType);\n    }\n  };\n\n\n  return (\n    <ToggleButtonGroup\n      fullWidth={extraSmallScreen}\n      color=\"primary\"\n      value={aggregationType}\n      exclusive\n      onChange={handleChange}\n      aria-label=\"aggregation type toggle for graph average\"\n      size=\"small\"\n      sx={{ height: \"100%\", [theme.breakpoints.down('sm')]: { width: '100%' } }}\n      orientation={isLargeScreen ? \"vertical\" : \"horizontal\"}\n    >\n      {Object.values(AggregationType).map(type => (\n        <ToggleButton\n          key={type}\n          size=\"small\"\n          sx={{ textTransform: \"capitalize !important\", px: 1.25, py: 0.5, color: \"text.secondary\" }}\n          value={type}\n          aria-label={type}\n        >\n          {/* Show pulsing red icon if type === AggregationType.minute */}\n          {type === AggregationType.minute && (\n            <RadioButtonCheckedIcon\n              sx={{\n                ...(isLargeScreen ? {\n                  position: 'absolute',\n                  left: '50%',\n                  transform: 'translateX(calc(-50% - 2.5rem))',\n                } : {\n                  mr: 0.3,\n                }),\n                color: AQI_Database[3].color.Light,\n                fontSize: \"0.75rem\",\n                animation: `${pulse} 2s infinite ease-in-out`,\n              }}\n            />\n          )}\n\n          {AggregationTypeMetadata[type]?.label || \"\"}\n        </ToggleButton>\n      ))}\n    </ToggleButtonGroup>\n  );\n}","import { useQuery } from '@tanstack/react-query';\nimport { useContext } from 'react';\n\nimport { fetchDataFromURL } from '../API/ApiFetch';\nimport { DashboardContext } from '../ContextProviders/DashboardContext';\nimport { getApiUrl } from '../API/ApiUrls';\n\nconst useChartData = (chartID) => {\n    const { allChartsConfigs, currentSchoolID } = useContext(DashboardContext);\n    const chartConfig = allChartsConfigs[chartID];\n\n    return useQuery({\n        queryKey: [chartConfig, currentSchoolID],\n        queryFn: async () => {\n            const url = getApiUrl({\n                paths: [chartConfig.endpoint, currentSchoolID],\n                queryParams: chartConfig.queryParams\n            });\n            return fetchDataFromURL({ url });\n        },\n        enabled: !!currentSchoolID && !!chartConfig?.endpoint, // only run when ready\n        staleTime: 1000 * 60 * 10, // 10-minute cache,\n        placeholderData: (prev) => prev // Keep data from previous queryKey to avoid flashing charts\n    });\n}\n\nexport default useChartData;\n","import { useState, useRef, useEffect, useContext } from 'react';\n\nimport { DateRangePicker, createStaticRanges } from 'react-date-range';\nimport 'react-date-range/dist/styles.css'; // main style file\nimport 'react-date-range/dist/theme/default.css'; // theme css file\n\nimport { Box, Grid, Stack, Typography, useMediaQuery, useTheme } from '@mui/material';\n\nimport { AggregationTypeMetadata, StyledDateRangePicker, returnCustomStaticRanges, returnFormattedDates } from './DateRangePickerUtils';\nimport AggregationTypeToggle from './AggregationTypeToggle';\nimport AggregationType from './AggregationType';\nimport { DashboardContext } from '../../ContextProviders/DashboardContext';\n\nimport { differenceInDays, isSameDay } from 'date-fns';\n\nimport { useSnackbar } from \"notistack\";\nimport { SnackbarMetadata } from '../../Utils/SnackbarMetadata';\nimport useChartData from '../../hooks/useChartData';\n\nconst CustomDateRangePicker = (props) => {\n  const { minDateOfDataset, chartIndex } = props;\n  const [isFirstRequest, setIsFirstRequest] = useState(true)\n\n  const { enqueueSnackbar } = useSnackbar();\n  const { isFetching } = useChartData(chartIndex);\n\n  const { allChartsConfigs, updateIndividualChartConfigQueryParams } = useContext(DashboardContext);\n  const chartConfig = allChartsConfigs[chartIndex] || {};\n  const queryParams = chartConfig.queryParams || {};\n\n  const [aggregationType, setAggregationType] = useState(queryParams.aggregationType || AggregationType.hour);\n  const [dateRange, setDateRange] = useState(() => {\n    const { startDate, endDate } = queryParams;\n    if (startDate && endDate) {\n      return {\n        startDate: new Date(startDate),\n        endDate: new Date(endDate),\n        key: 'selection',\n      };\n    }\n    // Default if not set\n    return {\n      startDate: null,\n      endDate: null,\n      key: 'selection',\n    };\n  });\n\n  const today = new Date();\n  const theme = useTheme();\n  const smallScreen = useMediaQuery(theme.breakpoints.down('sm'));\n  const isLargeScreen = useMediaQuery(theme => theme.breakpoints.up('lg'));\n\n  // Set aggregationType\n  useEffect(() => {\n    // Initialize with the range of the first static range (default)\n    const defaultRange = {\n      ...returnCustomStaticRanges({\n        aggregationType: aggregationType || AggregationType.hour,\n        minDateOfDataset\n      })[0].range(), key: 'selection'\n    };\n    setDateRange(defaultRange);\n  }, [aggregationType]);\n\n  // Handle date range change  update DashboardContext queryParams\n  useEffect(() => {\n    // Early return if this is the first request (already fetched by useChartData hook)\n    if (isFirstRequest) {\n      setIsFirstRequest(false);\n      return;\n    }\n\n    const { startDate, endDate } = dateRange || {};\n    if (!startDate || !endDate) return;\n\n    // Start date and end date can't be the same date\n    if (isSameDay(startDate, endDate)) {\n      // No need to display error message as this is usually caused when only the start date is selected\n      return;\n    }\n\n    // Restrict the selection to only max days per aggregationType\n    const maxAllowedDays = AggregationTypeMetadata[aggregationType]?.maxDays;\n    if (differenceInDays(endDate, startDate) > maxAllowedDays) {\n      enqueueSnackbar(`${AggregationTypeMetadata[aggregationType].label} data is limited to maximum ${maxAllowedDays} day${maxAllowedDays > 1 ? \"s\" : \"\"}`, SnackbarMetadata.error);\n      return;\n    }\n\n    // Change the config\n    const formattedDates = returnFormattedDates({\n      startDateObject: startDate,\n      endDateObject: endDate\n    });\n    updateIndividualChartConfigQueryParams(chartIndex, {\n      aggregationType,\n      startDate: formattedDates.startDate,\n      endDate: formattedDates.endDate\n    });\n\n  }, [dateRange]);\n\n  // Control displaying / hiding of the date range picker\n  const [showPickerPanel, setShowPickerPanel] = useState(false);\n  const paperRef = useRef(null);\n\n  // Hide or show the date-range-picker panel on user's manual input\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (paperRef.current && !paperRef.current.contains(event.target)) {\n        setShowPickerPanel(false);\n      }\n    };\n    document.addEventListener(\"mousedown\", handleClickOutside);\n\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [paperRef]);\n\n  // Hide the panel on data fetching done\n  useEffect(() => {\n    if (!isFetching && showPickerPanel) {\n      setShowPickerPanel(false);\n    }\n  }, [isFetching]);\n\n  return (\n    <>\n      <Grid item alignItems={showPickerPanel ? \"start\" : \"stretch\"} xs sm=\"auto\" lg>\n        <Stack direction=\"column\" alignItems=\"stretch\" gap={0.5} width=\"100%\">\n          {\n            isLargeScreen ? <Typography color=\"text.secondary\" sx={{ textTransform: \"uppercase\" }}>Averaging Period</Typography> : null\n          }\n          <AggregationTypeToggle\n            aggregationType={aggregationType}\n            setAggregationType={setAggregationType}\n            smallScreen={smallScreen}\n          />\n        </Stack>\n      </Grid>\n\n      <Grid\n        item\n        sx={{\n          height: \"2rem\",\n          flex: 1,\n          [theme.breakpoints.up('lg')]: { minHeight: '4rem' }\n          // width: { [theme.breakpoints.down(\"sm\")]: { width: \"100%\" } },\n        }}\n      >\n        <Stack direction=\"column\" alignItems=\"stretch\" gap={0.5}>\n          {\n            isLargeScreen ? <Typography color=\"text.secondary\" sx={{ textTransform: \"uppercase\" }}>Date Range</Typography> : null\n          }\n          <StyledDateRangePicker\n            showPickerPanel={showPickerPanel}\n            smallScreen={smallScreen}\n            ref={paperRef}\n            elevation={8}\n            onClick={() => setShowPickerPanel(true)}\n            sx={{ position: \"relative\" }}\n          >\n\n            <Box\n              sx={{\n                transition: \"filter 0.2s ease-in-out\"\n              }}\n            >\n              <DateRangePicker\n                ranges={[dateRange]}\n                onChange={(ranges) => {\n                  if (!ranges) return;\n                  setDateRange(ranges.selection);\n                }}\n                staticRanges={createStaticRanges(\n                  returnCustomStaticRanges({ minDateOfDataset, aggregationType })\n                )}\n                inputRanges={[]}\n                rangeColors={[\n                  theme.palette.primary.main,\n                  theme.palette.secondary.main,\n                  theme.palette.text.secondary,\n                ]}\n                minDate={minDateOfDataset}\n                maxDate={today}\n                months={1}\n                showMonthAndYearPickers={true}\n                direction=\"vertical\"\n                fixedHeight={true}\n                preventSnapRefocus={true}\n                startDatePlaceholder=\"Start Date\"\n                endDatePlaceholder=\"End Date\"\n                editableDateInputs={true}\n                showMonthArrow={true}\n                weekStartsOn={1}\n              />\n            </Box>\n          </StyledDateRangePicker>\n        </Stack>\n      </Grid >\n\n    </>\n  );\n};\n\nexport default CustomDateRangePicker;\n","import { createContext, useMemo, useState, useContext } from 'react';\n\nconst AxesPickerContext = createContext();\n\nexport function AxesPickerProvider({ children }) {\n    const [hAxis, setHAxis] = useState();\n    const [vAxis, setVAxis] = useState();\n\n    const contextValue = useMemo(() => ({\n        hAxis, setHAxis,\n        vAxis, setVAxis\n    }), [hAxis, vAxis]);\n\n    return (\n        <AxesPickerContext.Provider value={contextValue}>\n            {children}\n        </AxesPickerContext.Provider>\n    );\n}\n\n// Custom hook \nexport const useAxesPicker = () => useContext(AxesPickerContext);","import { useContext, useEffect, useState } from 'react';\nimport { Select, MenuItem, FormControl, InputLabel, Button, Grid, CircularProgress, Stack, useMediaQuery, Typography } from '@mui/material';\nimport { styled } from '@mui/material/styles';\nimport { useAxesPicker } from '../../ContextProviders/AxesPickerContext';\nimport { ChartAPIendpointsOrder } from \"../../API/Utils\";\nimport { DashboardContext } from '../../ContextProviders/DashboardContext';\nimport useChartData from '../../hooks/useChartData';\n\nconst SELECT_MIN_WIDTH = \"150px\";\n\n// Define custom styled components for shared border radius\nconst LeftSelect = styled(FormControl)(({ theme }) => ({\n  textTransform: 'capitalize',\n  minWidth: SELECT_MIN_WIDTH,\n\n  // Only between smlg: stitched (merge right side)\n  [theme.breakpoints.between('sm', 'lg')]: {\n    '& .MuiOutlinedInput-root': {\n      borderTopRightRadius: 0,\n      borderBottomRightRadius: 0,\n    },\n    '& .MuiOutlinedInput-notchedOutline': {\n      borderRight: 'none',\n    },\n  },\n\n  // Focused border fix (optional highlight)\n  '& .Mui-focused .MuiOutlinedInput-notchedOutline': {\n    borderRight: `2px solid ${theme.palette.primary.main}`,\n  },\n}));\n\n\nconst RightSelect = styled(FormControl)(({ theme }) => ({\n  textTransform: 'capitalize',\n  minWidth: SELECT_MIN_WIDTH,\n\n  // Only between smlg: stitched (merge left side)\n  [theme.breakpoints.between('sm', 'lg')]: {\n    '& .MuiOutlinedInput-root': {\n      borderTopLeftRadius: 0,\n      borderBottomLeftRadius: 0,\n    },\n    '& .MuiOutlinedInput-notchedOutline': {\n      borderLeft: 'none',\n    },\n  },\n}));\n\n\n\nconst AxesPicker = (props) => {\n  const { currentSchoolID, allChartsConfigs, setIndividualChartConfig } = useContext(DashboardContext);\n  const { chartID, allowedAxes, selectedAxes, dataType } = props;\n  const { hAxis, vAxis, setHAxis, setVAxis } = useAxesPicker();\n\n  const { isFetching } = useChartData(chartID);\n  const [shouldDisableApplyButton, setShouldDisableApplyButton] = useState(true);\n\n  useEffect(() => {\n    const { hAxis: receivedHAxis, vAxis: receivedVAxis } = selectedAxes || {};\n\n    if (!(receivedHAxis && receivedVAxis)) {\n      setShouldDisableApplyButton(true);\n      return;\n    }\n\n    setHAxis(receivedHAxis);\n    setVAxis(receivedVAxis);\n  }, [selectedAxes, setHAxis, setVAxis]);\n\n  useEffect(() => {\n    const { hAxis: receivedHAxis, vAxis: receivedVAxis } = selectedAxes;\n    if (!(receivedHAxis && receivedVAxis)) {\n      return;\n    };\n\n    setShouldDisableApplyButton(hAxis === receivedHAxis && vAxis === receivedVAxis);\n\n  }, [hAxis, vAxis, selectedAxes]);\n\n  const applyChanges = () => {\n    if (!(vAxis && hAxis)) return;\n\n    setIndividualChartConfig(chartID, {\n      ...allChartsConfigs[chartID],\n      queryParams: {\n        dataType: dataType,\n        sensorX: hAxis,\n        sensorY: vAxis\n      }\n    });\n  }\n\n  // Disable option if the current dataType isn't in its allowedDataTypes array\n  const shouldDisableOption = (option) => {\n    return !option.allowedDataTypes.includes(dataType);\n  }\n\n  const isLargeScreen = useMediaQuery(theme => theme.breakpoints.up('lg'));\n\n  return (\n    <Stack direction=\"column\" alignItems=\"stretch\" gap={1.5} width=\"100%\">\n      {\n        isLargeScreen ? <Typography color=\"text.secondary\" sx={{ textTransform: \"uppercase\" }}>Sensor Pair Selection</Typography> : null\n      }\n      <Grid container item rowGap={1.5} columnGap={1} alignItems=\"center\">\n        <Grid container item rowGap={1.5}>\n          <Grid item xs={12} sm=\"auto\" lg>\n            <LeftSelect fullWidth size=\"small\">\n              <InputLabel id=\"x-axis-select-label\">Horizontal Axis</InputLabel>\n              <Select\n                labelId=\"x-axis-select-label\"\n                value={hAxis || selectedAxes?.hAxis || null}\n                label=\"Horizontal Axis\"\n                onChange={(event) => {\n                  setHAxis(event.target.value)\n                }}\n                autoWidth\n              >\n                {allowedAxes?.map(option => (\n                  <MenuItem\n                    key={option.sensor}\n                    value={option.sensor}\n                    disabled={option.sensor === vAxis || shouldDisableOption(option)}\n                    sx={{ textTransform: 'capitalize' }}\n                  >\n                    {option.sensor}{shouldDisableOption(option) && \" (No Data)\"}\n                  </MenuItem>\n                ))}\n              </Select>\n            </LeftSelect>\n          </Grid>\n          <Grid item xs={12} sm=\"auto\" lg>\n            <RightSelect fullWidth size=\"small\">\n              <InputLabel id=\"y-axis-select-label\">Vertical Axis</InputLabel>\n              <Select\n                labelId=\"y-axis-select-label\"\n                value={vAxis || selectedAxes?.vAxis || null}\n                label=\"Vertical Axis\"\n                onChange={(event) => {\n                  setVAxis(event.target.value)\n                }}\n                autoWidth\n              >\n                {allowedAxes?.map(option => (\n                  <MenuItem\n                    key={option.sensor}\n                    value={option.sensor}\n                    disabled={option.sensor === hAxis || shouldDisableOption(option)}\n                    sx={{ textTransform: 'capitalize' }}\n                  >\n                    {option.sensor}{shouldDisableOption(option) && \" (No Data)\"}\n                  </MenuItem>\n                ))}\n              </Select>\n            </RightSelect>\n          </Grid>\n        </Grid>\n\n        <Grid item xs={12} sm=\"auto\" lg>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            fullWidth\n            sx={{ height: \"100%\" }}\n            onClick={applyChanges}\n            disabled={shouldDisableApplyButton || isFetching}\n          >\n            APPLY\n          </Button>\n        </Grid>\n      </Grid>\n    </Stack>\n  );\n};\n\nexport default AxesPicker;\n","import { Alert, Box } from \"@mui/material\";\n\nconst NoChartToRender = ({ customMessage, dataType, height, selectableAxes }) => {\n    let messagePrefix = \"This sensor \";\n    let messageSuffix = \" data. Choose a different sensor or data type.\";\n\n    if (selectableAxes) {\n        messagePrefix = \"This pair of sensors \";\n        messageSuffix = \" correlation data. Choose another pair or a different data type.\"\n    }\n\n    return (\n        <Box height={height}>\n            <Alert severity=\"error\" sx={{ my: 2 }}>\n                {\n                    customMessage ? customMessage : (\n                        <>\n                            {messagePrefix}\n                            does not have&nbsp;\n                            <Box component=\"span\" textTransform=\"capitalize\">\n                                {dataType}\n                            </Box>\n                            {messageSuffix}\n                        </>\n                    )\n                }\n            </Alert>\n        </Box>\n    )\n}\n\nexport default NoChartToRender;","export const returnHoursFromMinutesPastMidnight = (minutes) => {\n  const hoursPastMidnight = Math.floor(minutes / 60);\n  return hoursPastMidnight.toString().padStart(2, '0') + ':00';\n};\n\nexport const HOURS = Array.from({ length: 24 }, (_, i) => {\n  const minutesPastMidnight = i * 60;\n  return {\n    label: returnHoursFromMinutesPastMidnight(minutesPastMidnight),\n    value: minutesPastMidnight\n  };\n});\n\nexport const PREDEFINED_TIMERANGES = {\n  allday: { id: \"allday\", label: \"All Day\", start: HOURS[0].value, end: HOURS[HOURS.length - 1].value, timeRangeLabel: \"0-23h\" },\n  schoolHour: { id: \"schoolHour\", label: \"School Hour\", start: HOURS[7].value, end: HOURS[17].value, timeRangeLabel: \"7-17h\" },\n  custom: { id: \"custom\", label: \"Custom\" }\n};\n\n\n\n","import { Box, FormControl, InputLabel, Select, MenuItem, Stack } from '@mui/material';\nimport { useTheme } from '@mui/material';\nimport { isValidArray } from '../../../../../Utils/UtilFunctions';\n\nexport const SimplePicker = (props) => {\n  const { icon, label, value, options, handleChange, disabled, isExtraSmall, ...otherProps } = props;\n  const theme = useTheme();\n\n  return (\n    <Stack\n      direction=\"row\"\n      gap={icon ? 1 : 0}\n      alignItems=\"center\"\n      {...otherProps}\n    >\n      <Box\n        aria-hidden={true}\n        sx={{\n          '& .MuiSvgIcon-root': {\n            color: disabled ? theme.palette.text.secondary : theme.palette.primary.main,\n            verticalAlign: \"middle\"\n          }\n        }}\n      >\n        {icon}\n      </Box>\n\n      <FormControl\n        fullWidth\n        size='small'\n        disabled={disabled}\n        sx={{\n          minWidth: \"5rem\",\n          marginLeft: \"0 !important\",\n          \"& .MuiInputBase-root\": {\n            [theme.breakpoints.down('sm')]: {\n              fontSize: isExtraSmall ?? \"0.75rem\"\n            }\n          }\n        }}\n      >\n        <InputLabel id={`${label}-picker-label`}>{label}</InputLabel>\n        <Select\n          labelId={`${label}-picker-label`}\n          id={`${label}-picker`}\n          value={value}\n          label={label}\n          onChange={handleChange}\n        >\n          {isValidArray(options) &&\n            options.map((option) => (\n              <MenuItem key={option.value} value={option.value} is>\n                {option.label}\n              </MenuItem>\n            ))}\n        </Select>\n      </FormControl>\n    </Stack >\n  );\n};\n","import { useState, useEffect, useCallback } from \"react\";\nimport { Box, Stack, ToggleButtonGroup, ToggleButton, useMediaQuery, useTheme, Typography } from \"@mui/material\";\nimport WatchLaterIcon from '@mui/icons-material/WatchLater';\nimport { SimplePicker } from \"../AirQuality/AirQualityAlerts/AlertModificationDialog/AlertPropertyComponents/SimplePicker\";\nimport { HOURS } from \"./TimeRangeUtils\";\nimport { isValidArray } from \"../../Utils/UtilFunctions\";\nimport { PREDEFINED_TIMERANGES } from \"./TimeRangeUtils\";\n\nconst TimeRangeSelector = (props) => {\n    const { timeRange, defaultTimeRange, disabled, handleChange, isResponsive = false, hasTitle = false } = props;\n\n    const theme = useTheme();\n    const isLargeScreen = useMediaQuery(theme => theme.breakpoints.up('lg'));\n\n    const [displayFromToPickers, setDisplayFromToPickers] = useState(false);\n\n    // Always normalize into a [string, string]\n    const [startTime, endTime] = isValidArray(timeRange) ? timeRange : defaultTimeRange;\n\n    const [predefinedRange, setPredefinedRange] = useState(() => {\n        // Sync initial togglebutton state\n        const match = Object.values(PREDEFINED_TIMERANGES)\n            .find(r => r.start === startTime && r.end === endTime);\n        return match ? match.id : PREDEFINED_TIMERANGES.custom.id;\n    });\n\n    // When `timeRange` actually changes, keep buttons in sync:\n    useEffect(() => {\n        const match = Object.values(PREDEFINED_TIMERANGES)\n            .find(r => r.start === startTime && r.end === endTime);\n        setPredefinedRange(match ? match.id : PREDEFINED_TIMERANGES.custom.id);\n    }, [startTime, endTime]);\n\n    const handleModeChange = useCallback((_, newMode) => {\n        if (!newMode) return;\n        setPredefinedRange(newMode);\n        const range = PREDEFINED_TIMERANGES[newMode];\n        if (range.start != null && range.end != null) {\n            handleChange([range.start, range.end]);\n        }\n\n        // only display the hour pickers if custom time is used\n        setDisplayFromToPickers(newMode === PREDEFINED_TIMERANGES.custom.id);\n    }, [handleChange]);\n\n    // Add useMediaQuery to detect xs screens\n    const extraSmallScreen = useMediaQuery((theme) => theme.breakpoints.down('sm'));\n\n    return (\n        <Stack direction={hasTitle ? \"column\" : \"row\"} alignItems=\"start\" gap={0.5} width=\"100%\">\n            {\n                hasTitle ?\n                    (isLargeScreen && isResponsive ? <Typography color=\"text.secondary\" sx={{ textTransform: \"uppercase\" }}>Time Range</Typography> : null)\n                    : (\n                        <Box\n                            aria-hidden\n                            sx={{\n                                '& .MuiSvgIcon-root': {\n                                    color: disabled\n                                        ? theme.palette.text.secondary\n                                        : theme.palette.primary.main,\n                                    verticalAlign: \"-webkit-baseline-middle\"\n                                }\n                            }}\n                        >\n                            <WatchLaterIcon sx={{ mt: 0.75 }} />\n                        </Box>\n                    )\n            }\n\n            <Stack direction=\"column\" width=\"100%\" gap={1.5}>\n                <ToggleButtonGroup\n                    fullWidth={extraSmallScreen}\n                    color={disabled ? \"standard\" : \"primary\"}\n                    value={predefinedRange}\n                    exclusive\n                    onChange={handleModeChange}\n                    size=\"small\"\n                    disabled={disabled}\n                    orientation={isResponsive ?\n                        (isLargeScreen ? \"vertical\" : \"horizontal\") :\n                        \"horizontal\"\n                    }\n                >\n                    {Object.values(PREDEFINED_TIMERANGES).map((range, idx, arr) => (\n                        <ToggleButton\n                            key={range.id}\n                            value={range.id}\n                            aria-label={range.label}\n                            sx={{\n                                color: \"text.secondary\",\n                                textTransform: 'none',\n                                px: (idx === arr.length - 1) ? 2 : 1,\n                                py: 0.5,\n                                flex: (idx === arr.length - 1) ? 1 : undefined\n                            }}\n                            size=\"small\"\n                        >\n                            {range.label}\n                            {range.timeRangeLabel && (\n                                <>\n                                    &nbsp;({range.timeRangeLabel})\n                                </>\n                            )\n                            }\n                        </ToggleButton>\n                    ))}\n                </ToggleButtonGroup>\n\n                {\n                    displayFromToPickers ? (\n                        <Stack direction=\"row\" flex={1} gap={1}>\n                            <SimplePicker\n                                label=\"From\"\n                                value={startTime}\n                                options={HOURS}\n                                disabled={disabled || predefinedRange !== \"custom\"}\n                                handleChange={(e) => {\n                                    // Set toValue to null if new startTime is larger than endTime's current value\n                                    if (e.target.value > endTime) {\n                                        handleChange([e.target.value, null]);\n                                    }\n                                    // Else, proceed with startTime\n                                    else {\n                                        handleChange([e.target.value, endTime])\n                                    }\n                                }}\n                                flex={1}\n                            />\n                            <SimplePicker\n                                label=\"To\"\n                                value={endTime}\n                                options={HOURS.filter(h => h.value > startTime)}\n                                disabled={disabled || predefinedRange !== \"custom\"}\n                                handleChange={e => handleChange([startTime, e.target.value])}\n                                flex={1}\n                            />\n                        </Stack>\n                    ) : null\n                }\n            </Stack>\n        </Stack>\n    );\n};\n\n\nexport default TimeRangeSelector;\n","import { useContext, useState } from \"react\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\nimport TimeRangeSelector from \"./TimeRangeSelector\";\nimport { PREDEFINED_TIMERANGES } from \"./TimeRangeUtils\";\n\nconst TimeRangeSelectorWrapperForDataHook = (props) => {\n    const { defaultTimeRange, isResponsive, hasTitle, chartIndex } = props;\n\n    const { allChartsConfigs, updateIndividualChartConfigQueryParams } = useContext(DashboardContext);\n    const chartConfig = allChartsConfigs[chartIndex] || {};\n    const queryParams = chartConfig.queryParams || {};\n    const { startTime, endTime } = queryParams;\n\n    const [timeRange, setTimeRange] = useState([\n        startTime ?? defaultTimeRange.startTime,\n        endTime ?? defaultTimeRange.endTime,\n    ]);\n\n    return (\n        <TimeRangeSelector\n            timeRange={timeRange}\n            defaultTimeRange={defaultTimeRange}\n            handleChange={(newRange) => {\n                // Handle timeRange change  update DashboardContext queryParams\n                setTimeRange(newRange);\n\n                const [startTime, endTime] = newRange || [];\n                if (startTime === null || endTime === null || startTime > endTime) return;\n\n                // Change the config\n                if (startTime === PREDEFINED_TIMERANGES.allday.start && endTime === PREDEFINED_TIMERANGES.allday.end) {\n                    updateIndividualChartConfigQueryParams(chartIndex, {\n                        startTime: null,\n                        endTime: null\n                    });\n                } else {\n                    updateIndividualChartConfigQueryParams(chartIndex, {\n                        startTime,\n                        endTime\n                    });\n                }\n            }}\n            isResponsive={isResponsive}\n            hasTitle={hasTitle}\n        />\n    );\n}\n\nexport default TimeRangeSelectorWrapperForDataHook;","/* eslint-disable */\n\nimport { useContext, useEffect, useMemo, useState, useCallback } from 'react';\n\nimport { GoogleContext } from '../../ContextProviders/GoogleContext';\n\nimport { Box, Grid, Stack } from '@mui/material/';\n\nimport { useTheme } from '@mui/material/styles';\nimport SeriesSelector from './SubchartUtils/SeriesSelector';\nimport { generateRandomID, returnGenericOptions, returnChartControlUI, addTouchEventListenerForChartControl } from '../GoogleChartHelper';\n\nimport GoogleChartStyleWrapper from './SubchartUtils/GoogleChartStyleWrapper';\n\nimport LoadingAnimation from '../../Components/LoadingAnimation';\n\nimport NivoCalendarChart from './NivoCharts/NivoCalendarChart/NivoCalendarChart';\nimport { generateSvgFillGradient, BackgroundGradient } from '../../Utils/Gradient/GradientUtils';\n\nimport CustomDateRangePicker from '../../Components/DateRangePicker/CustomDateRangePicker'\nimport { isValidArray } from '../../Utils/UtilFunctions';\nimport { returnSelectedDataType } from '../../Utils/AirQuality/DataTypes';\n\nimport AxesPicker from '../../Components/AxesPicker/AxesPicker';\n\nimport NoChartToRender from './NoChartToRender';\nimport { PREDEFINED_TIMERANGES } from '../../Components/TimeRange/TimeRangeUtils';\nimport TimeRangeSelectorWrapperForDataHook from '../../Components/TimeRange/TimeRangeSelectorWrapperForDataHook';\n\nexport default function SubChart(props) {\n  // Props\n  const { chartData, subchartIndex, windowSize, isPortrait, height, maxHeight, selectedDataType, allowedDataTypes } = props;\n\n  // Use GoogleContext for loading and manipulating the Google Charts\n  const google = useContext(GoogleContext);\n\n  // States of the Google Charts\n  const [dataTable, setDataTable] = useState();\n  const [chartWrapper, setChartWrapper] = useState();\n  const [controlWrapper, setControlWrapper] = useState();\n\n  const [previousChartData, setPreviousChartData] = useState();\n\n  // Get the current theme\n  const theme = useTheme();\n\n  // To determine the first time the chart renders to show/hide the LoadingAnimation\n  const [isFirstRender, setIsFirstRender] = useState(true);\n\n  // To determine if the charts should be rendered or not\n  const [shouldRenderChart, setShouldRenderChart] = useState(true);\n  const [renderChartNow, setRenderChartNow] = useState(false);\n\n  // Keep track of the columns (series) of the chart\n  const [allInitialColumns, setAllInitialColumns] = useState();\n  const [dataColumns, setDataColumns] = useState();\n  const [initialVAxisRange, setInitialVAxisRage] = useState();\n\n  // Define the DOM container's ID for drawing the google chart inside\n  const [chartID, __] = useState(generateRandomID());\n\n  // Get the options object for chart\n  const options = useMemo(() => {\n    return returnGenericOptions({ ...props, theme });\n  }, [props, theme, chartData.chartType]);\n\n  // State to store transformed data for CalendarChart\n  const [calendarDataArray, setCalendarDataArray] = useState(null);\n\n  // Early exit for 'Calendar' chartType\n  if (chartData.chartType === 'Calendar') {\n    useEffect(() => {\n      const dataArray = chartData.dataArray\n        || (chartData.subcharts\n          && chartData.subcharts[subchartIndex].dataArray)\n        || null\n        || null;\n\n      if (!isValidArray(dataArray)) {\n        setShouldRenderChart(false);\n        return; // early return if there is no data to render\n      }\n\n      setCalendarDataArray(dataArray)\n      setShouldRenderChart(true);\n    }, [chartData]);\n\n    if (!calendarDataArray) {\n      return (\n        <Box sx={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%' }}>\n          <LoadingAnimation />\n        </Box>\n      )\n    }\n\n    return (\n      shouldRenderChart ? (\n        <NivoCalendarChart\n          dataArray={calendarDataArray}\n          valueRangeBoxTitle={returnSelectedDataType({ dataTypeKey: selectedDataType, dataTypes: allowedDataTypes, showUnit: true })}\n          isPortrait={isPortrait}\n          options={options}\n          windowSize={windowSize}\n        />\n      ) : (\n        <>\n          <NoChartToRender dataType={returnSelectedDataType({ dataTypeKey: selectedDataType, dataTypes: allowedDataTypes })} />\n          <NivoCalendarChart\n            dataArray={[]}\n            valueRangeBoxTitle={returnSelectedDataType({ dataTypeKey: selectedDataType, dataTypes: allowedDataTypes, showUnit: true })}\n            isPortrait={isPortrait}\n            options={options}\n            windowSize={windowSize}\n          />\n        </>\n      )\n    );\n  }\n\n  // Properties for chart control (if existed)\n  let hasChartControl = false;\n  let chartControlOptions;\n  // Only show the chart control if:\n  // It exists in the database (either for all subcharts or just for a particular subchart)\n  // And if the chart is currently not shown on homePage\n  let chartControl = chartData.control || chartData.subcharts?.[subchartIndex].control;\n  if (chartControl) {\n    hasChartControl = true;\n\n    // Get the options for chartControl if hasChartControl\n    chartControlOptions = {\n      ...chartControl.options,\n      ui: returnChartControlUI({\n        chartControl,\n        mainChartData: chartData,\n        mainChartOptions: options,\n        subchartIndex,\n        theme,\n        isPortrait\n      })\n    };\n\n    // Swap touch events for mouse events on ChartRangeControl\n    // as it doesn't support touch events on mobile\n    if (chartControl.controlType === 'ChartRangeFilter') {\n      useEffect(() => {\n        const cleanupTouchEventListener = addTouchEventListenerForChartControl({ controlWrapper, chartID });\n        return cleanupTouchEventListener;\n      }, [controlWrapper]);\n    }\n  }\n\n  // Properties for selecting (showing or hiding) the serie(s)\n  const seriesSelector = options.seriesSelector || false;\n\n  // Properties for date-range-picker and time range selector\n  const dateRangePicker = options.dateRangePicker || null;\n  const timeRangeSelector = options.timeRangeSelector || null;\n\n  // Properties for data formatters\n  const formatters = options.formatters || null;\n\n  // Properties for selectableAxes\n  let selectableAxes = chartData.selectableAxes || null;\n  if (selectableAxes) {\n    if (isValidArray(selectableAxes.allowedAxes)) {\n      if (selectableAxes.allowedAxes.length <= 2) selectableAxes = null; // don't display selectableAxes if number of allowedSensors is less than 3\n    }\n  }\n\n  const hasAtLeastOneAuxillaryControl = seriesSelector || dateRangePicker || selectableAxes || timeRangeSelector;\n\n  // Set new options prop and re-render the chart if theme or isPortrait changes\n  useEffect(() => {\n    if (seriesSelector) handleSeriesSelection({ newDataColumns: dataColumns }); // this function set new options, too\n    else {\n      chartWrapper?.setOptions({\n        ...options\n      });\n\n      chartWrapper?.draw();\n      if (hasChartControl) {\n        controlWrapper?.setOptions(chartControlOptions);\n        controlWrapper?.draw();\n      }\n    }\n  }, [theme, isPortrait, windowSize]);\n\n  // Set new initialColumnsColors if the theme changes\n  // This only applies to when seriesSelector.method == \"setViewColumn\"\n  useEffect(() => {\n    if (!dataColumns) return;\n    if (seriesSelector && seriesSelector.method == \"setViewColumn\") {\n      setInitialColumnsColors({ dataColumns: dataColumns });\n      handleSeriesSelection({ newDataColumns: dataColumns });\n    }\n  }, [theme]);\n\n  const getInitialColumns = ({ chartWrapper, dataTable, seriesSelector }) => {\n    const prevSelections = dataColumns?.map(c => ({ label: c.label, selected: c.selected })) || [];\n\n    // Update the initial DataView's columns (often, all of the series are displayed initially)\n    // If (optional) columns is not specified in database\n    // Assign it from DataTable\n    let initialView = chartWrapper.getView();\n    if (initialView.columns == null) {\n      const viewFromDataTable = new google.visualization.DataView(dataTable);\n      chartWrapper.setView({ columns: viewFromDataTable.columns });\n      initialView = chartWrapper.getView();\n    }\n\n    let shouldAssignDomainRoleToFistColumn = true; // variable to only assign type: 'domain' to the very first column\n    let dataSeriesIndex = 0;\n\n    const allInitialColumns = initialView.columns.map((col, index) => {\n      // A column can either be a number (that denotes the index of the sourceColumn) or an object\n      // The code below harmonize all columns to be an object to store crucial data to toggle their visibility\n      if (typeof col === 'number') {\n        col = {\n          role: shouldAssignDomainRoleToFistColumn ? 'domain' : 'data',\n          sourceColumn: col,\n        };\n      }\n\n      col.label = dataTable.getColumnLabel(col.sourceColumn);\n      col.indexInAllInitialColumns = index;\n      shouldAssignDomainRoleToFistColumn = false;\n\n      // Set the visibility of data column, \n      if (col.role === 'data') {\n        // First, try to restore previous selection by label\n        const prev = prevSelections.find(p => p.label === col.label);\n        if (prev) {\n          col.selected = prev.selected;\n        } else {\n          // Else, fallback to default logic if new series or first load (if defaultSeriesToDisplayInitially is available)\n          if (seriesSelector.defaultSeriesToDisplayInitially) {\n            col.selected = seriesSelector.defaultSeriesToDisplayInitially.includes(index);\n          }\n          // Else of no defaultSeriesToDisplayInitially is presented, then, all data columns are selected if multiple series are selectable\n          else if (seriesSelector.allowMultiple) {\n            col.selected = true;\n          } else {\n            // Else, for single serie selector, only first data column is selected\n            col.selected = (dataSeriesIndex === 0);\n          }\n        }\n        col.seriesIndex = dataSeriesIndex;\n        dataSeriesIndex++;\n      }\n\n      return col;\n    });\n\n    setAllInitialColumns(allInitialColumns);\n\n    const initialVAxisRange = getInitialVAxisRange({ dataTable, allInitialColumns });\n    setInitialVAxisRage(initialVAxisRange);\n\n    const dataCols = allInitialColumns.filter(col => col.role === 'data' && options.series?.[col.seriesIndex]?.visibleInLegend !== false);\n\n    if (seriesSelector.method === \"setViewColumn\") setInitialColumnsColors({ dataColumns: dataCols });\n\n    setDataColumns(dataCols);\n\n    return { initAllInitialColumns: allInitialColumns, initDataColumns: dataCols };\n  };\n\n\n  const setInitialColumnsColors = ({ dataColumns }) => {\n    dataColumns.forEach((col) => {\n      // Assign inherit color to this data column\n      col.color = options.colors[col.seriesIndex % options.colors.length];\n      // Assign other inherit attributes from its serie object (if existed)\n      col.serieAttribute = options.series?.[col.seriesIndex];\n    });\n  }\n\n  const getInitialVAxisRange = ({ dataTable, allInitialColumns }) => {\n    let vAxisMin, vAxisMax;\n    allInitialColumns.forEach((col, index) => {\n      if (index === 0) return; // the first column is the domain (hAxis)\n      const range = dataTable.getColumnRange(col.sourceColumn);\n      if (!isNaN(range.min) && range.min) vAxisMin = vAxisMin ? Math.min(vAxisMin, range.min) : range.min;\n      if (!isNaN(range.max) && range.max) vAxisMax = vAxisMax ? Math.max(vAxisMax, range.max) : range.max;\n    });\n    return { min: vAxisMin, max: vAxisMax };\n  }\n\n  const handleSeriesSelection = useCallback(({\n    newDataColumns,\n    _allInitialColumns = allInitialColumns,\n    _chartWrapper = chartWrapper,\n    _controlWrapper = controlWrapper\n  }) => {\n    if (!_allInitialColumns) return;\n\n    setDataColumns(newDataColumns);\n\n    if (seriesSelector.method === \"toggleVisibility\" || seriesSelector.method === null) {\n      const hiddenSeriesObject = {};\n      newDataColumns.forEach((col) => {\n        if (!col.selected)\n          hiddenSeriesObject[col.seriesIndex] = {\n            color: 'transparent',\n            enableInteractivity: false,\n            visibleInLegend: false\n          }; // 'hide' the serie by making it transparent\n      });\n\n      _chartWrapper?.setOptions({\n        ...options,\n        series: {\n          ...options.series,\n          ...hiddenSeriesObject\n        }\n      });\n\n      if (hasChartControl) {\n        const currentControlOptions = _controlWrapper?.getOptions();\n        _controlWrapper?.setOptions({\n          ...currentControlOptions,\n          ui: {\n            ...currentControlOptions.ui,\n            chartOptions: {\n              ...currentControlOptions.ui.chartOptions,\n              series: {\n                ...options.series,\n                ...hiddenSeriesObject\n              }\n            }\n          }\n        });\n      }\n    }\n    else if (seriesSelector.method === \"setViewColumn\") {\n      let newViewColumns = [];\n      newViewColumns.push(0); // this is the domain column\n      newDataColumns.forEach((dataColumn) => {\n        if (dataColumn.selected) {\n          newViewColumns.push(dataColumn);\n          // Find this dataColumn's supporting columns (whose role !== 'data')\n          // A dataColumn has its supporting columns (can be many) follow it immediately\n          if (isValidArray(_allInitialColumns)) {\n            for (let i = dataColumn.indexIn_ + 1; i < _allInitialColumns.length; i++) {\n              if (_allInitialColumns[i].role !== 'data') {\n                newViewColumns.push(_allInitialColumns[i]);\n              }\n              // If this loop encounter the next dataColumn, break the loop, all supporting columns for this dataColumn have been discovered\n              else {\n                break;\n              }\n            }\n          }\n        }\n      });\n      _chartWrapper?.setView({ columns: newViewColumns });\n\n      const newOptions = { ...options };\n      // Preserve the initial vAxis range so that the vAxis doesn't shift based on the visible serie(s)\n      // newOptions.vAxis.viewWindow = {\n      //   min: (options.vAxis.viewWindow.min == null) ? initialVAxisRange.min : options.vAxis.viewWindow.min,\n      //   max: (options.vAxis.viewWindow.max == null) ? initialVAxisRange.max : options.vAxis.viewWindow.max,\n      // }\n      // Set the new color array\n      newOptions.colors = newDataColumns.filter((col) => col.selected).map((col) => col.color);\n      // Set the new series object (if any)\n      // this contains other series' attributes (lineWidth, seriesType...)\n      const series = {};\n      let selectedSeriesCount = 0;\n      newDataColumns.forEach((col) => {\n        if (!col.selected) return;\n        if (col.serieAttribute != null) {\n          series[selectedSeriesCount] = col.serieAttribute;\n        }\n        selectedSeriesCount++;\n      })\n      newOptions.series = series;\n      _chartWrapper?.setOptions(newOptions);\n\n      if (hasChartControl) {\n        const currentControlOptions = _controlWrapper?.getOptions();\n        _controlWrapper?.setOptions({\n          ...currentControlOptions,\n          ui: {\n            ...currentControlOptions.ui,\n            chartOptions: {\n              ...currentControlOptions.ui.chartOptions,\n              colors: newOptions.colors,\n              series: newOptions.series\n            },\n            chartView: {\n              columns: newViewColumns\n            }\n          }\n        });\n      }\n    }\n\n    // Call draw to apply the new DataView and 'refresh' the chart\n    _chartWrapper?.draw();\n\n    if (hasChartControl) {\n      _controlWrapper?.draw();\n    }\n  }, [allInitialColumns, options, seriesSelector, chartWrapper, controlWrapper, initialVAxisRange, hasChartControl]);\n\n  const reconstructFunctionFromJSONstring = (columns) => {\n    if (!columns) return;\n\n    const evaluatedColumns = [];\n    for (const column of columns) {\n      if (typeof column === 'number') {\n        // If it's a number, add it as-is\n        evaluatedColumns.push(column);\n      } else if (typeof column === 'object') {\n        if (column.calc && column.calc !== 'stringify') {\n          // If it's an object with a 'calc' property, evaluate the 'calc' function\n          // using new Function() and add the result to the evaluatedColumns array\n          const calcFunction = new Function(\"dataTable\", \"rowNum\", column.calc);\n          evaluatedColumns.push({\n            ...column,\n            calc: calcFunction,\n          });\n        } else {\n          // If it's an object without a 'calc' property, or with calc = 'stringify', add it as-is\n          evaluatedColumns.push(column);\n        }\n      }\n    }\n    return evaluatedColumns;\n  }\n\n  // Prepare to draw the chart if there is any change in chartData\n  // but only set flag renderChartNow if the chart should draw in the next rendering cycle\n  // to prevent chartID container not being mounted on time\n  useEffect(() => {\n    if (google && chartData) {\n      // Do not draw again if deep comparison between current chartData and previousChartData is true\n      if (JSON.stringify(chartData) === JSON.stringify(previousChartData)) return;\n      setPreviousChartData(chartData);\n\n      // Get and set the dataArray \n      const dataArray = chartData.dataArray\n        || (chartData.subcharts\n          && chartData.subcharts[subchartIndex].dataArray)\n        || null\n        || null;\n\n      const _shouldRenderChart = isValidArray(dataArray);\n      setShouldRenderChart(_shouldRenderChart);\n      if (_shouldRenderChart === true) {\n        setRenderChartNow(true);\n        const dataTable = google.visualization.arrayToDataTable(dataArray);\n\n        // Call functions for formatting the number if numberFormat/dateFormat is specified \n        if (formatters && typeof formatters === 'object') {\n          if (formatters.hasOwnProperty(\"numberFormatter\")) {\n            const numberFormat = new google.visualization.NumberFormat(formatters.numberFormatter.numberFormat);\n            formatters.numberFormatter.columns.forEach(col => numberFormat.format(dataTable, col));\n          }\n        }\n        setDataTable(dataTable);\n      }\n    }\n  }, [google, chartData]);\n\n  // Actually draw the chart now because chartID container is already mounted from shouldRenderChart flag\n  useEffect(() => {\n    if (renderChartNow === true) {\n      // Get dataColumn views\n      const columns = chartData.columns\n        || (chartData.subcharts\n          && chartData.subcharts[subchartIndex].columns)\n        || null\n        || null;\n      const reconstructedColumns = reconstructFunctionFromJSONstring(columns);\n\n      // Create chartWrapper\n      const thisChartWrapper = new google.visualization.ChartWrapper({\n        chartType: chartData.chartType,\n        dataTable: (!hasChartControl) ? dataTable : undefined,\n        options: options,\n        view: {\n          columns: reconstructedColumns\n        },\n        containerId: chartID\n      });\n      setChartWrapper(thisChartWrapper);\n\n      let thisControlWrapper;\n      if (hasChartControl) {\n        const thisDashboardWrapper = new google.visualization.Dashboard(\n          document.getElementById(`dashboard-${chartID}`));\n\n        google.visualization.events.addListener(thisDashboardWrapper, 'ready', onChartReady);\n\n        thisControlWrapper = new google.visualization.ControlWrapper({\n          controlType: chartControl.controlType,\n          options: chartControlOptions,\n          containerId: `${chartControl.controlType === \"CategoryFilter\" ? \"CategoryFilter\" : \"other-chart-control\"}-${chartID}`\n        });\n        setControlWrapper(thisControlWrapper);\n\n        // Establish dependencies\n        thisDashboardWrapper.bind(thisControlWrapper, thisChartWrapper);\n\n        thisDashboardWrapper.draw(dataTable);\n      }\n      else {\n        google.visualization.events.addListener(thisChartWrapper, 'ready', onChartReady);\n        thisChartWrapper.draw();\n      }\n\n      // Run the seriesSelector for the first time\n      if (seriesSelector) {\n        const { initAllInitialColumns, initDataColumns } = getInitialColumns({ chartWrapper: thisChartWrapper, dataTable: dataTable, seriesSelector: seriesSelector });\n        handleSeriesSelection({\n          _allInitialColumns: initAllInitialColumns,\n          newDataColumns: initDataColumns,\n          _chartWrapper: thisChartWrapper,\n          _controlWrapper: thisControlWrapper\n        });\n      }\n\n      setRenderChartNow(false);\n    }\n  }, [renderChartNow])\n\n  const renderChart = () => {\n    return (\n      <Grid id={`dashboard-${chartID}`} container alignItems=\"start\">\n        {hasAtLeastOneAuxillaryControl && (\n          <Grid lg={2} container item\n            sx={{\n              mt: 1,\n              ml: 2,\n              gap: 2,\n              [theme.breakpoints.down('lg')]: { gap: 1, ml: 0 }\n            }}\n          >\n            {\n              isFirstRender === false && (\n                <>\n                  {seriesSelector &&\n                    <Grid item xs=\"auto\" lg={12}\n                      sx={{\n                        [theme.breakpoints.down('sm')]: { width: '100%' }\n                      }}\n                    >\n                      <SeriesSelector\n                        items={dataColumns}\n                        allowMultiple={seriesSelector.allowMultiple}\n                        seriesLabel={seriesSelector.seriesLabel}\n                        selectorID={`${chartData.title}-selector`}\n                        onSeriesSelection={handleSeriesSelection}\n                        displayChip={false}\n                      />\n                    </Grid>\n                  }\n\n                  {\n                    dateRangePicker &&\n                    <CustomDateRangePicker\n                      minDateOfDataset={new Date(dateRangePicker.minDate)}\n                      chartIndex={chartData.id}\n                    />\n                  }\n\n                  {selectableAxes &&\n                    <AxesPicker\n                      chartID={chartData.id}\n                      allowedAxes={selectableAxes.allowedAxes}\n                      selectedAxes={selectableAxes.selectedAxes}\n                      dataType={selectedDataType}\n                    />\n                  }\n\n                  {\n                    timeRangeSelector &&\n                    <Grid item xs=\"auto\" lg={12}\n                      sx={{\n                        [theme.breakpoints.down('sm')]: { width: '100%' }\n                      }}\n                    >\n                      <TimeRangeSelectorWrapperForDataHook\n                        defaultTimeRange={[PREDEFINED_TIMERANGES.allday.start, PREDEFINED_TIMERANGES.allday.end]}\n                        handleChange={() => {\n                          return null;\n                        }}\n                        isResponsive\n                        hasTitle\n                        chartIndex={chartData.id}\n                      />\n                    </Grid>\n                  }\n                </>\n              )\n            }\n\n            <Grid item xs=\"auto\" lg={12}\n              sx={{\n                [theme.breakpoints.down('sm')]: { width: '100%' }\n              }}\n            >\n              {/* Special div for CategoryFilter to align its position with other auxillary controls */}\n              <Box\n                id={`CategoryFilter-${chartID}`} sx={{\n                  display: hasChartControl && chartControl.controlType === 'CategoryFilter' ? \"block\" : \"none\"\n                }} />\n            </Grid>\n          </Grid>\n        )}\n\n        <Grid item xs>\n          <Stack>\n            <Box\n              id={chartID}\n              sx={{ height: height, maxHeight: maxHeight }}\n            />\n\n            {/* Div for all other types of chart control */}\n            <Box\n              id={`other-chart-control-${chartID}`}\n              sx={{\n                display: (hasChartControl && chartControl.controlType !== 'CategoryFilter') ? \"block\" : \"none\",\n                height: `calc(${height} / 8)`,\n                filter: 'saturate(0.3)',\n                opacity: 0.7\n              }}\n            />\n          </Stack>\n        </Grid>\n      </Grid>\n    )\n  };\n\n  // Generate the gradient background if it exists in options parameter\n  const gradientBackgroundColor = options.gradientBackgroundColor;\n  let gradientBackgroundId, svgFillGradient;\n  if (gradientBackgroundColor) {\n    gradientBackgroundId = `${chartID}-backgroundGradient`;\n    svgFillGradient = generateSvgFillGradient({\n      colors: theme.palette.chart.colorAxes[gradientBackgroundColor].colors,\n      optionalMinValue: options.vAxis?.viewWindow?.min,\n      optionalMaxValue: options.vAxis?.viewWindow?.max\n    });\n  }\n\n  const onChartReady = () => {\n    if (!isFirstRender) return;\n    // Hide the circleProgress when chart finishes rendering the first time\n    setIsFirstRender(false);\n  };\n\n  const showAuxiliaryControls = () => {\n    if (!isFirstRender) {\n      return (\n        <>\n\n        </>\n      );\n    } else {\n      return null;\n    }\n  };\n\n  return (\n    shouldRenderChart ?\n      (\n        <GoogleChartStyleWrapper\n          isPortrait={isPortrait}\n          gradientBackgroundId={gradientBackgroundId}\n          className={chartData.chartType}\n          position=\"relative\"\n          height=\"100%\"\n          minHeight={chartData.chartType === 'Calendar' && '200px'}\n        >\n          {/* Conditionally display loading animation here */}\n          {isFirstRender && (\n            <Box sx={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%' }}>\n              <LoadingAnimation />\n            </Box>\n          )}\n          {renderChart()}\n          {gradientBackgroundColor ? <BackgroundGradient id={gradientBackgroundId} colors={svgFillGradient} /> : null}\n        </GoogleChartStyleWrapper>\n      ) :\n      (\n        <NoChartToRender\n          dataType={returnSelectedDataType({ dataTypeKey: selectedDataType, dataTypes: allowedDataTypes })}\n          selectableAxes={selectableAxes}\n          // If the visualization has a series selector or control, we need to account for its height\n          // And since the height is a string, we need to parse it to a number before adding to it\n          height={seriesSelector || hasChartControl ? (parseFloat(height) * 1.2 + 'vw') : height}\n\n        />\n      )\n  );\n}","import { useState, useRef } from 'react';\nimport Box from '@mui/material/Box';\nimport Typography from '@mui/material/Typography';\nimport ClickAwayListener from '@mui/material/ClickAwayListener';\nimport parse from 'html-react-parser';\nimport { useMediaQuery, useTheme } from '@mui/material';\nimport { replacePlainHTMLWithMuiComponents } from '../Utils/UtilFunctions';\n\nfunction CollapsibleSubtitle({ text, wordLimit = 40, reference }) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n  const subtitleRef = useRef(null);\n\n  const words = text.split(' ');\n\n  // If not on mobile or words are within limit, just display the full text\n  if (!isMobile || words.length / wordLimit <= 1.4) {\n    return (\n      <Box>\n        <Typography>{parse(text, { replace: replacePlainHTMLWithMuiComponents })}</Typography>\n        {reference && (\n          <Typography variant=\"caption\" color=\"text.secondary\">\n            {parse(reference, { replace: replacePlainHTMLWithMuiComponents })}\n          </Typography>\n        )}\n      </Box>\n    );\n  }\n\n  let displayText = words.slice(0, wordLimit).join(' ');\n  const lastFullStop = displayText.lastIndexOf('.');\n\n  if (lastFullStop !== -1) {\n    displayText = displayText.slice(0, lastFullStop + 1);\n  }\n\n  // Do not collapse if the user clicks on the chart associated with the subtitle\n  const isClickWithinSharedParent = (event) => {\n    let { target } = event;\n    // .MuiContainer-root - Container for both the subtitle and the chart\n    const subtitleParent = subtitleRef.current.closest('.MuiContainer-root');\n    // Elements used to detect if the click is on a chart\n    const chartElements = new Set(['rect', 'path', 'svg', 'circle']);\n\n    while (target != null) {\n      // Check if a chart is clicked\n      if (chartElements.has(target?.tagName)) {\n        // If the chart element and the subtitle element share the same container\n        // it means that the click is on the chart associated with the subtitle\n        // As such, we should not collapse the subtitle\n        const targetParent = target.closest('.MuiContainer-root');\n        return targetParent === subtitleParent;\n      }\n      target = target.parentNode; // Move up the DOM tree\n    }\n    return false;\n  };\n\n  // Custom onClickAway handler\n  const handleOnClickAway = (event) => {\n    if (!isClickWithinSharedParent(event)) {\n      setIsExpanded(false);\n    }\n  };\n\n  return (\n    <ClickAwayListener onClickAway={handleOnClickAway}>\n      <Box ref={subtitleRef} onClick={() => setIsExpanded(!isExpanded)} style={{ cursor: 'pointer' }}>\n        {isExpanded ? (\n          <>\n            <Typography>{parse(text, { replace: replacePlainHTMLWithMuiComponents })}</Typography>\n            {reference && <Typography variant=\"caption\" color=\"text.secondary\">{parse(reference, { replace: replacePlainHTMLWithMuiComponents })}</Typography>}\n          </>\n        ) : (\n          <>\n            <Typography display=\"inline\">\n              {parse(displayText, { replace: replacePlainHTMLWithMuiComponents })}\n              ...\n            </Typography>\n            <Typography display=\"inline\" color=\"text.primary\" fontWeight=\"500\" sx={{ ml: 0.5, '& :hover': { textDecoration: 'underline' } }}>\n              See more\n            </Typography>\n          </>\n        )}\n      </Box>\n    </ClickAwayListener>\n  );\n}\n\nexport default CollapsibleSubtitle;\n","import { useContext, useState } from \"react\";\nimport { Button, Menu, MenuItem, Typography } from \"@mui/material\";\nimport { isValidArray } from \"../Utils/UtilFunctions\";\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\nimport { returnSelectedDataType } from \"../Utils/AirQuality/DataTypes\";\nimport { DashboardContext } from \"../ContextProviders/DashboardContext\";\n\nconst DataTypeDropDownMenu = ({ selectedDataType, dataTypes, chartID }) => {\n  const { updateIndividualChartConfigQueryParams } = useContext(DashboardContext);\n\n  const [anchorEl, setAnchorEl] = useState(null);\n\n  if (!isValidArray(dataTypes)) return null;\n\n  // If there is only 1 dataType, display it as a string of text\n  if (dataTypes.length <= 1) {\n    return (\n      <Typography display=\"inline\" variant=\"h6\" color=\"text.primary\">\n        {dataTypes[0].name_title}\n      </Typography>\n    )\n  }\n\n  // If there are more than 1 dataTypes to choose from, display a popup dropdown menu\n  const open = Boolean(anchorEl);\n\n  const handleClick = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleMenuItemClick = (dataType) => {\n    updateIndividualChartConfigQueryParams(chartID, { dataType })\n    handleClose();\n  };\n\n  return (\n    <>\n      <Button\n        id=\"data-type-drop-down-menu-button\"\n        aria-controls={open ? 'data-type-drop-down-menu' : undefined}\n        aria-haspopup=\"true\"\n        aria-expanded={open ? 'true' : undefined}\n        onClick={handleClick}\n        variant=\"text\"\n        size=\"small\"\n        sx={{\n          p: 0,\n          minWidth: 'unset',\n          borderRadius: 0,\n          verticalAlign: 'top',\n          textTransform: 'unset'\n        }}\n      >\n        <Typography display=\"inline\" variant=\"h6\" borderBottom=\"dotted\">\n          {returnSelectedDataType({ dataTypeKey: selectedDataType, dataTypes: dataTypes, showUnit: true })}\n        </Typography>\n        <ArrowDropDownIcon />\n      </Button>\n      <Menu\n        id=\"data-type-drop-down-menu\"\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleClose}\n        MenuListProps={{\n          'aria-labelledby': 'data-type-drop-down-menu-button',\n        }}\n      >\n\n        {dataTypes.map((dataType, index) => (\n          <MenuItem\n            key={index}\n            sx={{ fontSize: '0.8rem' }}\n            onClick={() => handleMenuItemClick(dataType.key)}\n          >\n            {dataType.name_title}\n          </MenuItem>\n        ))}\n\n      </Menu>\n    </>\n  );\n};\n\nexport default DataTypeDropDownMenu;","import { styled } from '@mui/material/styles';\nimport { Tabs } from '@mui/material/';\n\nexport const StyledTabs = styled(Tabs, {\n  shouldForwardProp: (prop) => prop !== 'smallFontSize',\n})(({ theme, smallFontSize = '0.625rem' }) => ({\n  '& .MuiTabScrollButton-root': {\n    color: theme.palette.text.primary\n  },\n  '& .MuiTab-root': {\n    [theme.breakpoints.down('sm')]: {\n      fontSize: smallFontSize,\n      padding: theme.spacing(0.5)\n    },\n  },\n  '& .MuiSvgIcon-root ': {\n    [theme.breakpoints.down('sm')]: {\n      fontSize: \"1rem\"\n    }\n  }\n}));\n\nexport default StyledTabs;","import { useState, useEffect, useContext } from 'react';\nimport { styled } from '@mui/material/styles';\nimport { Box, Tab, useMediaQuery, Typography, Menu, MenuItem, Stack } from '@mui/material/';\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\n\nimport { DataTypes } from '../Utils/AirQuality/DataTypes';\nimport { DashboardContext } from \"../ContextProviders/DashboardContext\";\n\nimport SubChart from './Subchart/SubChart';\n\nimport CollapsibleSubtitle from '../Components/CollapsibleSubtitle';\nimport VisibilityIcon from '@mui/icons-material/Visibility';\nimport DataTypeDropDownMenu from './DataTypeDropDown';\nimport { isValidArray } from '../Utils/UtilFunctions';\nimport StyledTabs from '../Components/StyledTabs';\nimport NoChartToRender from './Subchart/NoChartToRender';\nimport useChartData from '../hooks/useChartData';\nimport LoadingAnimation from '../Components/LoadingAnimation';\n\nconst DEBOUNCE_IN_MILLISECONDS = 100;\n\nconst MAX_NUM_TABS_TO_DISPLAY = 3;\nconst INITIAL_DROPDOWN_MENU_TAB_INDEX = -1;\n\nconst ChartStyleWrapper = styled(Box)(({ theme }) => ({\n  // CSS for dark theme only\n  ...(theme.palette.mode === 'dark' && {\n    // De-saturate a bit\n    filter: 'saturate(0.85)',\n    // Invert iframe\n    '& .heat-map-iframe': {\n      filter: 'invert(0.848) hue-rotate(180deg)',\n    }\n  }),\n  // Center Calendar chart in wrapper\n  '& .Calendar [dir]:not(:empty)': {\n    margin: 'auto'\n  },\n\n  // add horizontal scrollbar to Calendar charts\n  '& .Calendar > div > div:last-of-type > div': {\n    overflowX: 'auto',\n    overflowY: 'hidden',\n    scrollbarGutter: 'stable'\n  }\n}));\n\nconst StyledMenuItem = styled(MenuItem)(({ theme }) => ({\n  '& .MuiBox-root ': {\n    [theme.breakpoints.down('sm')]: {\n      fontSize: '0.75rem'\n    },\n  }\n}));\n\n// eslint-disable-next-line max-len\nfunction ChartComponentWrapper({ chartID }) {\n  const { data: chartData, isLoading, isFetching, error } = useChartData(chartID);\n\n  const { currentSchoolID } = useContext(DashboardContext);\n\n  const isSmallWidth = useMediaQuery((theme) => theme.breakpoints.down('sm'));\n\n  const [isPortrait, setIsPortrait] = useState(window.matchMedia('(orientation: portrait)').matches);\n  const [windowSize, setWindowSize] = useState([\n    window.innerWidth,\n    window.innerHeight,\n  ]);\n\n  // Props for tab panels (multiple data visualizations in the same chart area, navigate with tab panels)\n  const [currentTab, setCurrentTab] = useState(0); // start with the first tab\n  const [previousTab, setPreviousTab] = useState(0); // keep tracking of previous tab to keep displaying it if the currentTab = initialDropdownMenuTabIndex (selecting the dropdown menu tab)\n  const [dropdownMenuTabIndex, setDropdownMenuTabIndex] = useState(INITIAL_DROPDOWN_MENU_TAB_INDEX);\n  const [dropdownMenuCurrentTitle, setDropdownMenuCurrentTitle] = useState();\n  const [anchorEl, setAnchorEl] = useState(null); // Define anchorEl state for dropdown menu of the tabs\n\n  // Props for dataType management\n  const [allowedDataTypes, setAllowedDataTypes] = useState([]);\n  const [selectedDataType, setSelectedDataType] = useState(null);\n\n  const initializeAllowedDataTypes = (chartData, setAllowedDataTypes, setSelectedDataType) => {\n    if (!chartData?.allowedDataTypes) return;\n\n    const dataTypesArr = chartData.allowedDataTypes.map((dataType) => {\n      const { name_title, name_short, unit } = DataTypes[dataType];\n      return {\n        key: dataType,\n        name_title,\n        name_short,\n        unit,\n      };\n    });\n\n    setAllowedDataTypes(dataTypesArr);\n    setSelectedDataType(chartData.selectedDataType);\n  };\n\n  const setupResizeListener = (setWindowSize, setIsPortrait, DEBOUNCE_IN_MILLISECONDS) => {\n    let timeoutID = null;\n\n    const handleWindowResize = () => {\n      clearTimeout(timeoutID);\n\n      timeoutID = setTimeout(() => {\n        setIsPortrait(window.matchMedia('(orientation: portrait)').matches);\n        setWindowSize([window.innerWidth, window.innerHeight]);\n      }, DEBOUNCE_IN_MILLISECONDS);\n    };\n\n    window.addEventListener('resize', handleWindowResize);\n\n    return () => {\n      window.removeEventListener('resize', handleWindowResize);\n    };\n  };\n\n  useEffect(() => {\n    if (!chartData) return;\n\n    // Initialize allowed data types\n    initializeAllowedDataTypes(chartData, setAllowedDataTypes, setSelectedDataType);\n\n    // Setup resize listener\n    const cleanupResize = setupResizeListener(setWindowSize, setIsPortrait, DEBOUNCE_IN_MILLISECONDS);\n\n    // Cleanup listener on unmount\n    return cleanupResize;\n  }, [chartData]);\n\n  // eventListener for window resize\n  // redraw \"Calendar\" charts and charts with a time filter upon window resize.\n  // Filter & Calendar charts are not automatically respnsive, so we have to redraw them.\n  // redraw other charts when device orientation changes\n  useEffect(() => {\n    let timeoutID = null;\n\n    const handleWindowResize = () => {\n      clearTimeout(timeoutID);\n\n      // debounce before triggering re-render. as user is resizing window, the state could\n      // change multiple times causing many expensive rerenders. we try to rerender at the\n      // end of the resize.\n      timeoutID = setTimeout(() => {\n        // Redraw all charts on device orientation change, as the chartWrapperHeights\n        // have changed.\n        setIsPortrait(window.matchMedia('(orientation: portrait)').matches);\n\n        // Redraw all charts on window resized\n        setWindowSize([window.innerWidth, window.innerHeight]);\n      }, DEBOUNCE_IN_MILLISECONDS);\n    };\n\n    // listen to window resize events\n    window.addEventListener('resize', handleWindowResize);\n\n    return () => {\n      window.removeEventListener('resize', handleWindowResize);\n    };\n  }, [chartData]);\n\n  // set tab back to 0 if school is changed\n  useEffect(() => {\n    setPreviousTab(currentTab);\n    setCurrentTab(0);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentSchoolID]);\n\n  let chartHeight, chartMaxHeight;\n  if (chartData?.chartType !== 'Calendar') {\n    chartHeight = isPortrait ? '80vw' : '35vw';\n    chartMaxHeight = isPortrait ? '800px' : '450px';\n  }\n\n  // Function to render only one chart (no subchart --> no tab control)\n  const renderOnlyOneChart = () => {\n    if (!isValidArray(chartData.dataArray)) {\n      return <NoChartToRender customMessage={\"Not enough historical data to display this chart\"} />\n    }\n    return (\n      <SubChart\n        selectedDataType={selectedDataType}\n        allowedDataTypes={allowedDataTypes}\n        chartData={chartData}\n        isPortrait={isPortrait}\n        windowSize={windowSize}\n        height={chartData.height ? chartData.height : chartHeight}\n      />\n    );\n  }\n\n  // Function to render multiple subcharts with tab control\n  const renderMultipleSubcharts = () => {\n    // Handle tab change\n    const handleTabChange = (__, newIndex) => {\n      setPreviousTab(currentTab);\n      setCurrentTab(newIndex);\n\n      if (needsDropdownMenu && newIndex < MAX_NUM_TABS_TO_DISPLAY && newIndex !== dropdownMenuTabIndex) {\n        setDropdownMenuCurrentTitle();\n        setDropdownMenuTabIndex(INITIAL_DROPDOWN_MENU_TAB_INDEX);\n      }\n    };\n\n    // Determine if dropdown menu is needed\n    const needsDropdownMenu = chartData.subcharts.length > MAX_NUM_TABS_TO_DISPLAY + 1; // maxTabsToDisplay = 3 by default, but here +1 for some leeway, some schools have 4 sensors which is still okay. But if > 4, then only display max 3\n\n    const subchartsDataForTabs = needsDropdownMenu ? chartData.subcharts.slice(0, MAX_NUM_TABS_TO_DISPLAY) : chartData.subcharts;\n    const subchartsDataForDropDownMenu = needsDropdownMenu ? chartData.subcharts.slice(MAX_NUM_TABS_TO_DISPLAY) : null;\n\n    // Function to handle selection from dropdown menu\n    const handleDropdownMenuSelection = (index) => {\n      setPreviousTab(currentTab);\n\n      // Because the original chartData.subcharts array was split in subchartsDataForTabs (length maxTabsToDisplay) and subchartsDataForDropDownMenu (the remaining item), the selected subcharts index is the sum of the length of subchartsDataForTabs array and the index of the selected item from subchartsDataForDropDownMenu\n      setCurrentTab(MAX_NUM_TABS_TO_DISPLAY + index);\n\n      // Same index with the one above to keep the dropdown menu tab highlighted  \n      setDropdownMenuTabIndex(MAX_NUM_TABS_TO_DISPLAY + index);\n\n      // Set title of the selected item in the dropdown menu to display it\n      setDropdownMenuCurrentTitle(subchartsDataForDropDownMenu[index].subchartTitleShort);\n\n      // Close the dropdown menu after selection\n      setAnchorEl(null);\n    };\n\n    const getOtherLocationsLabel = () => {\n      return (\n        <Stack direction=\"row\" justifyContent=\"center\" alignItems=\"center\">\n          <Box flex={1}>\n            Other sensors\n            {\n              dropdownMenuCurrentTitle && ` (${dropdownMenuCurrentTitle})`\n            }\n            &nbsp;\n          </Box>\n          < ExpandMoreIcon />\n        </Stack>\n      )\n    }\n\n    const shouldDisplayThisSubchart = (index) => {\n      if (currentTab === INITIAL_DROPDOWN_MENU_TAB_INDEX) {\n        return previousTab === index;\n      } else {\n        return currentTab === index;\n      }\n    }\n\n    return (\n      <>\n        <StyledTabs\n          value={currentTab}\n          onChange={handleTabChange}\n          variant={isSmallWidth ? 'fullWidth' : 'standard'}\n        >\n          {subchartsDataForTabs.map((_, index) => (\n            <Tab\n              key={index}\n              value={index}\n              label={chartData.subcharts[index].subchartTitle}\n              sx={{\n                // If this subchart doesn't have a valid dataArray to render chart\n                // Make the Tab's text line-through to let user know\n                textDecoration: !isValidArray(chartData.subcharts[index].dataArray) && 'line-through'\n              }}\n            />\n          ))}\n          {/* Render dropdown menu if needed */}\n          {needsDropdownMenu && (\n            <Tab\n              value={dropdownMenuTabIndex}\n              label={getOtherLocationsLabel()}\n              aria-controls=\"submenu\"\n              aria-haspopup=\"true\"\n              onClick={(event) => setAnchorEl(event.currentTarget)}\n            />\n          )}\n        </StyledTabs>\n        {\n          needsDropdownMenu && <Menu\n            id=\"submenu\"\n            anchorEl={anchorEl}\n            open={Boolean(anchorEl)}\n            onClose={() => {\n              // Reset currentTab to the previous valid tab if the user opened the menu (clicked on the drop down menu tab, if shown), but didn't select any menu item\n              if (currentTab === INITIAL_DROPDOWN_MENU_TAB_INDEX) {\n                setPreviousTab(currentTab);\n                setCurrentTab(previousTab);\n              };\n\n              // Close the menu\n              setAnchorEl(null);\n            }}\n          >\n            {/* Render remaining subchart selector in the dropdown menu */}\n            {subchartsDataForDropDownMenu.map((_, index) => (\n              <StyledMenuItem\n                key={index}\n                selected={index === currentTab - MAX_NUM_TABS_TO_DISPLAY}\n                onClick={() => handleDropdownMenuSelection(index)}\n                sx={{\n                  // If this subchart doesn't have a valid dataArray to render chart\n                  // Make the Tab's text line-through to let user know\n                  textDecoration: !isValidArray(chartData.subcharts[index + MAX_NUM_TABS_TO_DISPLAY].dataArray) && 'line-through'\n                }}\n              >\n                <Stack direction=\"row\" alignItems=\"center\" gap={1}>\n                  <Box>\n                    {subchartsDataForDropDownMenu[index].subchartTitle}\n                  </Box>\n                  {\n                    (index === currentTab - MAX_NUM_TABS_TO_DISPLAY) &&\n                    <VisibilityIcon fontSize=\"1rem\" sx={{ color: 'text.secondary' }} />\n                  }\n                </Stack>\n              </StyledMenuItem>\n            ))}\n          </Menu>\n        }\n\n        <Box\n          position=\"relative\"\n          sx={{\n            overflowX: isPortrait && 'auto',\n            WebkitOverflowScrolling: isPortrait && 'touch',\n            overflowY: 'hidden',\n          }}\n        >\n\n          {chartData.subcharts.map((__, index) => (\n            <Box\n              key={index}\n              width=\"100%\"\n              height=\"100%\"\n              role=\"tabpanel\"\n              sx={{\n                transition: '0.35s',\n                position: (index === 0) ? '' : 'absolute',\n                opacity: shouldDisplayThisSubchart(index) ? '1' : '0',\n                pointerEvents: shouldDisplayThisSubchart(index) ? 'auto' : 'none',\n                top: (index === 0) ? '' : 0,\n                overflowX: 'auto',\n                overflowY: 'hidden',\n              }}\n            >\n              <SubChart\n                selectedDataType={selectedDataType}\n                allowedDataTypes={allowedDataTypes}\n                chartData={chartData}\n                subchartIndex={index}\n                isPortrait={isPortrait}\n                windowSize={windowSize}\n                height={chartData.height ? chartData.height : chartHeight}\n                maxHeight={\n                  ['Calendar'].includes(chartData.chartType)\n                    ? ''\n                    : chartMaxHeight\n                }\n                currentSubchart={currentTab}\n              />\n            </Box>\n          ))}\n        </Box>\n      </>\n    )\n  };\n\n  // Function to render remaining subtitles and references for chart with multiple subcharts\n  const getSubtitles = () => {\n    let text = chartData.subtitle || '';\n    if (chartData.subcharts && chartData.subcharts[currentTab]?.subchartSubtitle) {\n      text += '<br/>';\n      text += chartData.subcharts[currentTab].subchartSubtitle;\n    }\n    return text;\n  }\n  const getReferences = () => {\n    let text = chartData.reference || '';\n    if (chartData.subcharts && chartData.subcharts[currentTab]?.reference) {\n      text += '<br/>';\n      text += chartData.subcharts[currentTab].reference;\n    }\n    return text;\n  }\n\n  if (!chartData) return;\n\n  if (isLoading) return <LoadingAnimation optionalText={`Loading chart ${chartID + 1}...`} />;\n  if (error) return <NoChartToRender customMessage={`Error loading chart ${chartID + 1}, please try later`} />\n\n  return (\n    <Box\n      position=\"relative\"\n    >\n      <Box>\n        <Typography display=\"inline\" variant=\"h6\" color=\"text.primary\">\n          {chartID + 1}. {chartData.title}\n          &nbsp;\n        </Typography>\n        <Box display=\"inline\">\n          <DataTypeDropDownMenu\n            selectedDataType={selectedDataType}\n            dataTypes={allowedDataTypes}\n            chartID={chartID}\n          />\n        </Box>\n      </Box>\n\n      <ChartStyleWrapper height=\"100%\" sx={{\n        filter: isFetching ? 'blur(1px)' : 'none',\n        transition: 'filter 0.2s',\n        pointerEvents: isFetching ? \"none\" : \"auto\",\n      }}>\n        {isValidArray(chartData.subcharts) ? renderMultipleSubcharts() : renderOnlyOneChart()}\n\n        {/* Render subtitle and reference below */}\n        <Box sx={{ my: 3 }}>\n          <Typography\n            component=\"div\"\n            variant=\"body1\"\n            color=\"text.secondary\"\n            sx={{ mb: 1 }}\n          >\n            <CollapsibleSubtitle\n              text={getSubtitles()}\n              reference={getReferences()}\n            />\n          </Typography>\n        </Box>\n      </ChartStyleWrapper>\n\n      {isFetching && (\n        <Box\n          sx={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            backgroundColor: 'rgba(255,255,255,0.3)',\n            zIndex: 10,\n          }}\n        >\n          <LoadingAnimation />\n        </Box>\n      )}\n    </Box>\n  );\n}\n\nexport default ChartComponentWrapper;\n","import { useState } from 'react';\nimport { isMobile } from 'react-device-detect';\n\nimport { Fab, Fade, Popper, Paper, Typography, Stack } from '@mui/material';\nimport AirIcon from '@mui/icons-material/Air';\nimport { FadeInButtonForSpeedDial } from '../SpeedDial/FadeInButtonForSpeedDial';\n\nimport * as Tracking from '../../Utils/Tracking';\nimport AirQualityIndexTable from './AirQualityIndexTable';\n\nexport default function AirQualityIndexLegendQuickGlance(props) {\n  // Mechanism for opening and closing the Quick Glance on hover\n  const [anchorEl, setAnchorEl] = useState(null);\n  const handlePopperOpen = (event) => {\n    setAnchorEl(event.currentTarget);\n    Tracking.sendEventAnalytics(Tracking.Events.airQualityIndexLegendQuickGlance);\n  };\n  const handlePopperClose = () => {\n    setAnchorEl(null);\n  };\n  const open = Boolean(anchorEl);\n\n  return (\n    <>\n      <FadeInButtonForSpeedDial {...props} distanceFromBottomOfWindow=\"5.5rem\">\n        <Fab\n          sx={{ mt: 1 }}\n          aria-owns={open ? Tracking.Events.airQualityIndexLegendQuickGlance : undefined}\n          aria-haspopup=\"true\"\n          onMouseEnter={handlePopperOpen}\n          onMouseLeave={handlePopperClose}\n          onClick={(event) => isMobile && (open ? handlePopperClose() : handlePopperOpen(event))}\n          aria-label={Tracking.Events.airQualityIndexLegendQuickGlance}\n          color=\"primary\"\n        >\n          <Stack direction=\"column\" alignItems=\"center\">\n            <AirIcon fontSize=\"1rem\" />\n            <Typography variant=\"body2\" fontWeight=\"500\">\n              AQI\n            </Typography>\n          </Stack>\n        </Fab>\n      </FadeInButtonForSpeedDial>\n\n      <Popper\n        id={Tracking.Events.airQualityIndexLegendQuickGlance}\n        sx={{\n          pointerEvents: 'none',\n          mt: -1\n        }}\n        open={open}\n        anchorEl={anchorEl}\n        placement=\"top-end\"\n        onClose={handlePopperClose}\n        keepMounted\n        transition\n      >\n        {({ TransitionProps }) => (\n          <Fade {...TransitionProps} timeout={350}>\n            <Paper elevation={8} sx={{ py: 0.5, mb: 1 }}>\n              <Typography sx={{ mx: 2, mt: 1 }} color=\"text.disabled\" variant=\"body1\" fontWeight={500}>\n                AQI at quick glance\n              </Typography>\n              <AirQualityIndexTable tiny hideAQIDescription />\n            </Paper>\n          </Fade>\n        )}\n\n      </Popper>\n    </>\n  );\n}\n","import { useState, useContext } from \"react\";\nimport { Button, Menu, MenuItem } from \"@mui/material\";\nimport TvIcon from \"@mui/icons-material/Tv\";\nimport { useNavigate } from \"react-router-dom\";\nimport { DashboardContext } from \"../../../ContextProviders/DashboardContext\";\nimport { isValidArray } from \"../../../Utils/UtilFunctions\";\nimport useSchoolMetadata from \"../../../hooks/useSchoolMetadata\";\n\n// Use this code block if TV screen should be only for logged in users even for publicly available institutions\n// import useLoginHandler from \"../../Account/useLoginHandler\";\n\nconst ScreenDropDownMenu = () => {\n  // Use this code block if TV screen should be only for logged in users even for publicly available institutions\n  // const ScreenDropDownMenu = ({ onButtonClick }) => {\n  const { currentSchoolID } = useContext(DashboardContext);\n  const { data: schoolMetadata } = useSchoolMetadata();\n\n  // Use this code block if TV screen should be only for logged in users even for publicly available institutions\n  // const { handleRestrictedAccess } = useLoginHandler(onButtonClick);\n\n  const [anchorEl, setAnchorEl] = useState(null);\n  const navigate = useNavigate();\n\n  if (!schoolMetadata) return null;\n\n  const screens = schoolMetadata.screens;\n\n  if (!isValidArray(screens)) return null;\n\n  const handleSingleScreenClick = () => {\n    const screen_name = screens && screens[0]?.screen_name;\n    if (screen_name === \"screen\") navigate(`/screen/${currentSchoolID}`);\n    else navigate(`/screen/${currentSchoolID}/${screen_name}`);\n\n    // Use this code block if TV screen should be only for logged in users even for publicly available institutions\n    // handleRestrictedAccess(() => {\n    //   const screen_name = screens && screens[0]?.screen_name;\n    //   if (screen_name === \"screen\") navigate(`/screen/${currentSchoolID}`);\n    //   else navigate(`/screen/${currentSchoolID}/${screen_name}`);\n    // });\n  };\n\n  // If there is only 1 screen, show a single button\n  if (screens.length <= 1) {\n    return (\n      <Button\n        variant=\"contained\"\n        size=\"small\"\n        onClick={handleSingleScreenClick}\n      >\n        <TvIcon sx={{ fontSize: \"1rem\" }} />&nbsp;TV Screen\n      </Button>\n    );\n  }\n\n  // If there are multiple screens, show a dropdown menu\n  const open = Boolean(anchorEl);\n\n  const handleMenuItemClick = (screenName) => {\n    navigate(`/screen/${currentSchoolID}/${screenName}`);\n\n    // Use this code block if TV screen should be only for logged in users even for publicly available institutions\n    // handleRestrictedAccess(() => {\n    //   setAnchorEl(null);\n    //   navigate(`/screen/${currentSchoolID}/${screenName}`);\n    // });\n  };\n\n  const handleMenuOpen = (event) => {\n    setAnchorEl(event.currentTarget);\n\n    // Use this code block if TV screen should be only for logged in users even for publicly available institutions\n    // handleRestrictedAccess(() => setAnchorEl(event.currentTarget));\n  };\n\n  const handleMenuClose = () => {\n    setAnchorEl(null);\n  };\n\n  return (\n    <>\n      <Button\n        id=\"basic-button\"\n        aria-controls={open ? \"tv-screen-list-menu\" : undefined}\n        aria-haspopup=\"true\"\n        aria-expanded={open ? \"true\" : undefined}\n        onClick={handleMenuOpen}\n        variant=\"contained\"\n        size=\"small\"\n      >\n        <TvIcon sx={{ fontSize: \"1rem\" }} />\n        &nbsp;\n        TV Screens\n      </Button>\n      <Menu\n        id=\"tv-screen-list-menu\"\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleMenuClose}\n        MenuListProps={{\n          \"aria-labelledby\": \"basic-button\",\n        }}\n      >\n        {screens.map((screen, index) => (\n          <MenuItem\n            key={index}\n            onClick={() => handleMenuItemClick(screen.screen_name)}\n            sx={{ fontSize: \"0.8rem\" }}\n          >\n            {screen.location_long}\n          </MenuItem>\n        ))}\n      </Menu>\n    </>\n  );\n};\n\nexport default ScreenDropDownMenu;\n","import { useState, useContext } from 'react';\nimport { Chip, Tooltip, IconButton, Dialog, Button, DialogActions, DialogTitle, DialogContent, useMediaQuery } from '@mui/material';\nimport * as Tracking from '../../Utils/Tracking';\nimport ChevronLeftIcon from '@mui/icons-material/ChevronLeft';\nimport { DashboardContext } from '../../ContextProviders/DashboardContext';\nimport { useTheme } from '@mui/material';\n\nconst CustomDialog = (props) => {\n  const {\n    buttonIcon,\n    buttonIconAria,\n    buttonLabel,\n    buttonVariant = 'contained',\n    trackingEvent,\n    dialogTitle,\n    dialogOpenHandler = null,\n    dialogCloseHandler = null,\n    displaySchoolID = true,\n    maxWidth = \"lg\",\n    children,\n    disabled\n  } = props;\n\n  let iconOnly;\n  if (buttonIcon && !buttonLabel) iconOnly = true;\n  else iconOnly = false;\n\n  const { currentSchoolID } = useContext(DashboardContext);\n\n  const smallScreen = useMediaQuery((theme) => theme.breakpoints.down('sm'));\n\n  const [open, setOpen] = useState(false);\n\n  const onOpen = () => {\n    if (dialogOpenHandler) {\n      dialogOpenHandler(() => {\n        setOpen(true); // Only opens if dialogOpenHandler allows it\n        if (trackingEvent) Tracking.sendEventAnalytics(trackingEvent);\n      });\n    } else {\n      setOpen(true);\n      if (trackingEvent) Tracking.sendEventAnalytics(trackingEvent);\n    }\n  };\n\n  const onClose = () => {\n    setOpen(false);\n    if (dialogCloseHandler) dialogCloseHandler();\n  };\n\n  const theme = useTheme();\n\n  const displayButton = () => {\n    if (iconOnly) return (\n      <Tooltip title={buttonIconAria}>\n        <IconButton\n          onClick={onOpen}\n          aria-label={buttonIconAria}\n          size=\"small\"\n          sx={{ \"&:hover,:focus\": { color: theme.palette.primary.main } }}\n          disabled={disabled}\n        >\n          {buttonIcon}\n        </IconButton>\n      </Tooltip>\n    );\n\n    else return (\n      <Button\n        onClick={onOpen}\n        variant={buttonVariant}\n        disabled={disabled}\n        size=\"small\"\n      >\n        {buttonIcon}&nbsp;{buttonLabel}\n      </Button>\n    )\n  }\n\n  return (\n    <>\n      {displayButton()}\n\n      <Dialog\n        open={open}\n        onClose={onClose}\n        maxWidth={maxWidth}\n        fullWidth\n        fullScreen={smallScreen}\n        keepMounted\n      >\n        <DialogActions sx={{ justifyContent: \"start\" }}>\n          <Button onClick={onClose}>\n            <ChevronLeftIcon sx={{ fontSize: '1rem' }} />Back\n          </Button>\n        </DialogActions>\n\n        <DialogTitle>\n          {displaySchoolID === true ?\n            (<>\n              <Chip\n                label={currentSchoolID ? `School: ${currentSchoolID.toUpperCase()}` : \"No School\"}\n                size=\"small\"\n                display=\"block\"\n                sx={{ mb: 1 }}\n              />\n              <br />\n            </>\n            ) : null}\n\n          {dialogTitle}\n        </DialogTitle>\n\n        <DialogContent>\n          {children}\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n\nexport default CustomDialog;\n","import { useContext, useCallback } from \"react\";\nimport { UserContext } from \"../../ContextProviders/UserContext\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\nimport { useSnackbar } from \"notistack\";\nimport { SnackbarMetadata } from \"../../Utils/SnackbarMetadata\";\n\nconst useLoginHandler = (openLoginPopup) => {\n    const { authenticationState, user } = useContext(UserContext);\n    const loggedIn = authenticationState.authenticated && authenticationState.checkedAuthentication;\n    const { currentSchoolID } = useContext(DashboardContext);\n    const { enqueueSnackbar } = useSnackbar()\n\n    const handleRestrictedAccess = useCallback(\n        (action) => {\n            if (!loggedIn) {\n                openLoginPopup?.();\n                return false;\n            } else {\n                if (user?.allowedSchools.some(school => school.school_id === currentSchoolID)) {\n                    action?.();\n                    return true;\n                } else {\n                    enqueueSnackbar(`Your account does not have access to ${currentSchoolID.toUpperCase()} Alerts`, SnackbarMetadata.error);\n                    return false;\n                }\n            }\n        },\n        [loggedIn, openLoginPopup, currentSchoolID, user, enqueueSnackbar]\n    );\n\n    return {\n        loggedIn,\n        handleRestrictedAccess,\n    };\n};\n\nexport default useLoginHandler;\n","import { useQuery } from '@tanstack/react-query';\nimport { fetchDataFromURL } from '../API/ApiFetch';\nimport { useContext } from 'react';\nimport { DashboardContext } from '../ContextProviders/DashboardContext';\nimport { getApiUrl } from '../API/ApiUrls';\nimport { GeneralAPIendpoints, SupportedFetchExtensions } from '../API/Utils';\n\nconst useDatasetDownload = ({ sensor, aggregationType, isSample, enabled = true }) => {\n    const { currentSchoolID } = useContext(DashboardContext);\n\n    return useQuery({\n        queryKey: [GeneralAPIendpoints.raw, currentSchoolID, sensor, aggregationType, isSample],\n        queryFn: async () => {\n            const url = getApiUrl({\n                paths: [GeneralAPIendpoints.raw, currentSchoolID, sensor],\n                queryParams: {\n                    aggregationType,\n                    isSample\n                }\n            });\n            return fetchDataFromURL({ url, extension: SupportedFetchExtensions.csv });\n        },\n        enabled: !!currentSchoolID && !!sensor && !!enabled,\n        staleTime: 1000 * 60 * 5,\n        retry: false\n    });\n};\n\nexport default useDatasetDownload;","import { useState, useEffect, useContext } from 'react';\nimport { Box, Link, Typography, Stack, Select, FormControl, MenuItem, Grid, Button, useMediaQuery, Table, TableBody, TableCell, TableHead, TableRow } from '@mui/material';\nimport { useTheme } from '@mui/material/styles';\nimport DownloadIcon from '@mui/icons-material/Download';\nimport DataObjectIcon from '@mui/icons-material/DataObject';\nimport * as Tracking from '../../Utils/Tracking';\nimport LoadingAnimation from '../LoadingAnimation';\nimport { DashboardContext } from '../../ContextProviders/DashboardContext';\nimport CustomDialog from '../CustomDialog/CustomDialog';\nimport { CITIESair } from '../../Utils/GlobalVariables';\nimport useLoginHandler from '../Account/useLoginHandler';\nimport AggregationType from '../DateRangePicker/AggregationType';\nimport useCurrentSensorsData from '../../hooks/useCurrentSensorsData';\nimport useDatasetDownload from '../../hooks/useDatasetDownload';\nimport { enqueueSnackbar } from 'notistack';\nimport { SnackbarMetadata } from '../../Utils/SnackbarMetadata';\n\nexport default function DatasetDownloadDialog({ onButtonClick }) {\n  const { handleRestrictedAccess } = useLoginHandler(onButtonClick);\n\n  const { data: currentSensorsData } = useCurrentSensorsData();\n\n  const [sensorsList, setSensorsList] = useState({});\n  const [previewingDataset, setPreviewingDataset] = useState();\n\n  // Construct the structure of sensorsList based on current data\n  useEffect(() => {\n    if (!currentSensorsData) return;\n\n    const sensorsList = currentSensorsData\n      .filter(item => item && item.sensor)  // Filter out null or undefined items and sensors\n      .reduce((acc, item) => {\n        acc[item.sensor.location_short] = {\n          location_short: item.sensor.location_short,\n          location_long: item.sensor.location_long\n        };\n        return acc;\n      }, {});\n\n    setSensorsList(sensorsList);\n\n    // Preview the hourly type of the first sensor initially\n    if (Object.keys(sensorsList).length > 0 && !previewingDataset) {\n      setPreviewingDataset({\n        sensor: Object.keys(sensorsList)[0],\n        aggregationType: AggregationType.hour\n      });\n    }\n  }, [currentSensorsData, previewingDataset]);\n\n  const theme = useTheme();\n  const smallScreen = useMediaQuery(theme.breakpoints.down('sm'));\n\n  return (\n    <CustomDialog\n      buttonIcon={<DataObjectIcon sx={{ fontSize: '1rem' }} />}\n      buttonLabel=\"Dataset\"\n      trackingEvent={Tracking.Events.rawDatasetButtonClicked}\n      dialogTitle=\"Preview and download raw dataset(s)\"\n      dialogOpenHandler={((action) => {\n        setPreviewingDataset(null);\n        handleRestrictedAccess(action);\n      })}\n    >\n      <Grid\n        container\n        justifyContent=\"center\"\n        alignItems=\"start\"\n        spacing={smallScreen ? 1 : 2}\n        sx={{ mt: 0, overflowY: 'scroll', overflowX: 'hidden' }}\n      >\n        {/* Dataset selection table */}\n        <Grid item sm={12} md={6}>\n          <Table\n            size=\"small\"\n            sx={{\n              tableLayout: 'fixed'\n            }}\n          >\n            <TableHead>\n              <TableRow>\n                <TableCell sx={{ pl: 1 }}>\n                  Sensor Location\n                </TableCell>\n                <TableCell sx={{ width: smallScreen ? '9.5rem' : '11rem' }}>\n                  Average Period\n                </TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {sensorsList && Object.keys(sensorsList).map((location_short) => (\n                <Dataset\n                  key={location_short}\n                  sensor={location_short}\n                  sensorsList={sensorsList}\n                  previewingDataset={previewingDataset}\n                  setPreviewingDataset={setPreviewingDataset}\n                  isPreviewing={location_short === previewingDataset?.sensor}\n                  setSensorsList={setSensorsList}\n                />\n              ))}\n            </TableBody>\n          </Table>\n        </Grid>\n\n        {/* Dataset previewing panel */}\n        <Grid item sm={12} md={6} maxWidth={smallScreen ? '100%' : 'unset'} sx={{ mt: 1 }}>\n          <PreviewDataset\n            sensorsList={sensorsList}\n            setSensorsList={setSensorsList}\n            previewingDataset={previewingDataset}\n          />\n        </Grid>\n      </Grid>\n\n      {/* Ack */}\n      <Typography variant=\"caption\" sx={{ my: 2, fontStyle: 'italic', display: \"block\" }} >\n        Raw datasets are provided by {CITIESair} from sensors operated by {CITIESair}. Should you intend to utilize them for your project, research, or publication, we kindly request that you notify us at <Link href='mailto:nyuad.cities@nyu.edu'>nyuad.cities@nyu.edu</Link> to discuss citation requirements.\n      </Typography>\n    </CustomDialog>\n  );\n}\n\nconst Dataset = (props) => {\n  const { sensorsList, sensor, previewingDataset, setPreviewingDataset, isPreviewing } = props;\n  const [aggregationType, setAggregationType] = useState(AggregationType.hour);\n  const { currentSchoolID } = useContext(DashboardContext);\n  const theme = useTheme();\n\n  useEffect(() => {\n    if (aggregationType !== AggregationType.hour) setAggregationType(AggregationType.hour);\n  }, [currentSchoolID]);\n\n  const handleDatasetTypeChange = (event) => {\n    const selectedVal = event.target.value;\n    setAggregationType(selectedVal);\n    setPreviewingDataset({ aggregationType: selectedVal, sensor });\n  };\n\n  const setThisSensorToPreview = () => {\n    if (previewingDataset?.sensor !== sensor) {\n      setPreviewingDataset({\n        aggregationType: aggregationType,\n        sensor\n      });\n    }\n  }\n\n  return (\n    <>\n      <TableRow key={sensor}>\n        <TableCell\n          sx={{\n            pl: 1,\n            cursor: 'pointer',\n            background: isPreviewing && theme.palette.background.NYUpurpleLight\n          }}\n          onClick={setThisSensorToPreview}>\n          {sensorsList[sensor].location_long}\n        </TableCell>\n\n        <TableCell\n          sx={{\n            position: 'relative',\n            background: isPreviewing && theme.palette.background.NYUpurpleLight\n          }}>\n          <FormControl size=\"small\">\n            <Select\n              value={aggregationType}\n              onChange={handleDatasetTypeChange}\n              variant=\"standard\"\n              MenuProps={{ disablePortal: true }}\n            >\n              {Object.keys(AggregationType).map((aggregationType, index) => (\n                <MenuItem\n                  key={index}\n                  value={aggregationType}\n                >\n                  <Stack direction=\"row\" alignItems=\"center\">\n                    {aggregationType.charAt(0).toUpperCase() + aggregationType.slice(1).toLowerCase()}\n                  </Stack>\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n        </TableCell>\n      </TableRow >\n    </>\n  )\n}\n\nconst PreviewDataset = ({ previewingDataset }) => {\n  const { data: previewData, isLoading: isPreviewDataLoading } = useDatasetDownload({\n    sensor: previewingDataset?.sensor,\n    aggregationType: previewingDataset?.aggregationType,\n    isSample: true\n  });\n\n  const { refetch: refetchFullData } = useDatasetDownload({\n    sensor: previewingDataset?.sensor,\n    aggregationType: previewingDataset?.aggregationType,\n    isSample: false,\n    enabled: false,\n  });\n\n  const theme = useTheme();\n  const smallScreen = useMediaQuery(theme.breakpoints.down('sm'));\n\n  const [previewingDatasetName, setPreviewingDatasetName] = useState(\"Not previewing any dataset\");\n  const [csvFileName, setCsvFileName] = useState(\"No dataset\");\n\n  const [formattedData, setFormattedData] = useState('');\n  const [rowNumber, setRowNumber] = useState('');\n\n  useEffect(() => {\n    // If no dataset is chosen to be previewed, early return\n    if (!previewData || !previewingDataset) return;\n\n    // Update previewing dataset name regardless if the dataset preview has finished loading\n    setPreviewingDatasetName(`Previewing: ${previewingDataset.sensor} (${previewingDataset.aggregationType})`);\n\n    // If no previewData, then it hasn't been loaded yet\n    if (!previewData || isPreviewDataLoading) {\n      setRowNumber(null);\n      setFormattedData(null);\n      setCsvFileName(\"Loading...\");\n      return;\n    };\n\n    const lines = previewData.split('\\n');\n    const headers = lines[0].split(',');\n    const rows = lines.slice(1);\n    setRowNumber([\n      \"\",\n      ...rows.map(row => row.split(',')[0])\n    ].join('\\n'));\n    setFormattedData([\n      headers.slice(1).join(','), // Keep the headers for the rest of the columns\n      ...rows.map(row => row.split(',').slice(1).join(',')) // Remove the first column from each row\n    ].join('\\n'));\n\n    // Get the second column of the last row and extract the date part to set the csv's file name\n    let dateString;\n    if (rows.length > 0) {\n      const lastRow = rows[rows.length - 1];\n      const columns = lastRow.split(',');\n      if (columns.length >= 2) {\n        const dateTimeString = columns[1]; // Get the second column\n        dateString = dateTimeString.split('T')[0]; // Extract the date part\n      }\n    }\n\n    const csvFileName = `${previewingDataset.sensor}-${previewingDataset.aggregationType}-${dateString}.csv`;\n    setCsvFileName(csvFileName);\n  }, [previewData]);\n\n  const handleDownload = async () => {\n    try {\n      const { data } = await refetchFullData(); // runs queryFn manually\n\n      const blob = new Blob([data], { type: 'application/octet-stream' }); // create a Blob with the raw data\n      const url = URL.createObjectURL(blob); // create a download link for the Blob\n      const downloadLink = document.createElement('a');\n      downloadLink.href = url;\n      downloadLink.download = csvFileName;\n      document.body.appendChild(downloadLink);\n      downloadLink.click(); // simulate a click on the download link\n      URL.revokeObjectURL(url); // clean up by revoking the object URL\n      document.body.removeChild(downloadLink);\n\n      Tracking.sendEventAnalytics(Tracking.Events.rawDatasetDownloaded, {\n        dataset_type: previewingDataset?.aggregationType,\n        sensor: previewingDataset?.sensor\n      });\n    } catch (err) {\n      enqueueSnackbar(\"Error fetching the full dataset\", SnackbarMetadata.error);\n    }\n  };\n\n  return (\n    <Stack spacing={1}>\n      <Box sx={{ '& *': { fontFamily: \"monospace !important\" } }}>\n        <Stack direction=\"row\">\n          <Typography variant='body2' gutterBottom fontWeight={500}>\n            {previewingDatasetName}\n          </Typography>\n        </Stack>\n\n        <Box\n          component=\"pre\"\n          sx={{\n            overflowX: 'auto',\n            color: theme.palette.text.secondary,\n            backgroundColor: theme.palette.customBackground,\n            p: 2,\n            pt: 1.5,\n            borderRadius: 1,\n            height: smallScreen ? '11.8rem' : '14rem',\n            width: smallScreen ? '100%' : 'unset',\n            marginTop: 0\n          }}\n        >\n          <Stack\n            direction=\"row\"\n            sx={{ fontSize: '0.75rem' }}\n          >\n            {\n              formattedData ?\n                <>\n                  <Box sx={{ mr: 2, userSelect: 'none' }}>\n                    {rowNumber}\n                  </Box>\n                  <Box>\n                    {formattedData}\n                  </Box>\n                </>\n                :\n                <LoadingAnimation optionalText=\"Loading\" />\n            }\n          </Stack>\n        </Box>\n      </Box>\n      <Box textAlign=\"center\" >\n        <Button\n          variant=\"contained\"\n          sx={{\n            textTransform: 'none',\n            textAlign: 'left',\n            lineHeight: 1.1,\n            px: 1.5,\n            py: 1\n          }}\n          onClick={handleDownload}\n          disabled={isPreviewDataLoading}\n        >\n          <DownloadIcon sx={{ fontSize: '1.25rem', mr: 0.5 }} />\n          {csvFileName}\n        </Button>\n      </Box>\n    </Stack >\n  )\n}","import { useContext, useEffect, useRef, useState } from 'react';\nimport { Box, TextField, Chip, Menu, MenuItem, Grid, Typography, Button, Stack, useMediaQuery, Alert, Tooltip, Link, CircularProgress } from '@mui/material';\nimport { fetchDataFromURL } from \"../../../API/ApiFetch\";\nimport { RESTmethods } from \"../../../API/Utils\";\nimport { getApiUrl } from '../../../API/ApiUrls';\nimport { GeneralAPIendpoints } from \"../../../API/Utils\";\nimport { DashboardContext } from '../../../ContextProviders/DashboardContext';\nimport { isValidArray } from '../../../Utils/UtilFunctions';\nimport { SnackbarMetadata } from '../../../Utils/SnackbarMetadata';\nimport { validateEmail } from '../../../Utils/UtilFunctions';\nimport { useSnackbar } from 'notistack';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nconst compareArrays = (arr1, arr2) => {\n  return JSON.stringify(arr1) === JSON.stringify(arr2);\n}\n\nconst EmailsInput = () => {\n  const { enqueueSnackbar } = useSnackbar();\n  const { currentSchoolID } = useContext(DashboardContext);\n\n  const queryPaths = [GeneralAPIendpoints.alertsEmails, currentSchoolID];\n\n  const { data: alertEmails = [] } = useQuery({\n    queryKey: queryPaths,\n    queryFn: async () => {\n      return fetchDataFromURL({\n        url: getApiUrl({\n          paths: queryPaths\n        }),\n        extension: 'json',\n        needsAuthorization: true\n      });\n    },\n    enabled: !!currentSchoolID,\n    staleTime: 0\n  });\n\n  const queryClient = useQueryClient();\n  const saveEmailsMutation = useMutation({\n    mutationFn: async (emailsToSave) => {\n      return fetchDataFromURL({\n        url: getApiUrl({\n          paths: queryPaths\n        }),\n        restMethod: RESTmethods.POST,\n        body: emailsToSave\n      });\n    },\n    onSuccess: (data) => {\n      // Update cache immediately so UI updates without refetch\n      queryClient.setQueryData([GeneralAPIendpoints.alertsEmails, currentSchoolID], data);\n      enqueueSnackbar('Email recipients saved successfully.', SnackbarMetadata.success);\n    },\n    onError: () => {\n      enqueueSnackbar('There was an error saving email recipients. Please try again.', SnackbarMetadata.error);\n    }\n  });\n\n  const smallScreen = useMediaQuery((theme) => theme.breakpoints.down('sm'));\n\n  const [localEmails, setLocalEmails] = useState([]);\n  const [emailsListChanged, setEmailsListChanged] = useState(false);\n\n  const [currentEmail, setCurrentEmail] = useState('');\n  const [menuAnchor, setMenuAnchor] = useState(null);\n\n  const [saveButtonTooltipTitle, setSaveButtonTooltipTitle] = useState('');\n\n  const maxEmails = 150;\n\n  useEffect(() => {\n    setLocalEmails(alertEmails);\n  }, [alertEmails]);\n\n  useEffect(() => {\n    setEmailsListChanged(!compareArrays(localEmails, alertEmails));\n  }, [localEmails, alertEmails]);\n\n  useEffect(() => {\n    setSaveButtonTooltipTitle(emailsListChanged ? \"Click to save new changes on server\" : \"No changes detected to save\");\n  }, [emailsListChanged]);\n\n  const handleAddEmail = (passedEmail, isBulkAdding = false) => {\n    let email = passedEmail.trim().toLowerCase();\n\n    // Strip <> if present\n    if (email.startsWith('<') && email.endsWith('>')) {\n      email = email.slice(1, -1).trim();\n    }\n\n    // Skip if email is empty\n    if (!email) return;\n\n    // If email is invalid\n    if (!validateEmail(email)) {\n      if (!isBulkAdding) enqueueSnackbar(`Invalid email address: ${email}`, SnackbarMetadata.error);\n      return;\n    }\n\n    // Skip if email already exists\n    if (localEmails.includes(email)) {\n      enqueueSnackbar(isBulkAdding ? `Some pasted email addresses already existed` : `Already existed: ${email}`, SnackbarMetadata.error);\n      return;\n    }\n\n    // Add email if max not reached\n    if (localEmails.length >= maxEmails) {\n      enqueueSnackbar('Maximum number of recipients reached', SnackbarMetadata.warning);\n      return;\n    }\n\n    setLocalEmails(prev => [...prev, email]);\n    setCurrentEmail('');\n  };\n\n  const handleDeleteEmail = (index) => {\n    const newEmails = localEmails.filter((_, i) => i !== index);\n    setLocalEmails(newEmails);\n  };\n\n  const handleEditEmail = (index) => {\n    setCurrentEmail(localEmails[index]);\n    handleDeleteEmail(index);\n  };\n\n  const handleCopyEmail = (index) => {\n    const emailToCopy = localEmails[index];\n    if (!emailToCopy) return;\n\n    navigator.clipboard.writeText(emailToCopy)\n      .then(() => {\n        enqueueSnackbar(`Copied to clipboard: ${emailToCopy}`, SnackbarMetadata.success);\n      })\n      .catch(() => {\n        enqueueSnackbar('Failed to copy email to clipboard.', SnackbarMetadata.error);\n      });\n  };\n\n  const wrapperRef = useRef(null);\n  const inputRef = useRef(null);\n  const prevInputRef = useRef('');\n  const [allSelected, setAllSelected] = useState(false);\n\n  // Document-level keyboard handler\n  useEffect(() => {\n    const handleGlobalKeyDown = (e) => {\n      if (!e?.key) return;\n\n      const key = e.key.toLowerCase();\n      const isMeta = e.metaKey || e.ctrlKey;\n      const active = document.activeElement;\n      const isInputFocused = active === inputRef.current;\n\n      // 1 Select All (Cmd/Ctrl + A)\n      if (isMeta && key === 'a') {\n        // only when input is empty\n        if (isInputFocused && currentEmail.trim() === '') {\n          e.preventDefault();\n          setAllSelected(true);\n\n          // move focus to wrapper for subsequent keys\n          if (wrapperRef.current) wrapperRef.current.focus({ preventScroll: true });\n        }\n        return;\n      }\n\n      // 2 Copy (Cmd/Ctrl + C)\n      if (isMeta && key === 'c' && allSelected) {\n        e.preventDefault();\n        if (localEmails.length === 0) {\n          enqueueSnackbar('No emails to copy.', SnackbarMetadata.warning);\n          return;\n        }\n\n        navigator.clipboard.writeText(localEmails.join(', '))\n          .then(() => enqueueSnackbar('All emails copied to clipboard.', SnackbarMetadata.success))\n          .catch(() => enqueueSnackbar('Failed to copy emails.', SnackbarMetadata.error));\n        return;\n      }\n\n      // 3 Delete all (Backspace or Delete)\n      if (allSelected && (key === 'backspace' || key === 'delete')) {\n        e.preventDefault();\n        if (localEmails.length === 0) return;\n\n        setLocalEmails([]);\n        setAllSelected(false);\n        enqueueSnackbar('All emails deleted.', SnackbarMetadata.info);\n        return;\n      }\n\n      // 4 Escape clears selection\n      if (key === 'escape' && allSelected) {\n        e.preventDefault();\n        setAllSelected(false);\n        return;\n      }\n    };\n\n    window.addEventListener('keydown', handleGlobalKeyDown);\n    return () => window.removeEventListener('keydown', handleGlobalKeyDown);\n  }, [currentEmail, allSelected, localEmails, enqueueSnackbar]);\n\n\n  // Clear selection on click outside of wrapper (or any click that isn't selecting)\n  useEffect(() => {\n    const handleDocumentClick = (e) => {\n      if (!wrapperRef.current) return;\n\n      // if click is inside wrapper, do nothing (we keep selection)\n      if (wrapperRef.current.contains(e.target)) return;\n\n      // clicking outside clears selection\n      if (allSelected) setAllSelected(false);\n    };\n\n    document.addEventListener('mousedown', handleDocumentClick);\n    return () => document.removeEventListener('mousedown', handleDocumentClick);\n  }, [allSelected]);\n\n  // Optional: clear selection when editing or adding a new email\n  useEffect(() => {\n    if (currentEmail !== '' && allSelected) {\n      setAllSelected(false);\n    }\n  }, [currentEmail, allSelected]);\n\n  const handleMenuOpen = (event, index) => {\n    setMenuAnchor({ index, element: event.currentTarget });\n  };\n\n  const handleMenuClose = () => {\n    setMenuAnchor(null);\n  };\n\n  const handlePaste = (event) => {\n    const pastedText = event.clipboardData.getData('text');\n    event.preventDefault();\n\n    const emails = pastedText\n      .split(/[\\s,;\\t]+/) // splits on comma, semicolon, any whitespace, or tab\n      .map(email => email.trim())\n      .filter(email => email !== '');\n\n    emails.forEach(email => handleAddEmail(email, emails.length > 1));\n    setCurrentEmail(''); // clear input after pasting\n  };\n\n  const handleSaveEmails = (_emails) => {\n    const emailsToSave = isValidArray(_emails) ? _emails : (isValidArray(localEmails) ? localEmails : []);\n    saveEmailsMutation.mutate(emailsToSave);\n  }\n\n  useEffect(() => {\n    const handleBeforeUnload = (event) => {\n      if (!compareArrays(localEmails, alertEmails)) {\n        event.preventDefault();\n        event.returnValue = '';\n      }\n    };\n\n    window.addEventListener('beforeunload', handleBeforeUnload);\n\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n    };\n  }, [localEmails, alertEmails]);\n\n  return (\n    <Box>\n      <Grid container alignItems=\"center\" wrap=\"wrap\">\n        <Grid item>\n          <Typography\n            variant='body1'\n            fontWeight={500}\n            sx={{ p: 0, mb: smallScreen && 1, mr: !smallScreen && 2 }}\n          >\n            Email Recipients:\n          </Typography>\n        </Grid>\n        <Grid\n          item\n          xs={12}\n          lg\n          sx={{\n            overflowY: \"scroll\",\n            maxHeight: \"300px\"\n          }}\n        >\n          <Grid\n            ref={wrapperRef}\n            id=\"emails-container\"\n            tabIndex={-1} // focusable programmatically\n            container\n            alignItems=\"center\"\n            sx={{\n              border: '1px solid rgba(0, 0, 0, 0.23)',\n              borderRadius: 2,\n              p: 0.5,\n              flexWrap: 'wrap',\n              width: '100%',\n              outline: 'none'\n            }}\n          >\n            {localEmails.map((email, index) => (\n              <Grid item key={index} sx={{ m: 0.5 }}>\n                <Chip\n                  label={email}\n                  onDelete={() => handleDeleteEmail(index)}\n                  onClick={(event) => handleMenuOpen(event, index)}\n                  onContextMenu={(event) => {\n                    event.preventDefault();\n                    handleMenuOpen(event, index)\n                  }}\n                  color={allSelected || (Boolean(menuAnchor) && menuAnchor.index === index) ? \"primary\" : \"default\"}\n                />\n              </Grid>\n            ))}\n\n            {\n              localEmails.length < maxEmails ? (\n                <Grid item xs={12} sm minWidth=\"200px\" >\n                  <TextField\n                    inputRef={inputRef}\n                    fullWidth\n                    variant=\"standard\"\n                    value={currentEmail}\n                    onChange={(e) => {\n                      const tmp = e.target.value;\n                      const native = e.nativeEvent || {};\n                      const inputType = (native.inputType || '').toString();\n                      const isComposing = !!native.isComposing || !!e.isComposing;\n\n                      setCurrentEmail(tmp);\n                      if (tmp !== '') {\n                        setSaveButtonTooltipTitle(\"Finalize currently edited email by pressing Enter/Return\");\n                      }\n\n                      if (isComposing) {\n                        prevInputRef.current = tmp;\n                        return;\n                      }\n\n                      const maybeEmail = tmp.trim();\n\n                      // Only trigger on autofill-like updates, paste, or other non-manual input\n                      const autofillLike = /insertReplacementText|insertFromPaste|insertFromDrop|insertFromAutocomplete/i.test(inputType);\n                      const jumpedIn = prevInputRef.current === '' && tmp.length > 1 && inputType !== 'insertText';\n\n                      if (validateEmail(maybeEmail) && (autofillLike || jumpedIn)) {\n                        // Let autofill finish internal update before adding\n                        setTimeout(() => handleAddEmail(tmp), 0);\n                      }\n\n                      prevInputRef.current = tmp;\n                    }}\n\n                    onKeyUp={(e) => {\n                      if (['Enter', 'Spacebar', ' '].includes(e.key)) {\n                        handleAddEmail(currentEmail);\n                      }\n                    }}\n                    onPaste={handlePaste}\n                    placeholder=\"Add recipient\"\n                    sx={{\n                      mx: 0.5\n                    }}\n                    InputProps={{\n                      disableUnderline: true,\n                      style: { textTransform: \"lowercase\" }\n                    }}\n                  />\n                </Grid>\n              ) : null\n            }\n          </Grid>\n        </Grid>\n\n      </Grid>\n\n      <Stack sx={{ mt: 1 }} spacing={1} alignItems={smallScreen ? \"stretch\" : \"end\"}>\n        <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"space-between\" gap={1}>\n          <Typography\n            variant=\"caption\"\n            display=\"block\"\n            color=\"text.secondary\"\n            textAlign=\"right\"\n          >\n            {localEmails.length} / {maxEmails} recipient{localEmails.length > 1 ? 's' : null} added\n          </Typography>\n\n          <Link\n            variant=\"caption\"\n            sx={{\n              cursor: \"pointer\"\n            }}\n            onClick={(e) => {\n              e.preventDefault();\n              setCurrentEmail('');\n              setLocalEmails([])\n            }}\n          >\n            Clear All\n          </Link>\n        </Stack>\n\n        {\n          alertEmails.length === 0 ?\n            (\n              <Alert\n                severity='error'\n                sx={{\n                  mt: 1\n                }}>\n                The alert(s) above will not be sent unless at least one email recipient is saved\n              </Alert>\n            ) : null\n        }\n\n        <Tooltip title={saveButtonTooltipTitle} enterTouchDelay={0}>\n          {/* Span is needed to display Tooltip on a disabled Button */}\n          <span>\n            <Button\n              onClick={handleSaveEmails}\n              variant=\"contained\"\n              sx={{ width: smallScreen ? \"100%\" : \"fit-content\" }}\n              disabled={!emailsListChanged || saveEmailsMutation.isPending}\n            >\n              {saveEmailsMutation.isPending ? <CircularProgress disableShrink color=\"inherit\" size=\"1.5rem\" /> : \"SAVE EMAIL LIST\"}\n            </Button>\n          </span>\n        </Tooltip>\n\n      </Stack>\n\n      <Menu\n        anchorEl={menuAnchor?.element}\n        open={Boolean(menuAnchor)}\n        onClose={handleMenuClose}\n      >\n        <MenuItem\n          onClick={() => {\n            handleEditEmail(menuAnchor.index);\n            handleMenuClose();\n          }}\n        >\n          Edit\n        </MenuItem>\n\n        <MenuItem\n          onClick={() => {\n            handleCopyEmail(menuAnchor.index);\n            handleMenuClose();\n          }}\n        >\n          Copy\n        </MenuItem>\n      </Menu>\n    </Box>\n  );\n};\n\nexport default EmailsInput;\n","import SpeedIcon from '@mui/icons-material/Speed';\nimport CalendarMonthIcon from '@mui/icons-material/CalendarMonth';\n\nconst AlertTypes = {\n  threshold: {\n    id: \"threshold\",\n    index: 0,\n    name: \"Threshold\",\n    tableColumnHeader: \"Threshold\",\n    icon: <SpeedIcon />\n  },\n  daily: {\n    id: \"daily\",\n    index: 1,\n    name: \"Daily\",\n    tableColumnHeader: \"Alert Hour\",\n    icon: <CalendarMonthIcon />\n  }\n};\n\nexport const ThresholdAlertTypes = {\n  below_threshold: {\n    id: 'below_threshold',\n    sign: \"<\",\n    name: \"below\"\n  },\n  above_threshold: {\n    id: 'above_threshold',\n    sign: \"\",\n    name: \"above\"\n  }\n}\n\nexport default AlertTypes;","import AlertTypes, { ThresholdAlertTypes } from \"./AlertTypes\";\nimport { PREDEFINED_TIMERANGES } from \"../../TimeRange/TimeRangeUtils\";\n\nexport const CrudTypes = {\n  add: 'ADD',\n  edit: 'EDIT',\n  delete: 'DELETE'\n}\n\nexport const SharedColumnHeader = {\n  location: \"Location\",\n  dataType: \"Data Type\",\n  selectedDaysOfWeek: \"Days\",\n  createdBy: \"Created By\"\n}\n\nexport const AirQualityAlertKeys = {\n  id: \"id\",\n  alert_type: \"alert_type\",\n  sensor_id: \"sensor_id\",\n  location_short: \"location_short\",\n  datatypekey: \"datatypekey\",\n  threshold_value: \"threshold_value\",\n  days_of_week: \"days_of_week\",\n  minutespastmidnight: \"minutespastmidnight\",\n  time_range: \"time_range\",\n  is_enabled: \"is_enabled\",\n  excluded_dates: \"excluded_dates\",\n  owner_role: \"owner_role\",\n  self_is_owner: \"self_is_owner\",\n  is_allowed_to_modify: \"is_allowed_to_modify\",\n  message: \"message\",\n  max_once_a_day: \"max_once_a_day\",\n  parent_alert_id: \"parent_alert_id\",\n  child_alert: \"child_alert\",\n  has_child_alert: \"has_child_alert\"\n};\n\nexport const getAlertDefaultPlaceholder = (alert_type = AlertTypes.daily.id) => {\n  let localAlertType, localOppositeAlertType;\n  if (alert_type === AlertTypes.threshold.id) {\n    localAlertType = ThresholdAlertTypes.above_threshold.id;\n    localOppositeAlertType = ThresholdAlertTypes.below_threshold.id;\n  }\n\n  return {\n    [AirQualityAlertKeys.id]: '',\n    [AirQualityAlertKeys.alert_type]: localAlertType || alert_type,\n    [AirQualityAlertKeys.sensor_id]: '',\n    [AirQualityAlertKeys.datatypekey]: '',\n    [AirQualityAlertKeys.days_of_week]: [0, 1, 2, 3, 4],\n    [AirQualityAlertKeys.time_range]: alert_type === AlertTypes.threshold.id ? [PREDEFINED_TIMERANGES.schoolHour.start, PREDEFINED_TIMERANGES.schoolHour.end] : null,\n    [AirQualityAlertKeys.threshold_value]: -1,\n    [AirQualityAlertKeys.minutespastmidnight]: '',\n    [AirQualityAlertKeys.is_enabled]: true,\n    [AirQualityAlertKeys.excluded_dates]: [],\n    [AirQualityAlertKeys.message]: '',\n    [AirQualityAlertKeys.max_once_a_day]: true,\n    [AirQualityAlertKeys.parent_alert_id]: null,\n    [AirQualityAlertKeys.has_child_alert]: false,\n    [AirQualityAlertKeys.child_alert]: alert_type === AlertTypes.threshold.id ? {\n      [AirQualityAlertKeys.alert_type]: localOppositeAlertType || alert_type,\n      [AirQualityAlertKeys.threshold_value]: -1,\n      [AirQualityAlertKeys.message]: '',\n    } : null,\n  }\n}\n\nexport const addChildToAlerts = (alertList = []) => {\n  const processed = [...alertList];\n\n  processed.forEach(alert => {\n    if (!alert) return;\n\n    const isChild = !!alert[AirQualityAlertKeys.parent_alert_id];\n\n    if (isChild) {\n      const parent = processed.find(\n        a => a[AirQualityAlertKeys.id] === alert[AirQualityAlertKeys.parent_alert_id]\n      );\n\n      if (parent) {\n        parent[AirQualityAlertKeys.has_child_alert] = true;\n        parent[AirQualityAlertKeys.child_alert] = {\n          [AirQualityAlertKeys.id]: alert[AirQualityAlertKeys.id],\n          [AirQualityAlertKeys.alert_type]: alert[AirQualityAlertKeys.alert_type],\n          [AirQualityAlertKeys.threshold_value]: alert[AirQualityAlertKeys.threshold_value],\n          [AirQualityAlertKeys.message]: alert[AirQualityAlertKeys.message],\n        };\n      }\n    } else {\n      if (alert[AirQualityAlertKeys.alert_type] === AlertTypes.daily.id) return;\n\n      alert[AirQualityAlertKeys.has_child_alert] = false;\n      alert[AirQualityAlertKeys.child_alert] = {\n        [AirQualityAlertKeys.alert_type]:\n          alert[AirQualityAlertKeys.alert_type] === ThresholdAlertTypes.above_threshold.id\n            ? ThresholdAlertTypes.below_threshold.id\n            : ThresholdAlertTypes.above_threshold.id,\n        [AirQualityAlertKeys.threshold_value]: alert[AirQualityAlertKeys.threshold_value],\n        [AirQualityAlertKeys.message]: \"\"\n      };\n    }\n  });\n\n  return processed;\n};","import { useState } from 'react';\nimport { Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, useTheme } from '@mui/material';\n\nexport default function AlertDeletionDialog(props) {\n  const { onConfirmedDelete } = props;\n\n  const [open, setOpen] = useState(false);\n  const theme = useTheme();\n\n  return (\n    <>\n      <Button\n        variant=\"text\"\n        color=\"error\"\n        onClick={() => {\n          setOpen(true)\n        }}>\n        Delete\n      </Button>\n      <Dialog\n        open={open}\n        onClose={() => {\n          setOpen(false)\n        }}\n        aria-labelledby=\"alert-deletion-confirmation-dialog-title\"\n        aria-describedby=\"alert-deletion-confirmation-dialog-description\"\n        maxWidth=\"xs\"\n      >\n        <DialogTitle id=\"alert-deletion-confirmation-dialog-title\">\n          Are you sure?\n        </DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-deletion-confirmation-dialog-description\">\n            Deletion is permanent. If you simply wish to pause this alert, disable it with the toggle switch instead.</DialogContentText>\n        </DialogContent>\n        <DialogActions sx={{ justifyContent: \"end\" }}>\n          <Button\n            onClick={() => {\n              setOpen(false)\n            }}\n            sx={{\n              color: theme.palette.text.secondary\n            }}\n          >\n            Cancel\n          </Button>\n\n          <Button\n            onClick={() => {\n              onConfirmedDelete();\n              setOpen(false);\n            }}\n          >\n            Delete\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}","import { CrudTypes } from '../AlertUtils';\n\nexport const DialogData = {\n  [CrudTypes.add]: {\n    title: \"Add A New Alert\",\n    primaryButtonLabel: \"Save Alert\",\n    errorMessage: \"Server error: new alert was not saved. Please try again\",\n    successMessage: \"New alert added successfully\"\n  },\n  [CrudTypes.edit]: {\n    title: \"Edit Alert\",\n    primaryButtonLabel: \"Save Edit\",\n    errorMessage: \"Server error: changes were not saved. Please try again\",\n    successMessage: \"Changes saved successfully\"\n  },\n  [CrudTypes.delete]: {\n    title: \"Delete Alert\",\n    contentText: \"Are you sure you want to delete this alert?\",\n    primaryButtonLabel: \"Delete\",\n    errorMessage: \"Server error: alert not deleted. Please try again.\",\n    successMessage: \"Alert deleted successfully\"\n  }\n};\n","import { Box, Stack, TextField, Typography } from \"@mui/material\";\n\nconst OptionalMessage = (props) => {\n    const {\n        label = \"Optional Message\",\n        value,\n        handleChange,\n        maxLength,\n        showTip = true,\n        disabled\n    } = props;\n    const currentLength = value ? value.length : 0;\n\n    return (\n        <Stack direction=\"column\">\n            <TextField\n                label={label}\n                multiline\n                minRows={2}\n                maxRows={4}\n                inputProps={{\n                    maxLength,\n                }}\n                value={value || ''}\n                onChange={(event) => {\n                    handleChange(event);\n                }}\n                disabled={disabled}\n            />\n            <Stack direction=\"row\" gap={1} justifyContent=\"space-between\" sx={{ mx: 1, my: 0.5 }}>\n                {showTip ? (\n                    <Typography color=\"text.secondary\" variant=\"caption\">\n                        Optional message that will appear in the alert\n                    </Typography>\n                ) : <Box />}\n\n                <Typography color=\"text.secondary\" variant=\"caption\" textAlign=\"right\">\n                    {currentLength}/{maxLength}\n                </Typography>\n            </Stack>\n        </Stack>\n    );\n};\n\nexport default OptionalMessage;","export const DAYS_OF_WEEK = [\n  { value: 0, label: 'Monday' },\n  { value: 1, label: 'Tuesday' },\n  { value: 2, label: 'Wednesday' },\n  { value: 3, label: 'Thursday' },\n  { value: 4, label: 'Friday' },\n  { value: 5, label: 'Saturday' },\n  { value: 6, label: 'Sunday' }\n];\n","import dayjs from 'dayjs';\nimport { styled } from '@mui/material/styles';\nimport { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { PickersDay } from '@mui/x-date-pickers/PickersDay';\nimport { DateCalendar } from '@mui/x-date-pickers/DateCalendar';\n\nimport { Link, Typography } from '@mui/material';\nimport CustomDialog from '../../../../CustomDialog/CustomDialog';\n\n// Custom styling for the selected days\nconst CustomPickersDay = styled(PickersDay, {\n  shouldForwardProp: (prop) => prop !== \"selected\"\n})(({ theme, selected }) => ({\n  ...(selected && {\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.common.white,\n    \"&:hover, &:focus\": {\n      backgroundColor: theme.palette.primary.dark\n    },\n    borderRadius: \"50%\",\n  })\n}));\n\n// Custom day component that highlights the selected dates\nconst CustomDayComponent = (props) => {\n  const { day, selectedDates, ...other } = props;\n\n  // Check if the day is selected\n  const isSelected = selectedDates.includes(dayjs(day).format('YYYY-MM-DD'));\n\n  return (\n    <CustomPickersDay {...other} day={day} selected={isSelected} />\n  )\n}\n\nexport default function MultiDaysCalendarPicker(props) {\n  const { selectedDates, handleChange, disabled } = props;\n\n  // Ensure selectedDates is formatted as \"YYYY-MM-DD\"\n  const parsedSelectedDates = selectedDates.map((date) => dayjs(date).format('YYYY-MM-DD'));\n\n  const len = selectedDates.length;\n  const title = len > 0 ? `Excluded Dates (${len} Days)` : `Excluded Dates`;\n\n  return (\n    <CustomDialog\n      dialogTitle={title}\n      buttonLabel={title}\n      buttonVariant='text'\n      disabled={disabled}\n      maxWidth=\"xs\"\n      displaySchoolID={false}\n    >\n      <Typography color=\"text.secondary\" variant='body2' gutterBottom>\n        Select dates when you do <b>NOT</b> want to receive alerts.\n        <br />\n        Useful for holidays or school breaks.\n      </Typography>\n\n      <Link\n        variant=\"caption\"\n        sx={{\n          cursor: \"pointer\",\n          display: \"block\",\n          textAlign: \"right\"\n        }}\n        onClick={(e) => {\n          e.preventDefault();\n          handleChange(selectedDates);\n        }}\n      >\n        Clear All\n      </Link>\n\n      <LocalizationProvider\n        dateAdapter={AdapterDayjs}\n        localeText={{\n          calendarWeekNumberHeaderText: 'Week',\n          calendarWeekNumberText: (weekNumber) => `${weekNumber}.`,\n        }}\n      >\n        <DateCalendar\n          displayWeekNumber\n          slots={{\n            day: (dayProps) => (\n              <CustomDayComponent\n                {...dayProps}\n                selectedDates={parsedSelectedDates}\n              />\n            ),\n          }}\n          onChange={(value, selectionState) => {\n            if (selectionState === 'finish') {\n              handleChange([dayjs(value).format('YYYY-MM-DD')]);\n            }\n          }}\n          disableHighlightToday\n          minDate={dayjs().startOf('month')} // Restrict to dates after the start of the current month\n        />\n      </LocalizationProvider>\n    </CustomDialog>\n  );\n}\n","import { Box, Grid, Stack, ToggleButton, ToggleButtonGroup, Tooltip } from '@mui/material';\nimport CalendarMonthIcon from '@mui/icons-material/CalendarMonth';\nimport { DAYS_OF_WEEK } from './DAYS_OF_WEEK';\nimport { useTheme } from '@mui/material';\nimport MultiDaysCalendarPicker from './MultiDaysCalendarPicker';\nimport { AirQualityAlertKeys, getAlertDefaultPlaceholder } from '../../AlertUtils';\n\nexport default function DateSelector(props) {\n  const { daysOfWeek, excludedDates, handleDaysOfWeekChange, handleExcludedDatesChange, disabled } = props;\n  const theme = useTheme();\n\n  return (\n    <Grid\n      container\n      rowSpacing={0.5}\n      columnSpacing={2}\n      alignItems=\"center\"\n      justifyContent=\"stretch\"\n    >\n      <Grid item xs={12} md={6}>\n        <Stack\n          direction=\"row\"\n          gap={1}\n          alignItems=\"start\"\n        >\n          <Box\n            aria-hidden\n            sx={{\n              '& .MuiSvgIcon-root': {\n                color: disabled\n                  ? theme.palette.text.secondary\n                  : theme.palette.primary.main,\n                verticalAlign: \"middle\"\n              }\n            }}\n          >\n            <CalendarMonthIcon sx={{ mt: 0.75 }} />\n          </Box>\n\n          <ToggleButtonGroup\n            value={daysOfWeek || getAlertDefaultPlaceholder()[AirQualityAlertKeys.days_of_week]}\n            onChange={handleDaysOfWeekChange}\n            aria-label=\"days of the week to receive alert\"\n            sx={{ display: 'flex', justifyContent: 'center' }} // Center the buttons horizontally\n            size=\"small\"\n            fullWidth\n            disabled={disabled}\n            color={disabled ? \"standard\" : \"primary\"}\n          >\n            {DAYS_OF_WEEK.map((day) => (\n              <Tooltip key={day.value} title={day.label} arrow>\n                <ToggleButton value={day.value} aria-label={day.label} sx={{ textTransform: 'none' }}>\n                  {day.label.slice(0, 3)}\n                </ToggleButton>\n              </Tooltip>\n            ))}\n          </ToggleButtonGroup>\n        </Stack>\n      </Grid>\n\n      <Grid item xs={12} md={6} ml={{ xs: 3, sm: 0 }}>\n        <MultiDaysCalendarPicker\n          selectedDates={excludedDates}\n          disabled={disabled}\n          handleChange={handleExcludedDatesChange}\n        />\n      </Grid>\n    </Grid>\n\n  );\n}\n","import { Slider, colors, TextField, Grid, Typography } from '@mui/material';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useTheme } from '@mui/material';\n\nexport const ThresholdSlider = (props) => {\n  const {\n    min = 0,\n    max = 100,\n    value,\n    defaultValue,\n    stepsForThreshold = 1,\n    marks = null,\n    handleChange,\n    disabled,\n    backgroundCssGradient,\n    invertSelection = false,\n    showInput = true,\n    inputUnit,\n    valueLabelDisplay = \"on\",\n    showTip = true\n  } = props;\n\n  const theme = useTheme();\n\n  // sliderValue is an array\n  const [sliderRangeMin, setSliderRangeMin] = useState(invertSelection ? value || defaultValue : min);\n  const [sliderRangeMax, setSliderRangeMax] = useState(invertSelection ? max : value || defaultValue);\n  const [nearestDataIndex, setNearestDataIndex] = useState(-1);\n\n  const [error, setError] = useState(false);\n  const [helperText, setHelperText] = useState('');\n\n  const findNearestDataIndex = useCallback((val) => {\n    if (!marks) return -1;\n\n    // Filter marks to get those with values greater than currentVal\n    const greaterMarks = marks.filter(mark => mark.value >= val);\n\n    // If no marks are greater, return -1\n    if (greaterMarks.length === 0) {\n      return -1;\n    }\n\n    // Find the mark with the nearest value greater than val\n    const nearestMark = greaterMarks.reduce((prev, curr) => {\n      return (curr.value - val) < (prev.value - val) ? curr : prev;\n    });\n\n    // Return the index of the nearest mark in the original marks array\n    const index = marks.indexOf(nearestMark)\n    return invertSelection ? index - 1 : index;\n  }, [marks, invertSelection]);\n\n  useEffect(() => {\n    const localSliderRangeMin = invertSelection ? value : min;\n    const localSliderRangeMax = invertSelection ? max : value;\n    setSliderRangeMin(localSliderRangeMin);\n    setSliderRangeMax(localSliderRangeMax);\n\n    setNearestDataIndex(findNearestDataIndex(invertSelection ? localSliderRangeMin : localSliderRangeMax));\n  }, [findNearestDataIndex, invertSelection, value, max, min]);\n\n  const handleSliderChange = (event, newValue) => {\n    const val = newValue[invertSelection ? 0 : 1];\n\n    setSliderRangeMin(invertSelection ? val : min);\n    setSliderRangeMax(invertSelection ? max : val);\n\n    handleChange(val);\n    setNearestDataIndex(findNearestDataIndex(val));\n  };\n\n  const handleInputChange = (event) => {\n    const val = event.target.value === '' ? '' : Number(event.target.value);\n\n    // Empty val\n    if (!val || val === '') {\n      handleChange(val);\n    }\n\n    // Non-empty val\n    if (val !== '' && (val >= min && val <= max)) {\n      setSliderRangeMin(invertSelection ? val : min);\n      setSliderRangeMax(invertSelection ? max : val);\n\n      handleChange(val);\n      setNearestDataIndex(findNearestDataIndex(val));\n\n      setError(false);\n      setHelperText('');\n    } else {\n      setError(true);\n      setHelperText(`Threshold must be between ${min} and ${max}`);\n    }\n  };\n\n  const stripedGradient = `repeating-linear-gradient(-45deg, ${colors.grey[800]}, ${colors.grey[800]} 4px, ${colors.common.white} 4px, ${colors.common.white} 8px)`;\n\n  const sliderSX = {\n    height: \"20vh\",\n    minHeight: \"250px\",\n    maxHeight: \"500px\",\n    cursor: disabled ? 'not-allowed' : 'inherit',\n    pointerEvents: 'all',\n    '& *': {\n      transition: 'none !important'\n    },\n    '& .MuiSlider-thumb': {\n      width: '2rem',\n      height: '4px',\n      borderRadius: 1,\n      color: colors.common.black,\n    },\n    [`& .MuiSlider-thumb[data-index=\"${invertSelection ? 1 : 0}\"]`]: {\n      display: 'none',\n    },\n    '& .MuiSlider-mark, .MuiSlider-markActive': {\n      width: '2rem',\n      height: '3px',\n      background: theme.palette.background.paper,\n      backgroundImage: theme.palette.background.paperBackgroundGradient\n    },\n    '& .MuiSlider-thumb, .MuiSlider-mark': {\n      transform: `translate(-50%,50%})`\n    },\n    '& .MuiSlider-rail, .MuiSlider-track': {\n      width: '1rem',\n      opacity: 0.75,\n      border: 'none'\n    },\n    '& .MuiSlider-rail': {\n      background: disabled ? colors.grey[400] : backgroundCssGradient,\n    },\n    '& .MuiSlider-track': {\n      background: stripedGradient,\n      ...(invertSelection ? {\n        borderBottomLeftRadius: 0,\n        borderBottomRightRadius: 0\n      } : {\n        borderTopLeftRadius: 0,\n        borderTopRightRadius: 0\n      })\n    },\n    [`& .MuiSlider-markLabel, .MuiSlider-markLabel[data-index=\"${nearestDataIndex}\"]`]: {\n      color: theme.palette.text.primary,\n      fontWeight: 500,\n      textDecoration: 'underline',\n    },\n    '& .MuiSlider-markLabelActive': {\n      color: theme.palette.text.secondary,\n      fontWeight: 'inherit',\n      textDecoration: 'inherit',\n    },\n    '& .MuiSlider-valueLabel': {\n      transform: 'translate(-10px, -50%)',\n    }\n  };\n\n  return (\n    <>\n      <Grid container item xs=\"auto\" alignItems=\"end\" spacing={0.5}>\n        <Grid item xs=\"auto\" minWidth=\"4.5rem\">\n          {showInput ? (\n            <TextField\n              variant='standard'\n              type=\"number\"\n              label=\"Threshold\"\n              value={invertSelection ? sliderRangeMin : sliderRangeMax}\n              onChange={handleInputChange}\n              error={error}\n              helperText={helperText}\n              size='small'\n              fullWidth\n              disabled={disabled}\n              inputProps={{\n                step: stepsForThreshold,\n                min,\n                max,\n                type: 'number',\n                'aria-labelledby': 'input-threshold-slider'\n              }}\n            />\n          ) : null}\n        </Grid>\n\n        {\n          inputUnit ? (\n            <Grid item>\n              <Typography variant='body2'>\n                {inputUnit}\n              </Typography>\n            </Grid>\n          ) : null\n        }\n      </Grid>\n\n      <Grid item xs={12} sx={{ mt: 2, ml: 7.5 }}>\n        <Slider\n          getAriaLabel={() => 'Alert Threshold Slider'}\n          aria-labelledby=\"input-threshold-slider\"\n          value={[sliderRangeMin, sliderRangeMax]}\n          step={marks === null ? stepsForThreshold : null} // only allow discrete equal step if marks are not provided\n          marks={marks}\n          disabled={disabled}\n          min={min}\n          max={max}\n          onChange={handleSliderChange}\n          valueLabelDisplay={valueLabelDisplay}\n          orientation=\"vertical\"\n          sx={sliderSX} />\n      </Grid>\n\n      <Grid item sx={{ mt: 1, ml: 1, visibility: showTip === true ? 'visible' : 'hidden' }}>\n        <Typography color=\"text.secondary\" variant='caption' display='block'>\n          Move the slider to change the alert's threshold value or use the text input box for more precise control.\n        </Typography>\n      </Grid>\n    </>\n  );\n};","import { createContext, useMemo, useState, useEffect, useCallback } from 'react';\nimport { isValidArray } from '../Utils/UtilFunctions';\nimport { DataTypes } from '../Utils/AirQuality/DataTypes';\nimport useSchoolMetadata from '../hooks/useSchoolMetadata';\nimport { AirQualityAlertKeys, getAlertDefaultPlaceholder } from '../Components/AirQuality/AirQualityAlerts/AlertUtils';\n\nexport const AirQualityAlertContext = createContext();\n\nexport function AirQualityAlertProvider({ children }) {\n  const { data: schoolMetadata } = useSchoolMetadata();\n\n  const [selectedAlert, setSelectedAlert] = useState(getAlertDefaultPlaceholder());\n  const [editingAlert, setEditingAlert] = useState(selectedAlert);\n  const [allowedDataTypesForSensor, setAllowedDataTypesForSensor] = useState([]);\n\n  const returnAllowedDataTypesForThisSensor = useCallback((sensor) => {\n    if (!schoolMetadata) return [];\n\n    const { sensors } = schoolMetadata;\n    if (!isValidArray(sensors)) return [];\n\n    const sensorData = sensors.find(elem => elem.sensor_id === sensor);\n    const allowedDataTypesForThisSensor = sensorData?.allowedDataTypes;\n\n    if (allowedDataTypesForThisSensor) {\n      return allowedDataTypesForThisSensor.map(dataType => ({\n        value: dataType,\n        label: DataTypes[dataType].name_title\n      }));\n    }\n\n    return [];\n  }, [schoolMetadata]);\n\n  useEffect(() => {\n    setEditingAlert({ ...selectedAlert });\n  }, [selectedAlert]);\n\n  useEffect(() => {\n    const sensor_id = editingAlert[AirQualityAlertKeys.sensor_id];\n    if (sensor_id && sensor_id !== '') {\n      setAllowedDataTypesForSensor(\n        returnAllowedDataTypesForThisSensor(sensor_id)\n      )\n    }\n  }, [editingAlert, returnAllowedDataTypesForThisSensor]);\n\n  const contextValue = useMemo(() => ({\n    selectedAlert, setSelectedAlert,\n    editingAlert, setEditingAlert,\n    allowedDataTypesForSensor, setAllowedDataTypesForSensor\n  }), [selectedAlert, editingAlert, allowedDataTypesForSensor]);\n\n  return (\n    <AirQualityAlertContext.Provider value={contextValue}>\n      {children}\n    </AirQualityAlertContext.Provider>\n  );\n}","import { ThresholdSlider } from \"./ThresholdSlider\";\nimport { DataTypeKeys, DataTypes } from \"../../../../../../Utils/AirQuality/DataTypes\";\nimport { AQI_Database, HeatIndex_Database, VOC_Database } from \"../../../../../../Utils/AirQuality/AirQualityIndexHelper\";\nimport { useTheme } from '@mui/material';\nimport { generateCssBackgroundGradient } from \"../../../../../../Utils/Gradient/GradientUtils\";\nimport { getTranslation } from \"../../../../../../Utils/UtilFunctions\";\nimport { useContext } from \"react\";\nimport { PreferenceContext } from \"../../../../../../ContextProviders/PreferenceContext\";\nimport { AirQualityAlertKeys } from \"../../../AlertUtils\";\nimport { AirQualityAlertContext } from \"../../../../../../ContextProviders/AirQualityAlertContext\";\n\nexport const ThresholdComponentWrapper = (props) => {\n    const {\n        value,\n        invertSelection,\n        handleValueChange,\n        placeholderValueBeforeDataTypeSelection = 0.5,\n        disabledSlider,\n        showTip = true\n    } = props;\n\n    const { editingAlert } = useContext(AirQualityAlertContext);\n    const { language } = useContext(PreferenceContext);\n    const theme = useTheme();\n\n    let thresholdSlider = null;\n\n    const currentDataTypeKey = editingAlert[AirQualityAlertKeys.datatypekey];\n    if (currentDataTypeKey && DataTypes[currentDataTypeKey]) {\n        const dataType = DataTypes[currentDataTypeKey];\n        const dataTypeColorAxis = theme.palette.chart.colorAxes[dataType.color_axis];\n        const { colors, minValue, maxValue, defaultValueForAlert, stepsForThreshold } = dataTypeColorAxis;\n\n        const backgroundCssGradient = generateCssBackgroundGradient({\n            gradientDirection: 'to top',\n            colors: colors\n        });\n\n        // Check if this dataType exists in the AQI_Database\n        // If yes, return value and label accordingly to the marks\n        let marks, database;\n\n        switch (currentDataTypeKey) {\n            case DataTypeKeys.voc:\n                database = VOC_Database;\n                break;\n            case DataTypeKeys.aqi:\n            case DataTypeKeys.pm2_5:\n            case DataTypeKeys.pm10_raw:\n            case DataTypeKeys.co2:\n                database = AQI_Database;\n                break;\n            case DataTypeKeys.heat_index_C:\n                database = HeatIndex_Database;\n                break;\n            default:\n                database = null;\n        }\n\n        if (database) {\n            marks = database\n                .filter((_, index) => index !== 0) // do not return the lowest category\n                .map((element) => {\n                    const val = element[dataType.threshold_mapping_name].low;\n                    return {\n                        value: val,\n                        label: getTranslation(element.category, language)\n                    }\n                })\n        }\n\n        const inputUnit = Object.keys(DataTypes)\n            .filter(key => key === editingAlert[AirQualityAlertKeys.datatypekey])\n            .map(key => DataTypes[key].unit)[0]\n\n        thresholdSlider = (\n            <ThresholdSlider\n                min={minValue}\n                max={maxValue}\n                marks={marks}\n                defaultValue={defaultValueForAlert}\n                value={value}\n                stepsForThreshold={stepsForThreshold}\n                disabled={disabledSlider}\n                backgroundCssGradient={backgroundCssGradient}\n                invertSelection={invertSelection}\n                handleChange={handleValueChange}\n                inputUnit={inputUnit}\n                showTip={showTip}\n            />\n        )\n    } else {\n        thresholdSlider = (\n            <ThresholdSlider\n                min={0}\n                max={1}\n                value={placeholderValueBeforeDataTypeSelection}\n                disabled={true}\n                showInput={false}\n                invertSelection={invertSelection}\n                valueLabelDisplay=\"off\"\n                showTip={showTip}\n            />\n        )\n    }\n\n    return thresholdSlider;\n}","import { FormControl, FormGroup, FormControlLabel, FormHelperText, Checkbox, Typography } from '@mui/material';\n\nexport const MaxOnceADayCheckbox = ({ value, handleChange, disabled }) => {\n\n  const returnHelperText = () => {\n    if (value === true) {\n      return (\n        <>\n          Send alert <strong>at most once a day</strong> when the threshold is breached\n        </>\n      );\n    } else {\n      return (\n        <>\n          Send alert <strong>every hour</strong> for as long as the threshold is breached\n        </>\n      );\n    }\n  };\n  return (\n    <FormControl\n      component=\"fieldset\"\n      variant=\"standard\"\n      sx={{ mt: { md: -1 } }}\n      disabled={disabled}\n    >\n      <FormGroup>\n        <FormControlLabel\n          control={\n            <Checkbox\n              checked={value}\n              onChange={handleChange}\n              size='small'\n            />\n          }\n          label={<Typography color=\"text.secondary\" fontWeight={500}>Max Once a Day</Typography>}\n          color=\"text.secondary\"\n        />\n      </FormGroup>\n      <FormHelperText sx={{ mt: -0.5 }}>{returnHelperText()}</FormHelperText>\n    </FormControl>\n  );\n};\n","import { ToggleButtonGroup, ToggleButton } from '@mui/material';\nimport { ThresholdAlertTypes } from '../../../AlertTypes';\n\nexport const ThresholdTypeToggle = ({ currentAlertType, handleChange, disabled, ...others }) => {\n  return (\n    <ToggleButtonGroup\n      color={disabled ? \"standard\" : \"primary\"}\n      disabled={disabled}\n      defaultValue={ThresholdAlertTypes.above_threshold.id}\n      value={currentAlertType}\n      exclusive\n      aria-label=\"toggle to choose alert below or above a threshold\"\n      size=\"small\"\n      onChange={handleChange}\n      {...others}\n    >\n      {Object.keys(ThresholdAlertTypes).map((key) => {\n        const thresholdAlertType = ThresholdAlertTypes[key];\n\n        return (\n          <ToggleButton\n            key={thresholdAlertType.id}\n            size=\"small\"\n            sx={{\n              textTransform: \"capitalize !important\",\n              px: 1.25\n            }}\n            value={thresholdAlertType.id}\n            aria-label={thresholdAlertType.id}\n          >\n            {thresholdAlertType.sign}&nbsp;{thresholdAlertType.name}\n          </ToggleButton>\n        );\n      })}\n    </ToggleButtonGroup>\n  );\n};\n\nexport const ThresholdType = ({ currentAlertType, ...others }) => {\n\n  return (\n    <ToggleButtonGroup\n      color={\"standard\"}\n      disabled={true}\n      defaultValue={ThresholdAlertTypes.below_threshold.id}\n      value={currentAlertType}\n      exclusive\n      aria-label=\"non-interactive button displaying threshold type\"\n      size=\"small\"\n      {...others}\n    >\n      {Object.keys(ThresholdAlertTypes).map((key) => {\n        const thresholdAlertType = ThresholdAlertTypes[key];\n        if (thresholdAlertType.id !== currentAlertType) return null;\n\n        return (\n          <ToggleButton\n            key={thresholdAlertType.id}\n            size=\"small\"\n            sx={{\n              textTransform: \"capitalize !important\",\n              px: 1.25\n            }}\n            value={thresholdAlertType.id}\n            aria-label={thresholdAlertType.id}\n          >\n            {thresholdAlertType.sign}&nbsp;{thresholdAlertType.name}\n          </ToggleButton>\n        );\n      })}\n    </ToggleButtonGroup>\n  );\n}\n","import AlertTypes, { ThresholdAlertTypes } from \"../../AlertTypes\";\nimport { SimplePicker } from \"./SimplePicker\";\n\nimport AccessTimeIcon from '@mui/icons-material/AccessTime';\nimport PlaceIcon from '@mui/icons-material/Place';\nimport { AirQualityAlertKeys, getAlertDefaultPlaceholder, SharedColumnHeader } from \"../../AlertUtils\";\nimport TimeRangeSelector from \"../../../../TimeRange/TimeRangeSelector\";\nimport { DataTypes } from \"../../../../../Utils/AirQuality/DataTypes\";\nimport { capitalizePhrase } from \"../../../../../Utils/UtilFunctions\";\nimport { HOURS } from \"../../../../TimeRange/TimeRangeUtils\";\nimport { Checkbox, DialogContentText, FormControlLabel, FormGroup, Grid, Stack, Switch, Typography, useTheme } from \"@mui/material\";\n\nimport OptionalMessage from \"./OptionalMessage\";\nimport DateSelector from \"./DaySelector\";\nimport { ThresholdComponentWrapper } from \"./ThresholdAlertComponents/ThresholdComponentWrapper\";\n\nimport { DialogData } from \"../DialogData\";\nimport { MaxOnceADayCheckbox } from \"./MaxOnceADayCheckbox\";\nimport { ThresholdType, ThresholdTypeToggle } from \"./ThresholdAlertComponents/ThresholdTypeToggle\";\n\nimport useSchoolMetadata from \"../../../../../hooks/useSchoolMetadata\";\nimport { useContext } from \"react\";\nimport { AirQualityAlertContext } from \"../../../../../ContextProviders/AirQualityAlertContext\";\n\nconst returnFormattedStatusString = (editingAlert) => {\n    const status = editingAlert[AirQualityAlertKeys.is_enabled] ? \"enabled\" : \"disabled\";\n    const tense = editingAlert[AirQualityAlertKeys.id] ? \"is\" : \"will be\"; // if this alert doesn't have id, it's not d in DB yet, thus we use future tense \n\n    return `This alert ${tense} ${status}`;\n}\n\nexport const AlertPropertyComponents = ({ alertTypeKey, crudType }) => {\n    const { data: schoolMetadata } = useSchoolMetadata();\n    const { editingAlert, allowedDataTypesForSensor, setEditingAlert } = useContext(AirQualityAlertContext);\n\n    const theme = useTheme();\n\n    // Get the available sensors (locations) for this school\n    const allSensorsOfSchool = schoolMetadata?.sensors?.map(sensor => (\n        {\n            value: sensor.sensor_id,\n            label: capitalizePhrase(sensor.location_short)\n        }\n    ));\n\n    // Helper function to check if the previous field has a value to disable this field\n    const isDisabled = (key) => {\n        switch (key) {\n            case AirQualityAlertKeys.sensor_id:\n            case AirQualityAlertKeys.is_enabled:\n                // sensor_id and is_enabled can never be disabled because it's the first field\n                return false;\n\n            case AirQualityAlertKeys.datatypekey:\n                // datatypekey depends on sensor_id having a placeholder value\n                return editingAlert[AirQualityAlertKeys.sensor_id] === getAlertDefaultPlaceholder(alertTypeKey)[AirQualityAlertKeys.sensor_id];\n\n            case AirQualityAlertKeys.child_alert:\n                // child_alert depends on has_child_alert being true\n                return editingAlert[AirQualityAlertKeys.has_child_alert] !== true;\n\n            default:\n                // all other fields depends on datatypekey having a placeholder value\n                return editingAlert[AirQualityAlertKeys.datatypekey] === getAlertDefaultPlaceholder(alertTypeKey)[AirQualityAlertKeys.datatypekey];\n        }\n    };\n\n    const displayHourPicker = () => {\n        switch (alertTypeKey) {\n            case AlertTypes.daily.id:\n                return (\n                    <SimplePicker\n                        icon={<AccessTimeIcon />}\n                        label={AlertTypes.daily.tableColumnHeader}\n                        value={editingAlert[AirQualityAlertKeys.minutespastmidnight]}\n                        options={HOURS}\n                        disabled={isDisabled(AirQualityAlertKeys.minutespastmidnight)}\n                        handleChange={(event) => {\n                            setEditingAlert({\n                                ...editingAlert,\n                                [AirQualityAlertKeys.minutespastmidnight]: event.target.value\n                            });\n                        }}\n                    />\n                );\n            case AlertTypes.threshold.id:\n                return (\n                    <Grid container columnSpacing={2} rowSpacing={0.5}>\n                        <Grid item xs={12} md={6}>\n                            <TimeRangeSelector\n                                timeRange={editingAlert[AirQualityAlertKeys.time_range]}\n                                defaultTimeRange={getAlertDefaultPlaceholder(AlertTypes.threshold.id)[AirQualityAlertKeys.time_range]}\n                                disabled={isDisabled(AirQualityAlertKeys.time_range)}\n                                handleChange={(newRange) => {\n                                    setEditingAlert({\n                                        ...editingAlert,\n                                        [AirQualityAlertKeys.time_range]: newRange\n                                    });\n                                }}\n                            />\n                        </Grid>\n\n                        <Grid item xs={12} md={6}>\n                            <MaxOnceADayCheckbox\n                                value={editingAlert[AirQualityAlertKeys.max_once_a_day]}\n                                handleChange={(event) => {\n                                    setEditingAlert({\n                                        ...editingAlert,\n                                        [AirQualityAlertKeys.max_once_a_day]: event.target.checked\n                                    })\n                                }}\n                                disabled={isDisabled(AirQualityAlertKeys.max_once_a_day)}\n                            />\n                        </Grid>\n                    </Grid>\n                );\n            default:\n                return null;\n        }\n    }\n\n    return (\n        <Stack\n            direction=\"column\"\n            gap={2}\n            mt={1}\n            width=\"100%\"\n        >\n            {\n                DialogData[crudType]?.contentText ?\n                    (\n                        <DialogContentText fontWeight=\"500\">\n                            {DialogData[crudType].contentText}\n                        </DialogContentText>\n                    ) : null\n            }\n\n            <Stack\n                direction=\"row\"\n                gap={1}\n                alignItems=\"center\"\n                mb={2}\n            >\n                <Switch\n                    size='small'\n                    checked={editingAlert[AirQualityAlertKeys.is_enabled]}\n                    onChange={(event) => {\n                        setEditingAlert({\n                            ...editingAlert,\n                            [AirQualityAlertKeys.is_enabled]: event.target.checked\n                        });\n                    }}\n                    disabled={isDisabled(AirQualityAlertKeys.is_enabled)}\n                />\n                <Typography\n                    fontWeight={500}\n                    color=\"text.secondary\"\n                >\n                    {returnFormattedStatusString(editingAlert)}\n                </Typography>\n            </Stack>\n\n            <Grid\n                container\n                columnSpacing={2}\n                alignItems=\"center\"\n            >\n                <Grid item xs={6}>\n                    <SimplePicker\n                        icon={<PlaceIcon />}\n                        label={SharedColumnHeader.location}\n                        value={editingAlert[AirQualityAlertKeys.sensor_id]}\n                        options={allSensorsOfSchool}\n                        disabled={isDisabled(AirQualityAlertKeys.sensor_id)}\n                        handleChange={(event) => {\n                            setEditingAlert({\n                                ...editingAlert,\n                                [AirQualityAlertKeys.sensor_id]: event.target.value,\n                                [AirQualityAlertKeys.datatypekey]: ''\n                            });\n                        }}\n                    />\n                </Grid>\n\n                <Grid item xs={6}>\n                    <SimplePicker\n                        label={SharedColumnHeader.dataType}\n                        value={editingAlert[AirQualityAlertKeys.datatypekey]}\n                        options={allowedDataTypesForSensor}\n                        disabled={isDisabled(AirQualityAlertKeys.datatypekey)}\n                        handleChange={(event) => {\n                            const selectedDataTypeKey = event.target.value;\n                            const dataType = DataTypes[selectedDataTypeKey];\n\n                            // After data type is determined, set the threshold value to defaultValueForAlert\n                            setEditingAlert({\n                                ...editingAlert,\n                                [AirQualityAlertKeys.datatypekey]: selectedDataTypeKey,\n                                [AirQualityAlertKeys.threshold_value]: theme.palette.chart.colorAxes[dataType.color_axis]?.defaultValueForAlert,\n                                [AirQualityAlertKeys.child_alert]: {\n                                    ...editingAlert[AirQualityAlertKeys.child_alert],\n                                    [AirQualityAlertKeys.threshold_value]: theme.palette.chart.colorAxes[dataType.color_axis]?.defaultValueForChildAlert\n                                }\n                            });\n                        }}\n                        flex={1}\n                    />\n                </Grid>\n            </Grid>\n\n            <DateSelector\n                daysOfWeek={editingAlert[AirQualityAlertKeys.days_of_week]}\n                excludedDates={editingAlert[AirQualityAlertKeys.excluded_dates] || []}\n                disabled={isDisabled(AirQualityAlertKeys.days_of_week)}\n                handleDaysOfWeekChange={(_, newValue) => {\n                    const validDaysOfWeek = Array.isArray(newValue) ? newValue : [];\n\n                    setEditingAlert({\n                        ...editingAlert,\n                        [AirQualityAlertKeys.days_of_week]: validDaysOfWeek.sort()\n                    });\n                }}\n                handleExcludedDatesChange={(valueArray) => {\n                    // Get the current excluded dates or initialize as an empty array\n                    const currentExcludedDates = editingAlert[AirQualityAlertKeys.excluded_dates] || [];\n\n                    // Create a new array that updates the excluded dates\n                    const updatedExcludedDates = valueArray.reduce((acc, date) => {\n                        // Check if the date is already excluded\n                        if (acc.includes(date)) {\n                            // If it exists, filter it out (remove the date)\n                            return acc.filter(excludedDate => excludedDate !== date);\n                        } else {\n                            // If it doesn't exist, add the date to the array\n                            return [...acc, date];\n                        }\n                    }, currentExcludedDates); // Start with the current excluded dates\n\n                    // Update the state with the new excluded_dates array\n                    setEditingAlert({\n                        ...editingAlert,\n                        [AirQualityAlertKeys.excluded_dates]: updatedExcludedDates\n                    });\n                }}\n            />\n\n\n            {displayHourPicker(alertTypeKey)}\n\n            {alertTypeKey === AlertTypes.threshold.id ?\n                (\n                    <Grid container alignItems=\"start\" spacing={2}>\n                        <Grid container item xs={12} sm={6}>\n                            <Grid item xs={12}>\n                                <Typography\n                                    variant='body1'\n                                    fontWeight={500}\n                                    color=\"text.secondary\"\n                                    sx={{ mt: \"2px\", mb: \"12px\" }} // absolute value to align with the other side\n                                >\n                                    1. Alert if it is:\n                                </Typography>\n                            </Grid>\n\n                            <Grid item sx={{ mr: 2 }}>\n                                <ThresholdTypeToggle\n                                    currentAlertType={editingAlert[AirQualityAlertKeys.alert_type]}\n                                    handleChange={(event) => {\n                                        const selectedAlertType = event.target.value;\n                                        const oppositeAlertTypeForChildAlert = selectedAlertType === ThresholdAlertTypes.above_threshold.id\n                                            ? ThresholdAlertTypes.below_threshold.id\n                                            : ThresholdAlertTypes.above_threshold.id;\n\n                                        setEditingAlert({\n                                            ...editingAlert,\n                                            [AirQualityAlertKeys.alert_type]: selectedAlertType,\n                                            [AirQualityAlertKeys.child_alert]: {\n                                                ...editingAlert[AirQualityAlertKeys.child_alert],\n                                                [AirQualityAlertKeys.alert_type]: oppositeAlertTypeForChildAlert\n                                            }\n                                        });\n                                    }}\n                                    disabled={isDisabled(AirQualityAlertKeys.alert_type)}\n                                    sx={{\n                                        height: \"100%\"\n                                    }}\n                                />\n                            </Grid>\n\n                            <ThresholdComponentWrapper\n                                value={editingAlert[AirQualityAlertKeys.threshold_value]}\n                                invertSelection={editingAlert[AirQualityAlertKeys.alert_type] === ThresholdAlertTypes.below_threshold.id}\n                                handleValueChange={(value) => {\n                                    setEditingAlert({\n                                        ...editingAlert,\n                                        [AirQualityAlertKeys.threshold_value]: value\n                                    });\n                                }}\n                                disabledToggle={isDisabled(AirQualityAlertKeys.alert_type)}\n                                disabledSlider={isDisabled(AirQualityAlertKeys.threshold_value)}\n                                placeholderValueBeforeDataTypeSelection={2 / 3}\n                            />\n\n                            <Grid item xs={12} mt={2}>\n                                <OptionalMessage\n                                    value={editingAlert[AirQualityAlertKeys.message]}\n                                    handleChange={(event) => {\n                                        setEditingAlert({\n                                            ...editingAlert,\n                                            [AirQualityAlertKeys.message]: event.target.value\n                                        });\n                                    }}\n                                    maxLength={200}\n                                    label=\"Optional Message for Main Alert\"\n                                    disabled={isDisabled(AirQualityAlertKeys.message)}\n                                />\n                            </Grid>\n\n                        </Grid>\n                        <Grid container item xs={12} sm={6}>\n                            <Grid item xs={12}>\n                                <FormGroup>\n                                    <FormControlLabel\n                                        disabled={isDisabled(AirQualityAlertKeys.has_child_alert)}\n                                        control={\n                                            <Checkbox\n                                                checked={!!editingAlert[AirQualityAlertKeys.has_child_alert]} // fallback in case undefined in first render\n                                                onChange={(event) => {\n                                                    setEditingAlert({\n                                                        ...editingAlert,\n                                                        [AirQualityAlertKeys.has_child_alert]: event.target.checked\n                                                    });\n                                                }}\n                                                size=\"small\"\n                                            />\n                                        }\n                                        label={\n                                            <Typography\n                                                variant={'body1'}\n                                                fontWeight={500}\n                                                color=\"text.secondary\"\n                                            >\n                                                2. [Optional] Follow-up alert if it changes to:\n                                            </Typography>\n                                        }\n                                        color=\"text.secondary\"\n                                    />\n                                </FormGroup>\n                            </Grid>\n\n                            {\n                                editingAlert[AirQualityAlertKeys.child_alert] && (\n                                    <>\n                                        <Grid item sx={{ mr: 2 }}>\n                                            <ThresholdType\n                                                currentAlertType={editingAlert[AirQualityAlertKeys.child_alert]?.[AirQualityAlertKeys.alert_type]}\n                                                sx={{\n                                                    height: \"100%\"\n                                                }}\n                                            />\n                                        </Grid>\n\n                                        <ThresholdComponentWrapper\n                                            value={editingAlert[AirQualityAlertKeys.child_alert][AirQualityAlertKeys.threshold_value]}\n                                            invertSelection={editingAlert[AirQualityAlertKeys.child_alert]?.[AirQualityAlertKeys.alert_type] === ThresholdAlertTypes.below_threshold.id || true}\n                                            handleValueChange={(value) => {\n                                                setEditingAlert({\n                                                    ...editingAlert,\n                                                    [AirQualityAlertKeys.child_alert]: {\n                                                        ...editingAlert[AirQualityAlertKeys.child_alert],\n                                                        [AirQualityAlertKeys.threshold_value]: value\n                                                    }\n                                                });\n                                            }}\n                                            disabledToggle={isDisabled(AirQualityAlertKeys.child_alert)}\n                                            disabledSlider={isDisabled(AirQualityAlertKeys.child_alert)}\n                                            showTip={false}\n                                            placeholderValueBeforeDataTypeSelection={1 / 3}\n                                        />\n\n                                        <Grid item xs={12} mt={2}>\n                                            <OptionalMessage\n                                                value={editingAlert[AirQualityAlertKeys.child_alert][AirQualityAlertKeys.message]}\n                                                handleChange={(event) => {\n                                                    setEditingAlert({\n                                                        ...editingAlert,\n                                                        [AirQualityAlertKeys.child_alert]: {\n                                                            ...editingAlert[AirQualityAlertKeys.child_alert],\n                                                            [AirQualityAlertKeys.message]: event.target.value\n                                                        }\n                                                    });\n                                                }}\n                                                maxLength={200}\n                                                label=\"Optional Message for Follow-up Alert\"\n                                                showTip={false}\n                                                disabled={isDisabled(AirQualityAlertKeys.child_alert)}\n                                            />\n                                        </Grid>\n                                    </>\n                                )\n                            }\n                        </Grid>\n                    </Grid>\n\n                ) : (\n                    <OptionalMessage\n                        value={editingAlert[AirQualityAlertKeys.message]}\n                        handleChange={(event) => {\n                            setEditingAlert({\n                                ...editingAlert,\n                                [AirQualityAlertKeys.message]: event.target.value\n                            });\n                        }}\n                        maxLength={200}\n                        disabled={isDisabled(AirQualityAlertKeys.message)}\n                    />\n                )}\n        </Stack>\n    );\n}","import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useContext } from \"react\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\nimport { UserContext } from \"../../ContextProviders/UserContext\";\nimport { getApiUrl } from \"../../API/ApiUrls\";\nimport { GeneralAPIendpoints, RESTmethods } from \"../../API/Utils\";\nimport { addChildToAlerts, AirQualityAlertKeys } from \"../../Components/AirQuality/AirQualityAlerts/AlertUtils\";\nimport { fetchDataFromURL } from \"../../API/ApiFetch\";\n\nexport const useEditAlertMutation = () => {\n    const queryClient = useQueryClient();\n    const { currentSchoolID } = useContext(DashboardContext);\n    const { user } = useContext(UserContext);\n\n    return useMutation({\n        mutationFn: async ({ alertId, alertToEdit }) => {\n            const url = getApiUrl({\n                paths: [GeneralAPIendpoints.alerts, currentSchoolID, alertId]\n            });\n\n            return fetchDataFromURL({\n                url,\n                restMethod: RESTmethods.PUT,\n                body: alertToEdit\n            });\n        },\n        onSuccess: (editedAlert, { alertId }) => {\n            queryClient.setQueryData(\n                [GeneralAPIendpoints.alerts, currentSchoolID, user.username || user.email],\n                (old = []) => addChildToAlerts(old.map(alert =>\n                    alert[AirQualityAlertKeys.id] === alertId\n                        ? editedAlert\n                        : alert\n                ))\n            );\n        }\n    });\n};","import { Button, Dialog, DialogTitle, DialogActions, DialogContent, Stack, useMediaQuery } from '@mui/material';\nimport { useTheme } from '@mui/material';\nimport AlertTypes, { ThresholdAlertTypes } from '../AlertTypes';\nimport { AirQualityAlertKeys, CrudTypes, getAlertDefaultPlaceholder } from '../AlertUtils';\nimport { useContext, useEffect, useState } from 'react';\nimport { SnackbarMetadata } from '../../../../Utils/SnackbarMetadata';\nimport isEqual from 'lodash.isequal';\nimport AlertDeletionDialog from './AlertDeletionDialog';\nimport { useSnackbar } from 'notistack';\nimport { DialogData } from './DialogData';\nimport { AlertPropertyComponents } from './AlertPropertyComponents/AlertPropertyComponents';\nimport { useCreateAlertMutation } from '../../../../hooks/alerts/useCreateAlertMutation';\nimport { useEditAlertMutation } from '../../../../hooks/alerts/useEditAlertMutation';\nimport { useDeleteAlertMutation } from '../../../../hooks/alerts/useDeleteAlertMutation';\nimport { AirQualityAlertContext } from '../../../../ContextProviders/AirQualityAlertContext';\n\nconst AlertModificationDialog = (props) => {\n  const {\n    alertTypeKey,\n    openAlertModificationDialog,\n    crudType,\n    handleClose\n  } = props;\n\n  const { selectedAlert, setSelectedAlert, editingAlert, setEditingAlert } = useContext(AirQualityAlertContext);\n\n  const [shouldDisableButton, setShouldDisableButton] = useState(false);\n\n  const { enqueueSnackbar } = useSnackbar()\n\n  const theme = useTheme();\n\n  const sanityCheckAlertBeforeSaving = () => {\n    if (alertTypeKey === AlertTypes.daily.id) return { valid: true };\n\n    if (!editingAlert[AirQualityAlertKeys.has_child_alert]) return { valid: true };\n\n    const isAbove = editingAlert[AirQualityAlertKeys.alert_type] === ThresholdAlertTypes.above_threshold.id;\n    const threshold = editingAlert[AirQualityAlertKeys.threshold_value];\n    const childThreshold = editingAlert[AirQualityAlertKeys.child_alert]?.[AirQualityAlertKeys.threshold_value];\n\n    if (childThreshold === undefined) return { valid: true };\n\n    if (\n      (isAbove && threshold <= childThreshold) ||\n      (!isAbove && threshold >= childThreshold)\n    ) {\n      return {\n        valid: false,\n        message: `The follow-up alert must have a ${isAbove ? \"lower\" : \"higher\"} threshold than the first alert`\n      };\n    }\n\n    return { valid: true };\n  };\n\n  const removeChildAlertFromParentAlertBody = (body) => {\n    const newBody = { ...body };\n    delete newBody[AirQualityAlertKeys.child_alert];\n    delete newBody[AirQualityAlertKeys.has_child_alert];\n    return newBody;\n  }\n\n  const formatChildAlertBody = (body, parent_alert_id) => {\n    const newBody = {\n      ...body, // copy all properties from parent\n      ...body[AirQualityAlertKeys.child_alert], // but then, override with child's unique properties\n      [AirQualityAlertKeys.parent_alert_id]: parent_alert_id, // finally, link child to parent\n      [AirQualityAlertKeys.id]: null // destroy parent's id just in case\n    };\n    delete newBody[AirQualityAlertKeys.child_alert];\n    delete newBody[AirQualityAlertKeys.has_child_alert];\n\n    return newBody;\n  };\n\n  const handleSuccess = (passedCrudType) => {\n    enqueueSnackbar(DialogData[passedCrudType].successMessage, SnackbarMetadata.success);\n    handleClose();\n  }\n  const handleError = (passedCrudType) => {\n    enqueueSnackbar(DialogData[passedCrudType].errorMessage, SnackbarMetadata.error);\n  };\n\n  const handleAlertModification = ({ passedCrudType }) => {\n    const result = sanityCheckAlertBeforeSaving();\n    if (!result.valid) {\n      enqueueSnackbar(result.message, SnackbarMetadata.error);\n      return;\n    }\n\n    switch (passedCrudType) {\n      case CrudTypes.add: {\n        // 1. POST to create the main alert (always run)\n        createAlertMutation.mutate(\n          {\n            alertToCreate: removeChildAlertFromParentAlertBody(editingAlert)\n          },\n          {\n            onSuccess: (createdAlert) => {\n              handleSuccess(passedCrudType);\n\n              // 2. POST for child alert associated with this main alert (only if it exists)\n              // Child alerts only apply to threshold alerts, daily alerts don't have child\n              if (selectedAlert[AirQualityAlertKeys.alert_type] === AlertTypes.daily.id) return;\n\n              const placeholder = getAlertDefaultPlaceholder(alertTypeKey);\n              setSelectedAlert(placeholder);\n              setEditingAlert(placeholder);\n\n              if (!editingAlert[AirQualityAlertKeys.has_child_alert]) return;\n              const parent_alert_id = createdAlert[AirQualityAlertKeys.id];\n              if (parent_alert_id === null || parent_alert_id === undefined) return;\n\n              createAlertMutation.mutate(\n                {\n                  alertToCreate: formatChildAlertBody(editingAlert, parent_alert_id)\n                },\n                {\n                  onError: () => handleError(passedCrudType)\n                }\n              );\n            }\n          }\n        );\n        break;\n      }\n      case CrudTypes.edit: {\n        // 1. PUT to modify the main alert (always run)\n        const alert_id = selectedAlert[AirQualityAlertKeys.id];\n\n        editAlertMutation.mutate(\n          {\n            alertId: alert_id,\n            alertToEdit: removeChildAlertFromParentAlertBody(editingAlert)\n          },\n          {\n            onSuccess: () => {\n              handleSuccess(passedCrudType);\n\n              // 2. Editing for child alert associated with this main alert\n              // Child alerts only apply to threshold alerts, daily alerts don't have child\n              if (selectedAlert[AirQualityAlertKeys.alert_type] === AlertTypes.daily.id) return;\n\n              const child_alert_id = editingAlert[AirQualityAlertKeys.child_alert]?.[AirQualityAlertKeys.id];\n              // 2.1. There should NOT be child alert\n              // (If child alert existed before but now is removed, then trigger deletion)\n              if (!editingAlert[AirQualityAlertKeys.has_child_alert] &&\n                child_alert_id !== null && child_alert_id !== undefined\n              ) {\n                deleteAlertMutation.mutate(\n                  { alertId: child_alert_id },\n                  {\n                    onSuccess: () => handleSuccess(CrudTypes.delete),\n                    onError: () => handleError(CrudTypes.delete)\n                  }\n                );\n              }\n              // 2.2. There should be child alert\n              else {\n                const formattedChildAlert = formatChildAlertBody(editingAlert, alert_id);\n\n                // 2.2.1. If there is no child alert id before, create one\n                if (child_alert_id === null || child_alert_id === undefined) {\n                  createAlertMutation.mutate({\n                    alertId: alert_id,\n                    alertToCreate: formattedChildAlert\n                  });\n                }\n                // 2.2.2. Else, update that child alert\n                else {\n                  editAlertMutation.mutate({\n                    alertId: child_alert_id,\n                    alertToEdit: formattedChildAlert\n                  })\n                }\n              }\n            }\n          }\n        )\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  // Disable / Enable save button depends on context\n  useEffect(() => {\n    // startTime cannot be larger than endTime\n    if (editingAlert[AirQualityAlertKeys.time_range]?.[0] > editingAlert[AirQualityAlertKeys.time_range]?.[1]) {\n      setShouldDisableButton(true);\n      return;\n    }\n\n    switch (crudType) {\n      case CrudTypes.add:\n        const placeholder = getAlertDefaultPlaceholder(alertTypeKey);\n\n        if (editingAlert[AirQualityAlertKeys.sensor_id] === placeholder[AirQualityAlertKeys.sensor_id] ||\n          editingAlert[AirQualityAlertKeys.datatypekey] === placeholder[AirQualityAlertKeys.datatypekey]) {\n          if (alertTypeKey === AlertTypes.daily.id) {\n            setShouldDisableButton(editingAlert[AirQualityAlertKeys.minutespastmidnight] === placeholder[AirQualityAlertKeys.minutespastmidnight]);\n          } else {\n            setShouldDisableButton(true);\n          }\n        } else {\n          if (alertTypeKey === AlertTypes.daily.id) {\n            setShouldDisableButton(editingAlert[AirQualityAlertKeys.minutespastmidnight] === placeholder[AirQualityAlertKeys.minutespastmidnight]);\n          } else {\n            setShouldDisableButton(false);\n          }\n        }\n        break;\n\n      case CrudTypes.edit:\n        // Case empty editing value\n        let alertVal;\n        if (alertTypeKey === AlertTypes.daily.id) {\n          alertVal = editingAlert[AirQualityAlertKeys.minutespastmidnight]\n        } else {\n          alertVal = editingAlert[AirQualityAlertKeys.threshold_value]\n        }\n        const datatypeKeyVal = editingAlert[AirQualityAlertKeys.datatypekey];\n\n        if (!alertVal || alertVal === '' || !datatypeKeyVal || datatypeKeyVal === '') {\n          setShouldDisableButton(true);\n          break;\n        }\n\n        setShouldDisableButton(isEqual(selectedAlert, editingAlert));\n        break;\n      default:\n        setShouldDisableButton(false);\n        break;\n    }\n  }, [crudType, selectedAlert, editingAlert, alertTypeKey]);\n\n  const smallScreen = useMediaQuery((theme) => theme.breakpoints.down('md'));\n\n  const createAlertMutation = useCreateAlertMutation();\n  const editAlertMutation = useEditAlertMutation();\n  const deleteAlertMutation = useDeleteAlertMutation();\n\n  return (\n    <Dialog\n      open={openAlertModificationDialog}\n      onClose={handleClose}\n      aria-labelledby=\"alert-modification-dialog\"\n      maxWidth=\"md\"\n      fullWidth\n      fullScreen={smallScreen}\n    >\n      <DialogTitle id=\"alert-modification-dialog\">\n        {DialogData[crudType]?.title}\n      </DialogTitle>\n\n      <DialogContent>\n        <AlertPropertyComponents\n          alertTypeKey={alertTypeKey}\n          crudType={crudType}\n        />\n      </DialogContent>\n      <DialogActions sx={{\n        justifyContent: \"space-between\"\n      }}>\n        {\n          crudType === CrudTypes.edit ? (\n            <AlertDeletionDialog\n              onConfirmedDelete={() => {\n                // Only need one API call to delete the main alert\n                // any associated child alert will be automatically deleted by database (cascade delete)\n                deleteAlertMutation.mutate(\n                  { alertId: selectedAlert.id },\n                  {\n                    onSuccess: () => handleSuccess(CrudTypes.delete),\n                    onError: () => handleError(CrudTypes.delete)\n                  }\n                );\n              }}\n            />\n          ) : null\n        }\n\n        <Stack direction=\"row\" width=\"100%\" justifyContent=\"end\">\n          <Button\n            onClick={handleClose}\n            sx={{\n              color: theme.palette.text.secondary\n            }}\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={() => {\n              handleAlertModification({ passedCrudType: crudType });\n            }}\n            color=\"primary\"\n            disabled={shouldDisableButton}\n          >\n            Save Edit\n          </Button>\n        </Stack>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default AlertModificationDialog;\n\n\n","import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useContext } from \"react\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\nimport { UserContext } from \"../../ContextProviders/UserContext\";\nimport { GeneralAPIendpoints, RESTmethods } from \"../../API/Utils\";\nimport { addChildToAlerts } from \"../../Components/AirQuality/AirQualityAlerts/AlertUtils\";\nimport { fetchDataFromURL } from \"../../API/ApiFetch\";\nimport { getApiUrl } from \"../../API/ApiUrls\";\n\nexport const useCreateAlertMutation = () => {\n    const queryClient = useQueryClient();\n    const { currentSchoolID } = useContext(DashboardContext);\n    const { user } = useContext(UserContext);\n\n    return useMutation({\n        mutationFn: async ({ alertToCreate }) => {\n            const url = getApiUrl({\n                paths: [GeneralAPIendpoints.alerts, currentSchoolID]\n            });\n\n            return fetchDataFromURL({\n                url,\n                restMethod: RESTmethods.POST,\n                body: alertToCreate\n            });\n        },\n        onSuccess: (createdAlert) => {\n            queryClient.setQueryData(\n                [GeneralAPIendpoints.alerts, currentSchoolID, user.username || user.email],\n                (old = []) => addChildToAlerts([...old, createdAlert])\n            );\n        }\n    });\n};","import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useContext } from \"react\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\nimport { UserContext } from \"../../ContextProviders/UserContext\";\nimport { getApiUrl } from \"../../API/ApiUrls\";\nimport { GeneralAPIendpoints, RESTmethods } from \"../../API/Utils\";\nimport { fetchDataFromURL } from \"../../API/ApiFetch\";\nimport { addChildToAlerts, AirQualityAlertKeys } from \"../../Components/AirQuality/AirQualityAlerts/AlertUtils\";\n\nexport const useDeleteAlertMutation = () => {\n    const queryClient = useQueryClient();\n    const { currentSchoolID } = useContext(DashboardContext);\n    const { user } = useContext(UserContext);\n\n    return useMutation({\n        mutationFn: async ({ alertId }) => {\n            const url = getApiUrl({\n                paths: [GeneralAPIendpoints.alerts, currentSchoolID, alertId]\n            });\n            return fetchDataFromURL({ url, restMethod: RESTmethods.DELETE });\n        },\n        onSuccess: (_, { alertId }) => {\n            queryClient.setQueryData(\n                [GeneralAPIendpoints.alerts, currentSchoolID, user.username || user.email],\n                (old = []) => {\n                    const updated = old.filter(\n                        alert => alert[AirQualityAlertKeys.id] !== alertId\n                    );\n                    return addChildToAlerts(updated);\n                }\n            );\n        }\n    });\n};","import { useContext, useState } from 'react';\nimport { Box, Button, IconButton, Stack, Table, TableBody, TableCell, TableHead, TableRow, Tooltip, Alert, Grow, Switch, Chip } from '@mui/material';\nimport EditIcon from '@mui/icons-material/Edit';\nimport AddAlarmIcon from '@mui/icons-material/AddAlarm';\nimport { useTheme } from '@mui/material';\nimport AlertTypes from './AlertTypes';\nimport { ThresholdAlertTypes } from './AlertTypes';\nimport { isValidArray } from '../../../Utils/UtilFunctions';\nimport AlertModificationDialog from './AlertModificationDialog/AlertModificationDialog';\nimport { AirQualityAlertKeys, CrudTypes, getAlertDefaultPlaceholder, SharedColumnHeader } from './AlertUtils';\nimport { TransitionGroup } from 'react-transition-group';\nimport { SnackbarMetadata } from '../../../Utils/SnackbarMetadata';\nimport { useSnackbar } from 'notistack';\nimport { UserRoles } from '../../Account/Utils';\nimport { DataTypes } from '../../../Utils/AirQuality/DataTypes';\nimport { DAYS_OF_WEEK } from './AlertModificationDialog/AlertPropertyComponents/DAYS_OF_WEEK';\nimport { returnHoursFromMinutesPastMidnight } from '../../TimeRange/TimeRangeUtils';\nimport { useEditAlertMutation } from '../../../hooks/alerts/useEditAlertMutation';\nimport { AirQualityAlertContext } from '../../../ContextProviders/AirQualityAlertContext';\n\nconst returnDaysOfWeekString = (days_of_week) => {\n  if (!days_of_week || !isValidArray(days_of_week)) return \"N/A\";\n\n  // Case where all days are selected\n  if (days_of_week.length === DAYS_OF_WEEK.length) return \"Everyday\";\n\n  // Check if two days are missing and if both are weekend days\n  const missingDays = DAYS_OF_WEEK.filter(d => !days_of_week.includes(d.value));\n  if (missingDays.length === 2 && missingDays.every(d => [5, 6].includes(d.value))) {\n    return \"Only weekdays\";\n  }\n\n  // Default case: map the selected days to their short labels\n  return days_of_week\n    .map(day => DAYS_OF_WEEK.find(d => d.value === day)?.label.slice(0, 2))\n    .join(', ');\n};\n\nconst returnCreatedByString = (owner_role, self_is_owner) => {\n  if (self_is_owner === true) return \"You\";\n\n  if (owner_role) return UserRoles[owner_role].name;\n  else return \"N/A\";\n}\n\nconst returnAlertNotModifiableString = (owner_role, is_allowed_to_modify) => {\n  if (is_allowed_to_modify) return \"\";\n\n  if (owner_role && UserRoles[owner_role]) {\n    return `${UserRoles[owner_role].name} added your email to this school-wide alert. For edit or removal, please reach out to ${UserRoles[owner_role].name}.`;\n  }\n};\n\nconst AlertsTable = (props) => {\n  const { selectedAlert, setSelectedAlert } = useContext(AirQualityAlertContext);\n  const { enqueueSnackbar } = useSnackbar()\n  const { alertTypeKey, alertsForTable } = props;\n  const theme = useTheme();\n\n  const [openAlertModificationDialog, setOpenAlertModificationDialog] = useState(false);\n  const [crudType, setCrudType] = useState(null);\n\n  const handleModifyClick = ({ alert, crudType }) => {\n    setSelectedAlert(alert);\n    setCrudType(crudType);\n    setOpenAlertModificationDialog(true);\n  };\n\n  const handleClose = () => {\n    setOpenAlertModificationDialog(false);\n    setSelectedAlert(getAlertDefaultPlaceholder(alertTypeKey));\n  }\n\n  const editAlertMutation = useEditAlertMutation();\n  const handleAlertEnableToggling = (alert) => {\n    if (alert[AirQualityAlertKeys.is_allowed_to_modify] === false) {\n      enqueueSnackbar(\n        returnAlertNotModifiableString(\n          alert[AirQualityAlertKeys.owner_role],\n          alert[AirQualityAlertKeys.is_allowed_to_modify]\n        ),\n        SnackbarMetadata.warning\n      );\n      return;\n    }\n\n    const currentIsEnabled = alert[AirQualityAlertKeys.is_enabled];\n    const newIsEnabled = !currentIsEnabled;\n\n    // Only need 1 API to modify isEnabled of the main alert\n    // any associated child alert doesn't need to update its `isEnabled` as child alert won't fire unless its parent alert fired before\n    editAlertMutation.mutate(\n      {\n        alertId: alert[AirQualityAlertKeys.id],\n        alertToEdit: {\n          ...alert,\n          [AirQualityAlertKeys.is_enabled]: newIsEnabled\n        }\n      },\n      {\n        onSuccess: () =>\n          enqueueSnackbar(\n            `This alert is now ${newIsEnabled ? \"enabled\" : \"disabled\"}`,\n            SnackbarMetadata.success\n          ),\n        onError: (error) =>\n          enqueueSnackbar(\n            error?.message || `There was an error ${newIsEnabled ? \"enabling\" : \"disabling\"} this alert, try again!`,\n            SnackbarMetadata.error\n          )\n      }\n    );\n  }\n\n  return (\n    <>\n      <Stack spacing={2} alignItems=\"center\">\n        <Box sx={{ width: \"100%\", overflowX: 'auto' }}>\n          {\n            isValidArray(alertsForTable) ?\n              (\n                <Table size=\"small\" sx={{ my: 1 }}>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell sx={{ px: 0 }} />\n\n                      <TableCell>\n                        {SharedColumnHeader.location}\n                      </TableCell>\n\n                      <TableCell>\n                        {SharedColumnHeader.dataType}\n                      </TableCell>\n\n                      <TableCell>\n                        {SharedColumnHeader.selectedDaysOfWeek}\n                      </TableCell>\n\n                      <TableCell>\n                        {AlertTypes[alertTypeKey]?.tableColumnHeader || \"\"}\n                      </TableCell>\n\n                      <TableCell>\n                        {SharedColumnHeader.createdBy}\n                      </TableCell>\n                    </TableRow>\n                  </TableHead>\n\n                  <TransitionGroup component={TableBody}>\n                    {isValidArray(alertsForTable) ? alertsForTable.map((alert, index) => (\n                      <Grow key={index}>\n                        <TableRow\n                          sx={{\n                            background: alert[AirQualityAlertKeys.id] === selectedAlert[AirQualityAlertKeys.id] && theme.palette.background.NYUpurpleLight,\n                            textDecoration: alert[AirQualityAlertKeys.is_enabled] === false ? \"line-through\" : \"none\"\n                          }}\n                        >\n                          <TableCell sx={{ px: 0 }}>\n                            <Tooltip\n                              title={\n                                alert[AirQualityAlertKeys.is_allowed_to_modify] === false\n                                  ? returnAlertNotModifiableString(alert[AirQualityAlertKeys.owner_role], alert[AirQualityAlertKeys.is_allowed_to_modify])\n                                  : `Click to ${alert[AirQualityAlertKeys.is_enabled] ? \"disable\" : \"enable\"} alert`\n                              }\n                            >\n                              {/* Wrap <Switch> in a <span> so that <Tooltip> will still display even if it's disabled */}\n                              <span\n                                onClick={() => {\n                                  handleAlertEnableToggling(alert)\n                                }}\n                                style={{ display: 'inline-block' }}\n                              >\n                                <Switch\n                                  size=\"small\"\n                                  disabled={alert[AirQualityAlertKeys.is_allowed_to_modify] === false}\n                                  checked={alert[AirQualityAlertKeys.is_enabled]}\n                                />\n                              </span>\n                            </Tooltip>\n\n                            <Tooltip\n                              title={\n                                alert[AirQualityAlertKeys.is_allowed_to_modify] === false\n                                  ? returnAlertNotModifiableString(alert[AirQualityAlertKeys.owner_role], alert[AirQualityAlertKeys.is_allowed_to_modify])\n                                  : `Edit alert`\n                              }\n                            >\n                              <span\n                                onClick={() => {\n                                  if (alert[AirQualityAlertKeys.is_allowed_to_modify] === false) {\n                                    enqueueSnackbar(\n                                      returnAlertNotModifiableString(alert[AirQualityAlertKeys.owner_role], alert[AirQualityAlertKeys.is_allowed_to_modify]),\n                                      SnackbarMetadata.warning\n                                    );\n                                    return;\n                                  }\n                                  handleModifyClick({ alert, crudType: CrudTypes.edit })\n                                }}\n                                style={{ display: 'inline-block' }}\n                              >\n                                <IconButton\n                                  aria-label=\"edit\"\n                                  size=\"small\"\n                                  disabled={alert[AirQualityAlertKeys.is_allowed_to_modify] === false}\n                                  sx={{ \"&:hover,:focus\": { color: theme.palette.primary.main } }}\n                                >\n                                  <EditIcon />\n                                </IconButton>\n                              </span>\n                            </Tooltip>\n                          </TableCell>\n\n                          <TableCell sx={{ textTransform: 'capitalize' }}>\n                            {alert[AirQualityAlertKeys.location_short]}\n                          </TableCell>\n\n                          <TableCell>\n                            {\n                              Object.keys(DataTypes)\n                                .filter(key => key === alert[AirQualityAlertKeys.datatypekey])\n                                .map(key => DataTypes[key].name_title)[0]\n                            }\n                          </TableCell>\n\n                          <TableCell>\n                            {returnDaysOfWeekString(alert[AirQualityAlertKeys.days_of_week])}\n                          </TableCell>\n\n                          {alertTypeKey === AlertTypes.threshold.id ? (\n                            <TableCell>\n                              {ThresholdAlertTypes[alert[AirQualityAlertKeys.alert_type]].sign} {alert[AirQualityAlertKeys.threshold_value]}\n                              &nbsp;\n                              {\n                                Object.keys(DataTypes)\n                                  .filter(key => key === alert[AirQualityAlertKeys.datatypekey])\n                                  .map(key => DataTypes[key].unit)[0]\n                              }\n                            </TableCell>\n                          ) : null}\n\n                          {alertTypeKey === AlertTypes.daily.id ? (\n                            <TableCell>\n                              {returnHoursFromMinutesPastMidnight(alert[AirQualityAlertKeys.minutespastmidnight])}\n                            </TableCell>\n                          ) : null}\n\n                          <TableCell>\n                            <Chip\n                              label={\n                                returnCreatedByString(\n                                  alert[AirQualityAlertKeys.owner_role],\n                                  alert[AirQualityAlertKeys.self_is_owner]\n                                )\n                              }\n                              size='small'\n                            />\n                          </TableCell>\n                        </TableRow>\n                      </Grow>\n                    )) : null\n                    }\n                  </TransitionGroup>\n                </Table>\n              ) : (\n                <Alert\n                  severity='warning'\n                  sx={{\n                    mt: 2\n                  }}>\n                  No {AlertTypes[alertTypeKey].name.toLowerCase()} alert has been set up\n                </Alert>\n              )\n          }\n        </Box>\n\n        <Button\n          variant=\"outlined\"\n          startIcon={<AddAlarmIcon />}\n          fullWidth\n          sx={{ maxWidth: \"sm\", textTransform: 'uppercase' }}\n          onClick={() => handleModifyClick({\n            alert: getAlertDefaultPlaceholder(alertTypeKey), crudType: CrudTypes.add\n          })}\n        >\n          Add Alert\n        </Button>\n      </Stack >\n\n      <AlertModificationDialog\n        alertTypeKey={alertTypeKey}\n        crudType={crudType}\n        openAlertModificationDialog={openAlertModificationDialog}\n        handleClose={handleClose}\n      />\n    </>\n  );\n};\n\nexport default AlertsTable;","import { useContext, useState } from 'react';\nimport { Box, Tab, useMediaQuery } from '@mui/material';\n\nimport StyledTabs from '../../StyledTabs';\nimport AlertsTable from './AlertsTable';\n\nimport AlertTypes from './AlertTypes';\nimport { isValidArray } from '../../../Utils/UtilFunctions';\nimport { AirQualityAlertKeys, getAlertDefaultPlaceholder } from './AlertUtils';\nimport { AirQualityAlertContext } from '../../../ContextProviders/AirQualityAlertContext';\nimport { useAlerts } from '../../../hooks/alerts/useAlerts';\n\nfunction AlertTab(props) {\n  const { children, value, index, alertType, alertsArray, ...other } = props;\n\n  return (\n    <Box\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`alert-tabpanel-${alertType.id}`}\n      aria-labelledby={`alert-tab-${alertType.id}`}\n      width=\"100%\"\n      {...other}\n    >\n      <AlertsTable\n        alertTypeKey={alertType.id}\n        alertsForTable={alertsArray}\n      />\n    </Box>\n  );\n}\n\nexport default function AlertsTabs() {\n  const { setSelectedAlert } = useContext(AirQualityAlertContext);\n  const { data: alerts } = useAlerts();\n\n  const smallScreen = useMediaQuery((theme) => theme.breakpoints.down('sm'));\n  const [currentTab, setCurrentTab] = useState(0);\n  const handleTabChange = (_, newVal) => {\n    setCurrentTab(newVal);\n    setSelectedAlert(\n      getAlertDefaultPlaceholder(AlertTypes[Object.keys(AlertTypes)?.[newVal]]?.id)\n    );\n  };\n\n  // Helper function to return filered alert:\n  // - based on alert_type (threshold or daily, depends on which alert tab is visible)\n  // - only return alert that is not child to another alert\n  const returnFilteredAlerts = (alertTypeKey) => {\n    const filteredAlerts = alerts.filter((alert) => {\n      if (!alert) return null;\n\n      const alertType = alert[AirQualityAlertKeys.alert_type]?.toLowerCase();\n      const parentAlertId = alert[AirQualityAlertKeys.parent_alert_id];\n\n      if (alertType.includes(alertTypeKey) && (parentAlertId === null || parentAlertId === undefined)) return alert;\n      else return null;\n    });\n\n    const alertsLength = isValidArray(filteredAlerts) ? filteredAlerts.length : \"0\";\n\n    return {\n      array: filteredAlerts,\n      alertsLength\n    }\n  }\n\n  return (\n    <Box>\n      <StyledTabs\n        value={currentTab}\n        onChange={handleTabChange}\n        variant={smallScreen ? 'fullWidth' : 'standard'}\n        smallFontSize=\"0.825rem\"\n      >\n        {Object.values(AlertTypes).map((type) => {\n          const filteredAlerts = returnFilteredAlerts(type.id);\n          return (\n            <Tab\n              key={type.id}\n              value={type.index}\n              icon={type.icon}\n              label={`${type.name} (${filteredAlerts?.alertsLength})`}\n              iconPosition=\"start\"\n              sx={{ py: 0 }}\n            />\n          )\n        }\n        )}\n      </StyledTabs>\n\n      {Object.values(AlertTypes).map((type) => {\n        const filteredAlerts = returnFilteredAlerts(type.id);\n        return (\n          <AlertTab\n            key={type.id}\n            alertType={type}\n            value={currentTab}\n            index={type.index}\n            alertsArray={filteredAlerts.array}\n          />\n        )\n      }\n      )}\n    </Box>\n  );\n}\n","import { useContext } from \"react\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\nimport { UserContext } from \"../../ContextProviders/UserContext\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { fetchDataFromURL } from \"../../API/ApiFetch\";\nimport { GeneralAPIendpoints } from \"../../API/Utils\";\nimport { isValidArray } from \"../../Utils/UtilFunctions\";\nimport { addChildToAlerts } from \"../../Components/AirQuality/AirQualityAlerts/AlertUtils\";\nimport { getApiUrl } from \"../../API/ApiUrls\";\n\nexport const useAlerts = () => {\n    const { currentSchoolID } = useContext(DashboardContext);\n    const { authenticationState, user } = useContext(UserContext);\n\n    const queryResult = useQuery({\n        queryKey: [GeneralAPIendpoints.alerts, currentSchoolID, user.username || user.email],\n        queryFn: async () => {\n\n            const data = await fetchDataFromURL({\n                url: getApiUrl({\n                    paths: [GeneralAPIendpoints.alerts, currentSchoolID]\n                }),\n            });\n\n            if (!isValidArray(data)) return [];\n            return addChildToAlerts(data);\n        },\n        enabled: !!currentSchoolID && !!authenticationState.authenticated,\n        staleTime: 0,\n        retry: false,\n        refetchOnWindowFocus: false,\n    });\n\n    // Always return at least an empty array for `data`\n    return {\n        ...queryResult,\n        data: queryResult.data ?? [],\n    };\n};","import { Stack, Typography } from '@mui/material';\nimport NotificationImportantIcon from '@mui/icons-material/NotificationImportant';\nimport CustomDialog from '../../CustomDialog/CustomDialog';\nimport EmailsInput from './EmailsInput';\nimport AlertsTabs from './AlertsTabs';\nimport useLoginHandler from '../../Account/useLoginHandler';\nimport { useContext } from 'react';\nimport { UserContext } from '../../../ContextProviders/UserContext';\nimport { UserRoles } from '../../Account/Utils';\nimport { AirQualityAlertProvider } from '../../../ContextProviders/AirQualityAlertContext';\n\nexport default function AirQualityAlerts({ onButtonClick }) {\n  const { handleRestrictedAccess } = useLoginHandler(onButtonClick);\n\n  const { user } = useContext(UserContext);\n\n  const isModifiable = [UserRoles.admin.id, UserRoles.school.id].includes(user?.user_role);\n\n  return (\n    <CustomDialog\n      buttonIcon={<NotificationImportantIcon sx={{ fontSize: '1rem' }} />}\n      buttonLabel=\"Alerts\"\n      dialogTitle=\"Air quality alerts\"\n      dialogOpenHandler={handleRestrictedAccess}\n    >\n      <Stack width=\"100%\" spacing={isModifiable ? 5 : 2}>\n        <AirQualityAlertProvider>\n          <AlertsTabs />\n        </AirQualityAlertProvider>\n\n        {isModifiable ? <EmailsInput /> : (\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            Alerts will be sent to your email address: <b>{user?.email}</b>\n          </Typography>\n        )}\n      </Stack>\n    </CustomDialog>\n  );\n}\n","import { useEffect, useRef, useCallback, useContext, useState } from \"react\";\nimport { AppRoutes } from \"../../Utils/AppRoutes\";\nimport { LoginTypes } from \"../Account/Utils\";\nimport { SnackbarMetadata } from '../../Utils/SnackbarMetadata';\nimport { UserContext } from \"../../ContextProviders/UserContext\";\nimport EmailVerificationDialog from \"./EmailVerificationDialog\";\nimport { useSnackbar } from \"notistack\";\n\nconst LoginPopupHandler = ({ onLoginSuccess, children }) => {\n    const popupRef = useRef(null);\n    const { enqueueSnackbar } = useSnackbar()\n    const { setAuthenticationState, setUser } = useContext(UserContext);\n\n    const [showVerificationDialog, setShowVerificationDialog] = useState(false);\n    const [email, setEmail] = useState(\"\");\n\n    const openLoginPopup = useCallback(() => {\n        const width = 500;\n        const height = 600;\n        const left = (window.screen.width - width) / 2;\n        const top = (window.screen.height - height) / 2;\n\n        const popup = window.open(\n            AppRoutes.login,\n            \"Login\",\n            `width=${width},height=${height},top=${top},left=${left}`\n        );\n\n        if (popup) {\n            popup.focus();\n            popupRef.current = popup;\n\n            const intervalId = setInterval(() => {\n                if (popup.closed) {\n                    clearInterval(intervalId);\n                    window.removeEventListener(\"message\", handleMessage);\n                    popupRef.current = null;\n                }\n            }, 500);\n        } else {\n            alert(\"Popup blocked. Please enable popups for login.\");\n        }\n    }, []);\n\n    const handleMessage = useCallback(\n        (event) => {\n            if (event.origin === window.location.origin && event.data.type === LoginTypes.password) {\n                if (event.data.success) {\n                    const user = event.data.user;\n\n                    setAuthenticationState({\n                        checkedAuthentication: true,\n                        authenticated: true,\n                    });\n                    setUser(user);\n\n                    if (user.message) {\n                        enqueueSnackbar(user.message, SnackbarMetadata.success);\n                    }\n\n                    if (user.is_verified === false) {\n                        setShowVerificationDialog(true);\n                        setEmail(user.email);\n                    }\n\n                    onLoginSuccess?.();\n                }\n            }\n        },\n        [onLoginSuccess]\n    );\n\n    useEffect(() => {\n        window.addEventListener(\"message\", handleMessage);\n        return () => {\n            window.removeEventListener(\"message\", handleMessage);\n        };\n    }, [handleMessage]);\n\n    return (\n        <>\n            {children({\n                openLoginPopup,\n            })}\n            <EmailVerificationDialog\n                open={showVerificationDialog}\n                email={email}\n            />\n        </>\n    );\n};\n\nexport default LoginPopupHandler;\n","import { Grid } from \"@mui/material\";\nimport ScreenDropDownMenu from \"../../Components/AirQuality/AirQualityScreen/ScreenDropDownMenu\";\nimport DatasetDownloadDialog from \"../../Components/DatasetDownload/DatasetDownloadDialog\";\nimport AirQualityAlerts from \"../../Components/AirQuality/AirQualityAlerts/AirQualityAlert\";\nimport LoginPopupHandler from \"../../Components/Account/LoginPopupHandler\";\nimport useLoginHandler from \"../../Components/Account/useLoginHandler\";\nimport { SnackbarMetadata } from \"../../Utils/SnackbarMetadata\";\nimport { AirQualityAlertProvider } from \"../../ContextProviders/AirQualityAlertContext\";\nimport { useSnackbar } from \"notistack\";\n\nconst ProjectReservedArea = () => {\n    const { loggedIn } = useLoginHandler();\n    const { enqueueSnackbar } = useSnackbar()\n\n    const handleLoginSuccess = () => {\n        enqueueSnackbar(\"You can now access Dataset and Alerts.\", {\n            variant: SnackbarMetadata.success.variant,\n            duration: SnackbarMetadata.success.duration * 2\n        });\n    };\n\n    return (\n        <LoginPopupHandler\n            onLoginSuccess={handleLoginSuccess}\n        >\n            {({ openLoginPopup }) => (\n                <Grid container spacing={1} justifyContent=\"center\" alignItems=\"center\">\n                    <Grid item>\n                        {/* Use this code block if TV screen should be only for logged in users even for publicly available institutions */}\n                        {/* <ScreenDropDownMenu onButtonClick={loggedIn ? null : openLoginPopup} /> */}\n\n                        {/* For now, it doesn't require login */}\n                        <ScreenDropDownMenu onButtonClick={null} />\n                    </Grid>\n                    <Grid item>\n                        <DatasetDownloadDialog onButtonClick={loggedIn ? null : openLoginPopup} />\n                    </Grid>\n                    <Grid item>\n                        <AirQualityAlertProvider>\n                            <AirQualityAlerts onButtonClick={loggedIn ? null : openLoginPopup} />\n                        </AirQualityAlertProvider>\n                    </Grid>\n                </Grid>\n            )}\n        </LoginPopupHandler>\n    );\n};\n\nexport default ProjectReservedArea;\n","import { Chip, Tooltip, Skeleton } from '@mui/material';\n\n// Custom Chip component to display metadata\nconst CustomChip = (props) => {\n    const { tooltipTitle, label, ...otherProps } = props;\n\n    const chip = (\n        <Chip\n            size=\"small\"\n            label={label || <Skeleton variant=\"text\" sx={{ minWidth: '5rem' }} />}\n            sx={{\n                userSelect: 'text',\n                '& .MuiChip-label': {\n                    userSelect: 'text'\n                }\n            }}\n            {...otherProps}\n        />\n    );\n\n\n    return tooltipTitle ? (\n        <Tooltip title={tooltipTitle} enterDelay={0} leaveDelay={200}>\n            {chip}\n        </Tooltip>\n    ) : chip;\n}\n\nexport default CustomChip;","import { useContext, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport { Box, Menu, MenuItem, MenuList } from \"@mui/material\";\nimport CustomChip from \"./CustomChip\";\n\nimport PlaceIcon from '@mui/icons-material/Place';\nimport { LocalStorage } from \"../Utils/LocalStorage\";\nimport { AppRoutes } from \"../Utils/AppRoutes\";\n\nimport * as Tracking from '../Utils/Tracking';\n\nimport { DashboardContext } from \"../ContextProviders/DashboardContext\";\nimport { UserContext } from \"../ContextProviders/UserContext\";\n\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\nimport ArrowDropUpIcon from '@mui/icons-material/ArrowDropUp';\nimport useSchoolMetadata from \"../hooks/useSchoolMetadata\";\n\nconst SchoolSelector = () => {\n  const { currentSchoolID } = useContext(DashboardContext);\n  const { data: schoolMetadata } = useSchoolMetadata();\n  const { user } = useContext(UserContext);\n  const navigate = useNavigate();\n\n  const [anchorEl, setAnchorEl] = useState(null);\n  const open = Boolean(anchorEl);\n  const handleClick = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleItemSelect = (newSchoolID) => () => {\n    if (currentSchoolID !== newSchoolID) {\n      localStorage.setItem(LocalStorage.schoolID, newSchoolID)\n\n      Tracking.sendEventAnalytics(Tracking.Events.internalNavigation,\n        {\n          origin_school: currentSchoolID,\n          destination_school_id: newSchoolID,\n          origin_id: 'school_selector'\n        });\n\n      navigate(`${AppRoutes.dashboard}/${newSchoolID}`)\n    }\n    handleClose();\n  };\n\n  if (!schoolMetadata) return;\n\n  // If there is only one school, return a Chip displaying the name of that school\n  if (!Array.isArray(user.allowedSchools) || user.allowedSchools.length <= 1)\n    return (\n      <CustomChip\n        icon={<PlaceIcon />}\n        label={schoolMetadata.name || \"No School Name Given\"}\n        tooltipTitle={\"School\"}\n      />\n    );\n\n  // Else, display a drop down menu that allows choosing between different schools\n  return (\n    <>\n      <CustomChip\n        icon={<PlaceIcon />}\n        label={returnChipLabel(schoolMetadata.name, open)}\n        tooltipTitle={\"Click to Select School\"}\n        clickable\n        onClick={handleClick}\n        aria-controls={open ? 'basic-menu' : undefined}\n        aria-haspopup=\"true\"\n        aria-expanded={open ? 'true' : undefined}\n      />\n      <Menu\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleClose}\n        MenuListProps={{\n          'aria-labelledby': 'basic-button',\n        }}\n      >\n        <MenuList dense>\n          {user.allowedSchools.map((school, index) => (\n            <MenuItem\n              key={index}\n              onClick={handleItemSelect(school.school_id)}\n            >\n              {school.name}\n            </MenuItem>\n          ))}\n        </MenuList>\n      </Menu>\n    </>\n  );\n};\n\nconst returnChipLabel = (name, open) => {\n  return (\n    <Box sx={{\n      '& svg': {\n        fontSize: \"1rem\", verticalAlign: \"sub\", marginLeft: \"0.25rem\"\n      }\n    }\n    }>\n      {name || \"Loading...\"}\n      {open ? (\n        <ArrowDropUpIcon />\n      ) : (\n        <ArrowDropDownIcon />\n      )}\n    </Box>\n  );\n};\n\nexport default SchoolSelector;","// import { MetadataContext } from \"../../ContextProviders/MetadataContext\";\nimport { Grid } from \"@mui/material\";\n\nimport SchoolSelector from \"../../Components/SchoolSelector\";\nimport CustomChip from \"../../Components/CustomChip\";\n\nimport PersonIcon from '@mui/icons-material/Person';\nimport useSchoolMetadata from \"../../hooks/useSchoolMetadata\";\n// import BarChartIcon from '@mui/icons-material/BarChart';\n// import CommentIcon from '@mui/icons-material/Comment';\n// import * as Tracking from '../../Utils/Tracking';\n// import { scrollToSection } from \"../../Components/Header/MenuItemAsNavLink\";\n// import sectionData from '../../section_data.json';\n// import { HYVOR_PAGE_NAME, NYUAD } from \"../../Utils/GlobalVariables\";\n\n// Temporarily not using HyvorTalk comment anymore\n// const GridOfMetadataChips = ({ displayCommentSection }) => {\n\n\nconst GridOfMetadataChips = () => {\n    const { data: schoolMetadata } = useSchoolMetadata();\n\n    if (!schoolMetadata) return;\n\n    // Temporarily not using HyvorTalk comment anymore\n    // const { commentCounts, fetchCommentCounts, setCommentCounts } = useContext(MetadataContext);\n    // Fetch comment count for NYUAD\n    // useEffect(() => {\n    //     if (!schoolMetadata) return;\n\n    //     const isNYUAD = schoolMetadata.school_id === NYUAD;\n    //     if (isNYUAD && !commentCounts) {\n    //         fetchCommentCounts().then((data) => {\n    //             setCommentCounts(data);\n    //         });\n    //     }\n    // }, [schoolMetadata])\n\n    return (\n        <Grid container item spacing={1} justifyContent=\"center\">\n            <Grid item>\n                <SchoolSelector />\n            </Grid>\n\n            <Grid item>\n                <CustomChip\n                    icon={<PersonIcon />}\n                    label={`${schoolMetadata.contactPerson} <${schoolMetadata.contactEmail}>`}\n                    tooltipTitle=\"Main Contact\"\n                    component=\"a\"\n                    href={`mailto:${schoolMetadata?.contactEmail}`}\n                    clickable\n                />\n            </Grid>\n\n            {/* Temporarily not using HyvorTalk comment anymore\n            {(displayCommentSection === true && commentCounts !== null) ?\n                (\n                    <Grid item>\n                        <CustomChip\n                            icon={<CommentIcon />}\n                            label={`${commentCounts[HYVOR_PAGE_NAME]} Comment${commentCounts[HYVOR_PAGE_NAME] > 1 ? \"s\" : \"\"}`}\n                            tooltipTitle=\"Number of Comments\"\n                            onClick={() => {\n                                scrollToSection(sectionData.commentSection.id);\n                                Tracking.sendEventAnalytics(Tracking.Events.internalNavigation,\n                                    {\n                                        destination_id: sectionData.commentSection.id,\n                                        destination_label: sectionData.commentSection.toString(),\n                                        origin_id: 'chip'\n                                    })\n                            }}\n                        />\n                    </Grid>\n                ) : null} */}\n        </Grid>\n    )\n}\n\nexport default GridOfMetadataChips;","import { Skeleton, Typography, useTheme } from \"@mui/material\";\nimport parse from 'html-react-parser';\nimport { replacePlainHTMLWithMuiComponents } from \"../../Utils/UtilFunctions\";\nimport useSchoolMetadata from \"../../hooks/useSchoolMetadata\";\n\nconst ProjectDescription = () => {\n    const theme = useTheme();\n    const { data: schoolMetadata } = useSchoolMetadata();\n\n    if (schoolMetadata) return (\n        <Typography\n            component=\"div\"\n            variant=\"body1\"\n            color=\"text.secondary\"\n            sx={{\n                textAlign: 'justify', pb: 2, mb: 0, \"& table *\": {\n                    color: `${theme.palette.text.secondary}`\n                }\n            }}\n            gutterBottom\n        >\n            {\n                parse(schoolMetadata.description || '', {\n                    replace: replacePlainHTMLWithMuiComponents,\n                })\n            }\n        </Typography>\n    )\n    else {\n        return (\n            Array.from({ length: 3 }).map((_, index) => (\n                <Skeleton key={index} variant='text' />\n            ))\n        )\n    }\n}\n\nexport default ProjectDescription;","import { Stack, Button } from \"@mui/material\";\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { useContext } from \"react\";\nimport { DashboardContext } from \"../../ContextProviders/DashboardContext\";\n\nconst LoadMoreButton = () => {\n    const { loadMoreCharts, setLoadMoreCharts } = useContext(DashboardContext);\n\n    if (loadMoreCharts === false) {\n        return (\n            <Stack sx={{ mt: 6, mx: 'auto', maxWidth: 'sm' }}>\n                <Button\n                    variant=\"contained\"\n                    onClick={() => {\n                        setLoadMoreCharts(true);\n                    }}\n                >\n                    <KeyboardArrowDownIcon sx={{ fontSize: '1rem' }} />&nbsp;Load More Charts\n                </Button>\n            </Stack>\n        )\n    }\n    else {\n        return null;\n    }\n}\n\nexport default LoadMoreButton;","import { useContext } from 'react';\nimport ChartComponentWrapper from '../../Graphs/ChartComponentWrapper';\nimport UppercaseTitle from '../../Components/UppercaseTitle';\n\nimport { Box, Container, Divider, Grid } from '@mui/material';\n\nimport ThemePreferences from '../../Themes/ThemePreferences';\n\nimport AirQualityIndexLegendQuickGlance from '../../Components/AirQuality/AirQualityIndexLegendQuickGlance';\n\nimport sectionData from '../../section_data.json';\n\nimport FullWidthBox from '../../Components/FullWidthBox';\n\nimport CurrentAQIGrid from '../../Components/AirQuality/CurrentAQI/CurrentAQIGrid';\n\nimport { DashboardContext } from '../../ContextProviders/DashboardContext';\nimport { PreferenceContext } from '../../ContextProviders/PreferenceContext';\n\nimport AQIexplanation from '../../Components/AirQuality/AQIexplanation';\nimport { AxesPickerProvider } from '../../ContextProviders/AxesPickerContext';\nimport { NUMBER_OF_CHARTS_TO_LOAD_INITIALLY } from '../../Utils/GlobalVariables';\n\nimport ProjectReservedArea from './ProjectReservedArea';\nimport GridOfMetadataChips from './GridOfMetadataChips';\nimport ProjectDescription from './ProjectDescription';\nimport LoadMoreButton from './LoadMoreButton';\nimport CurrentAQIMapWithGrid from '../../Components/AirQuality/CurrentAQI/CurrentAQIMapWithGrid';\nimport { ChartAPIendpointsOrder } from '../../API/Utils';\nimport useCurrentSensorsData from '../../hooks/useCurrentSensorsData';\nimport useSchoolMetadata from '../../hooks/useSchoolMetadata';\n\n// Temporarily not using HyvorTalk comment anymore\n// import CommentSection from '../../Components/CommentSection';\n// import { HYVOR_PAGE_NAME } from '../../Utils/GlobalVariables';\n\nconst Project = () => {\n  const { currentSchoolID, loadMoreCharts } = useContext(DashboardContext);\n  const { data: currentSensorsData } = useCurrentSensorsData();\n  const { data: schoolMetadata } = useSchoolMetadata();\n\n  const chartsToRender = loadMoreCharts\n    ? ChartAPIendpointsOrder.length\n    : NUMBER_OF_CHARTS_TO_LOAD_INITIALLY;\n\n  const { themePreference, temperatureUnitPreference } = useContext(PreferenceContext);\n\n  // Temporarily not using HyvorTalk comment anymore\n  // const [displayCommentSection, setDisplayCommentSection] = useState(false);\n\n  const getDashboardTitle = () => {\n    if (schoolMetadata?.school_id) return `Air Quality | ${schoolMetadata?.school_id}`\n  }\n\n  return (\n    <Box width=\"100%\">\n      <AirQualityIndexLegendQuickGlance />\n\n      <FullWidthBox backgroundColor='customAlternateBackground'>\n        <Container sx={{ pt: 2 }}>\n          <Grid container spacing={1.5} sx={{ mb: 4 }}>\n            <Grid item xs={12}>\n              <UppercaseTitle\n                text={getDashboardTitle()}\n                textAlign=\"center\"\n                sx={{ pb: 0 }}\n              />\n            </Grid>\n            <Grid item xs={12}>\n              <GridOfMetadataChips\n              // Temporarily not using HyvorTalk comment anymore\n              // displayCommentSection={displayCommentSection}\n              />\n            </Grid>\n            <Grid item xs={12}>\n              {/* Reserved area that requires an account, even for public schools */}\n              <ProjectReservedArea />\n            </Grid>\n          </Grid>\n        </Container>\n\n        {schoolMetadata?.has_map === true ?\n          (\n            <CurrentAQIMapWithGrid\n              currentSensorsData={currentSensorsData}\n              schoolID={currentSchoolID}\n              isOnBannerPage={false}\n              minMapHeight={\"250px\"}\n            />\n          ) : (\n            <Container sx={{ mb: 2 }}>\n              <CurrentAQIGrid\n                currentSensorsData={currentSensorsData}\n                isScreen={false}\n                temperatureUnitPreference={temperatureUnitPreference}\n              />\n            </Container>\n          )\n        }\n        <Container sx={{ pb: 2 }}>\n          <ProjectDescription />\n          <AQIexplanation />\n        </Container>\n      </FullWidthBox>\n\n      <Box id={sectionData.charts.id}>\n        {ChartAPIendpointsOrder.slice(0, chartsToRender).map((_, index) => (\n          <FullWidthBox\n            key={index}\n            backgroundColor={index % 2 !== 0 ? 'customAlternateBackground' : ''}\n          >\n            <Container\n              sx={{ pt: 4, pb: 4 }}\n              height=\"auto\"\n              className={themePreference === ThemePreferences.dark ? 'dark' : ''}\n              id={`chart-${index + 1}`}\n            >\n\n              <AxesPickerProvider>\n                <ChartComponentWrapper chartID={index} />\n              </AxesPickerProvider>\n\n              {\n                // Optionally display the button to load more charts at the bottom of the last chart\n                // (if not already fetched every chart)\n                index === chartsToRender - 1 && !loadMoreCharts && <LoadMoreButton />\n              }\n            </Container>\n          </FullWidthBox>\n        ))}\n      </Box>\n      <Divider />\n\n      {/* Temporarily not using HyvorTalk comment anymore\n      {displayCommentSection === true &&\n        <FullWidthBox id={sectionData.commentSection.id} sx={{ pt: 3, pb: 4 }}>\n          <CommentSection pageID={HYVOR_PAGE_NAME} />\n        </FullWidthBox>\n      } */}\n    </Box >\n  );\n};\n\nexport default Project;\n\n","import { useEffect, useContext } from \"react\";\n\nimport Project from \"./Project/Project\";\n\nimport { MetadataContext } from \"../ContextProviders/MetadataContext\";\n\nimport { AppRoutes } from \"../Utils/AppRoutes\";\nimport { CITIESair } from \"../Utils/GlobalVariables\";\nimport { DashboardContext } from \"../ContextProviders/DashboardContext\";\n\nconst Dashboard = () => {\n  const { currentSchoolID } = useContext(DashboardContext);\n\n  // Update the page's title based on currentSchoolID\n  useEffect(() => {\n    if (!currentSchoolID) return;\n\n    document.title = `${CITIESair} | ${currentSchoolID.toUpperCase()}`;\n  }, [currentSchoolID]);\n\n  // Update current page type\n  const { setCurrentPage } = useContext(MetadataContext);\n  useEffect(() => {\n    setCurrentPage(AppRoutes.dashboard);\n  }, [setCurrentPage]);\n\n  return (\n    <Project />\n  )\n};\n\nexport default Dashboard;","import { useContext } from 'react';\nimport { Typography, Box } from '@mui/material';\nimport parse from 'html-react-parser';\nimport { replacePlainHTMLWithMuiComponents } from '../../Utils/UtilFunctions';\nimport AirQualityIndexTable from './AirQualityIndexTable';\nimport ExpandableSection from '../ExpandableSection/ExpandableSection';\nimport { PreferenceContext } from '../../ContextProviders/PreferenceContext';\n\nimport InfoIcon from '@mui/icons-material/Info';\n\nconst Explanation = {\n  title: \"Explanation of the US Air Quality Index (AQI) for PM2.5\",\n  subtitle: \"CITIESair uses the <a href='https://www.airnow.gov/aqi/aqi-basics/'>Air Quality Index (AQI)</a> developed by the United States Environmental Protection Agency (EPA) to effectively communicate different levels of PM2.5 air pollution. To calculate the AQI from the raw measurement of PM2.5 concentration (g/m), different breakpoints and piecewise linear function are utilized (read more <a href='https://en.wikipedia.org/wiki/Air_quality_index#United_States'>here</a>). Higher AQI values correspond to poorer air quality and greater heath risks to humans.<br><br>The US EPA sets thresholds for PM2.5 concentration, recently updated in February 2024: <sup>[1]</sup><ul><li><b>Annual average</b>: 9.0 g/m, corresponding to US AQI <b>50</b></li><li><b>24-hour average</b>: 35.0 g/m, corresponding to US AQI <b>100</b></li></ul>In 2021, the World's Heath Organization (WHO) proposed a new guideline for PM2.5<sup>[2]</sup> with stricter thresholds than those of the US EPA:<ul><li><b>Annual average</b>: 5.0 g/m, corresponding to US AQI <b>21</b></li><li><b>24-hour average</b>: 15.0 g/m, corresponding to US AQI <b>56</b></li></ul>\",\n  reference: \"[1] \\\"National Ambient Air Quality Standards (NAAQS) for PM.\\\" EPA, Environmental Protection Agency, https://www.epa.gov/pm-pollution/national-ambient-air-quality-standards-naaqs-pm.<br>[2] World Health Organization. \\\"WHO global air quality guidelines: particulate matter (PM2. 5 and PM10), ozone, nitrogen dioxide, sulfur dioxide and carbon monoxide: executive summary.\\\" (2021).\",\n}\n\nconst AQIexplanation = () => {\n  const { themePreference } = useContext(PreferenceContext);\n\n  return (\n    <ExpandableSection\n      title={Explanation.title}\n      icon={<InfoIcon sx={{ fontSize: \"1rem\" }} />}\n      content={(\n        <Box>\n          <AirQualityIndexTable themePreference={themePreference} />\n          <Typography\n            component=\"div\"\n            variant=\"body1\"\n            color=\"text.secondary\"\n            sx={{ mt: 2 }}\n          >\n            {parse(Explanation.subtitle, {\n              replace: replacePlainHTMLWithMuiComponents,\n            })}\n          </Typography>\n          <ExpandableSection\n            title={\"Reference\"}\n            content={(\n              <Typography variant=\"caption\" color=\"text.secondary\">\n                {parse(Explanation.reference, {\n                  replace: replacePlainHTMLWithMuiComponents,\n                })}\n              </Typography>\n            )}\n          />\n        </Box>\n      )}\n    />\n  )\n};\n\nexport default AQIexplanation;"],"names":["useSchoolMetadata","currentSchoolID","useContext","DashboardContext","useQuery","queryKey","GeneralAPIendpoints","schoolmetadata","queryFn","async","url","getApiUrl","paths","fetchDataFromURL","enabled","staleTime","placeholderData","prev","UppercaseTitle","_ref","text","sx","otherProps","_objectWithoutProperties","_excluded","_jsx","Typography","_objectSpread","variant","color","fontWeight","display","textTransform","pb","lineHeight","children","Skeleton","StyledTable","styled","Table","shouldForwardProp","prop","theme","tiny","minWidth","fontSize","palette","secondary","breakpoints","down","primary","props","themePreference","language","PreferenceContext","hideAQIDescription","returnFormattedBreakpoints","low","high","Infinity","concat","_Fragment","Box","overflow","_jsxs","size","TableHead","TableRow","TableCell","pr","width","height","pl","align","CITIESair","TableBody","AQI_Database","map","element","index","border","backgroundColor","getTranslation","category","whiteSpace","aqiUS","rawPM2_5","description","parse","healthSuggestions","outdoors","replace","replacePlainHTMLWithMuiComponents","StyledAccordion","MuiAccordion","expanded","backgroundImage","background","default","boxShadow","shadows","transition","StyledAccordionSummary","MuiAccordionSummary","_ref2","marginTop","spacing","flexDirection","paddingLeft","textDecoration","main","marginBottom","TooltipText","title","content","icon","disabled","setExpanded","useState","undefined","onChange","panel","event","isExpanded","Tracking","expandSection","collapseSection","section","expandIcon","ArrowDropDownIcon","id","Tooltip","enterDelay","leaveDelay","component","ml","MuiAccordionDetails","pt","SELECT_ALL","SeriesSelector","items","itemsFromChart","selectorID","allowMultiple","seriesLabel","onSeriesSelection","displayChip","useTheme","isLargeScreen","useMediaQuery","up","MenuProps","PaperProps","style","maxHeight","ITEM_HEIGHT","customAlternateBackground","anchorOrigin","vertical","horizontal","transformOrigin","getContentAnchorEl","setItems","selectAll","setSelectAll","useEffect","prevItems","prevMap","Map","i","label","selected","newIt","has","get","every","item","handleChange","target","value","includes","updatedItems","newDataColumns","selectedItems","filter","some","selectedItem","handleItemToggle","existingItem","Stack","direction","alignItems","gap","FormControl","borderRadius","shape","Select","labelId","multiple","renderValue","VisibilityIcon","length","renderedLabel","py","MenuItem","Checkbox","checked","onClick","p","transform","Radio","borderTop","borderColor","position","bottom","zIndex","justifyContent","Switch","Grid","container","Chip","onDelete","hideAnnotations","stem","textStyle","opacity","boxStyle","returnResponsiveFontSizeInPixels","isPortrait","isSmaller","returnChartControlUI","_chartControl$options","chartControl","mainChartData","mainChartOptions","subchartIndex","chartControlUI","options","ui","snapToData","controlType","chartType","chartView","columns","subcharts","chartOptions","hAxis","textPosition","chart","axisText","vAxis","annotations","legend","pointSize","normalizeColorStops","colors","optionalMinValue","optionalMaxValue","isValidArray","offset","totalColors","clampedStops","colorStop","offsets","normalizedOffsets","minOffset","maxOffset","normalizeColorStopOffsets","Math","min","max","rgbToHex","r","g","b","x","hex","toString","join","interpolateColor","color1","color2","factor","result","slice","round","generateDiscreteColorGradientArray","_ref3","numSteps","normalizedColors","forEach","m","exec","parseInt","hexToRgb","colorArray","stepPositions","Array","from","_","pos","offset1","offset2","j","interpolatedColor","push","generateCssBackgroundGradient","_ref4","gradientDirection","BackgroundGradient","_ref6","visibility","x1","y1","x2","y2","stopColor","valueRange","colorAxis","minValue","maxValue","rangeBoxMinValue","rangeBoxMaxValue","calculateMarkerPositionOnRangeBox","labelStyle","textAlign","bottomLabelStyle","triangleStyle","borderLeft","borderRight","topTriangleStyle","top","bottomTriangleStyle","borderBottom","my","float","right","left","day","tooltipText","dateRange","inFirstTwoRowsOfChart","tooltipBoxRef","useRef","current","parentDiv","parentElement","ref","className","mr","getCalendarChartMargin","_options$legend","_options$colorAxis","_options$colorAxis2","_options$colorAxis3","_options$colorAxis4","dataArray","valueRangeBoxTitle","windowSize","setDateRange","setValueRange","calendarHeight","setCalendarHeight","thisDateRange","dateStrings","reduce","getDateRangeForCalendarChart","values","getValueRangeForCalendarChart","numberOfYears","Date","getFullYear","calendarChartMargin","totalHeight","displayLegend","dateStr","date","dayOfWeek","getDay","isFirstTwoDaysOfWeek","firstYear","isInFirstYear","calendarCellColors","gradientSteps","GoogleChartStyleWrapper","ValueRangeBox","overflowY","ResponsiveCalendar","data","to","emptyColor","fill","margin","yearSpacing","monthBorderColor","monthBorderWidth","daySpacing","dayBorderWidth","tooltip","tooltipData","find","DOMParser","parseFromString","body","innerHTML","TooltipCalendarChart","today","yesterday","range","startDate","startOfDay","addHours","endDate","last14Days","addDays","endOfDay","last30Days","last365Days","allTime","minDateOfDataset","formattedMinDate","format","returnCustomStaticRanges","aggregationType","AggregationType","minute","month","year","AggregationTypeMetadata","maxDays","hour","StyledDateRangePicker","Paper","showPickerPanel","smallScreen","padding","maxWidth","action","customBackground","borderTopRightRadius","borderBottomRightRadius","borderTopLeftRadius","borderBottomLeftRadius","pulse","keyframes","_templateObject","_taggedTemplateLiteral","AggregationTypeToggle","setAggregationType","extraSmallScreen","ToggleButtonGroup","fullWidth","exclusive","newType","orientation","Object","type","_AggregationTypeMetad","ToggleButton","px","RadioButtonCheckedIcon","Light","animation","chartID","allChartsConfigs","chartConfig","endpoint","queryParams","chartIndex","isFirstRequest","setIsFirstRequest","enqueueSnackbar","useSnackbar","isFetching","useChartData","updateIndividualChartConfigQueryParams","key","defaultRange","isSameDay","maxAllowedDays","differenceInDays","SnackbarMetadata","error","formattedDates","startDateObject","endDateObject","returnFormattedDates","setShowPickerPanel","paperRef","handleClickOutside","contains","document","addEventListener","removeEventListener","xs","sm","lg","flex","minHeight","elevation","DateRangePicker","ranges","selection","staticRanges","createStaticRanges","inputRanges","rangeColors","minDate","maxDate","months","showMonthAndYearPickers","fixedHeight","preventSnapRefocus","startDatePlaceholder","endDatePlaceholder","editableDateInputs","showMonthArrow","weekStartsOn","AxesPickerContext","createContext","AxesPickerProvider","setHAxis","setVAxis","contextValue","useMemo","Provider","SELECT_MIN_WIDTH","LeftSelect","between","RightSelect","setIndividualChartConfig","allowedAxes","selectedAxes","dataType","shouldDisableApplyButton","setShouldDisableApplyButton","receivedHAxis","receivedVAxis","shouldDisableOption","option","allowedDataTypes","rowGap","columnGap","InputLabel","autoWidth","sensor","Button","applyChanges","sensorX","sensorY","customMessage","selectableAxes","messagePrefix","messageSuffix","Alert","severity","returnHoursFromMinutesPastMidnight","minutes","floor","padStart","HOURS","minutesPastMidnight","PREDEFINED_TIMERANGES","allday","start","end","timeRangeLabel","schoolHour","custom","SimplePicker","isExtraSmall","verticalAlign","marginLeft","is","timeRange","defaultTimeRange","isResponsive","hasTitle","displayFromToPickers","setDisplayFromToPickers","startTime","endTime","predefinedRange","setPredefinedRange","match","handleModeChange","useCallback","newMode","WatchLaterIcon","mt","idx","arr","e","h","setTimeRange","TimeRangeSelector","newRange","SubChart","_chartData$subcharts","chartData","selectedDataType","google","GoogleContext","dataTable","setDataTable","chartWrapper","setChartWrapper","controlWrapper","setControlWrapper","previousChartData","setPreviousChartData","isFirstRender","setIsFirstRender","shouldRenderChart","setShouldRenderChart","renderChartNow","setRenderChartNow","allInitialColumns","setAllInitialColumns","dataColumns","setDataColumns","initialVAxisRange","setInitialVAxisRage","__","random","substr","_chartData$subcharts$","_chartData$options","_chartData$options2","_chartData$options2$b","_chartData$options3","_chartData$options4","_chartData$options4$c","_chartData$options4$c2","_chartData$options5","_chartData$options5$c","_chartData$options5$c2","_chartData$options6","_chartData$options6$c","_chartData$options6$c2","_chartData$options7","_chartData$options7$c","_chartData$options7$c2","_chartData$options8","_chartData$options8$w","_chartData$options9","_chartData$options9$w","_chartData$options$le","_chartData$options0","_chartData$options0$l","_options$vAxis$format","_options$vAxis","_options$vAxis$title","_options$vAxis2","_options$vAxis$viewWi","_options$vAxis3","_options$vAxis3$viewW","_options$vAxis$viewWi2","_options$vAxis4","_options$vAxis4$viewW","_options$vAxis$viewWi3","_options$vAxis5","_options$vAxis5$viewW","_options$hAxis$title","_options$hAxis","_options$vAxis6","_options$vAxis7","_options$vAxis7$gridl","_options$hAxis2","_options$hAxis3","_options$hAxis3$gridl","_options$hAxis4","_options$hAxis5","_options$hAxis5$gridl","_options$annotations","axisTitleTextStyle","italic","bold","axisTitle","axisTextStyle","curveType","crosshair","trigger","chartArea","portrait","landscape","isHtml","showColorCode","alignment","scrollArrows","activeColor","inactiveColor","pagingTextStyle","viewWindow","slantedText","slantedTextAngle","optionsColors","series","_serie","serie","trendlines","_item","colorAxisFirstColor","multiColor","colorIndex","NYUpurple","colorAxes","_unused","titleTextStyle","gridlines","minorGridlines","count","highContrast","contrastText","thickness","rx","ry","annotationBoxFill","fillOpacity","returnGenericOptions","calendarDataArray","setCalendarDataArray","NivoCalendarChart","returnSelectedDataType","dataTypeKey","dataTypes","showUnit","NoChartToRender","LoadingAnimation","chartControlOptions","hasChartControl","control","cleanupTouchEventListener","touchHandler","first","changedTouches","simulatedEvent","MouseEvent","bubbles","cancelable","view","window","detail","screenX","screenY","clientX","clientY","button","relatedTarget","dispatchEvent","preventDefault","isMounted","controlDOM","querySelector","touchEvent","capture","addTouchEventListenerForChartControl","seriesSelector","dateRangePicker","timeRangeSelector","formatters","hasAtLeastOneAuxillaryControl","handleSeriesSelection","setOptions","draw","method","setInitialColumnsColors","col","_options$series2","seriesIndex","serieAttribute","getInitialVAxisRange","vAxisMin","vAxisMax","getColumnRange","sourceColumn","isNaN","_allInitialColumns","_chartWrapper","_controlWrapper","hiddenSeriesObject","enableInteractivity","visibleInLegend","currentControlOptions","getOptions","newViewColumns","dataColumn","indexIn_","role","setView","newOptions","selectedSeriesCount","JSON","stringify","_shouldRenderChart","visualization","arrayToDataTable","hasOwnProperty","numberFormat","NumberFormat","numberFormatter","reconstructedColumns","evaluatedColumns","column","calc","calcFunction","Function","reconstructFunctionFromJSONstring","thisChartWrapper","ChartWrapper","containerId","thisControlWrapper","thisDashboardWrapper","Dashboard","getElementById","events","addListener","onChartReady","ControlWrapper","bind","initAllInitialColumns","initDataColumns","prevSelections","c","initialView","getView","viewFromDataTable","DataView","shouldAssignDomainRoleToFistColumn","dataSeriesIndex","getColumnLabel","indexInAllInitialColumns","defaultSeriesToDisplayInitially","dataCols","_options$series","_options$series$col$s","getInitialColumns","gradientBackgroundColor","gradientBackgroundId","svgFillGradient","_options$vAxis2$viewW","_ref5","generateSvgFillGradient","CustomDateRangePicker","AxesPicker","TimeRangeSelectorWrapperForDataHook","parseFloat","wordLimit","reference","setIsExpanded","isMobile","subtitleRef","words","split","displayText","lastFullStop","lastIndexOf","ClickAwayListener","onClickAway","subtitleParent","closest","chartElements","Set","_target","tagName","parentNode","isClickWithinSharedParent","cursor","anchorEl","setAnchorEl","name_title","open","Boolean","handleClose","currentTarget","Menu","onClose","MenuListProps","handleMenuItemClick","Tabs","smallFontSize","ChartStyleWrapper","mode","overflowX","scrollbarGutter","StyledMenuItem","isLoading","isSmallWidth","setIsPortrait","matchMedia","matches","setWindowSize","innerWidth","innerHeight","currentTab","setCurrentTab","previousTab","setPreviousTab","dropdownMenuTabIndex","setDropdownMenuTabIndex","dropdownMenuCurrentTitle","setDropdownMenuCurrentTitle","setAllowedDataTypes","setSelectedDataType","chartHeight","chartMaxHeight","initializeAllowedDataTypes","name_short","unit","DataTypes","cleanupResize","setupResizeListener","DEBOUNCE_IN_MILLISECONDS","timeoutID","handleWindowResize","clearTimeout","setTimeout","optionalText","DataTypeDropDownMenu","pointerEvents","renderMultipleSubcharts","needsDropdownMenu","MAX_NUM_TABS_TO_DISPLAY","subchartsDataForTabs","subchartsDataForDropDownMenu","shouldDisplayThisSubchart","StyledTabs","handleTabChange","newIndex","Tab","subchartTitle","ExpandMoreIcon","subchartTitleShort","handleDropdownMenuSelection","WebkitOverflowScrolling","currentSubchart","mb","CollapsibleSubtitle","getSubtitles","subtitle","subchartSubtitle","getReferences","_chartData$subcharts$2","AirQualityIndexLegendQuickGlance","handlePopperOpen","airQualityIndexLegendQuickGlance","handlePopperClose","FadeInButtonForSpeedDial","distanceFromBottomOfWindow","Fab","onMouseEnter","onMouseLeave","AirIcon","Popper","placement","keepMounted","TransitionProps","Fade","timeout","mx","AirQualityIndexTable","ScreenDropDownMenu","schoolMetadata","navigate","useNavigate","screens","handleSingleScreenClick","_screens$","screen_name","TvIcon","handleMenuClose","screen","screenName","location_long","buttonIcon","buttonIconAria","buttonLabel","buttonVariant","trackingEvent","dialogTitle","dialogOpenHandler","dialogCloseHandler","displaySchoolID","iconOnly","setOpen","onOpen","IconButton","Dialog","fullScreen","DialogActions","ChevronLeftIcon","DialogTitle","toUpperCase","DialogContent","openLoginPopup","authenticationState","user","UserContext","loggedIn","authenticated","checkedAuthentication","handleRestrictedAccess","allowedSchools","school","school_id","isSample","raw","extension","SupportedFetchExtensions","csv","retry","DatasetDownloadDialog","onButtonClick","useLoginHandler","currentSensorsData","useCurrentSensorsData","sensorsList","setSensorsList","previewingDataset","setPreviewingDataset","acc","location_short","keys","CustomDialog","DataObjectIcon","rawDatasetButtonClicked","md","tableLayout","Dataset","isPreviewing","PreviewDataset","fontStyle","Link","href","NYUpurpleLight","setThisSensorToPreview","selectedVal","disablePortal","charAt","toLowerCase","previewData","isPreviewDataLoading","useDatasetDownload","refetch","refetchFullData","previewingDatasetName","setPreviewingDatasetName","csvFileName","setCsvFileName","formattedData","setFormattedData","rowNumber","setRowNumber","lines","headers","rows","dateString","row","fontFamily","gutterBottom","userSelect","blob","Blob","URL","createObjectURL","downloadLink","createElement","download","appendChild","click","revokeObjectURL","removeChild","rawDatasetDownloaded","dataset_type","err","DownloadIcon","compareArrays","arr1","arr2","EmailsInput","queryPaths","alertsEmails","alertEmails","needsAuthorization","queryClient","useQueryClient","saveEmailsMutation","useMutation","mutationFn","restMethod","RESTmethods","POST","emailsToSave","onSuccess","setQueryData","success","onError","localEmails","setLocalEmails","emailsListChanged","setEmailsListChanged","currentEmail","setCurrentEmail","menuAnchor","setMenuAnchor","saveButtonTooltipTitle","setSaveButtonTooltipTitle","handleAddEmail","passedEmail","isBulkAdding","arguments","email","trim","startsWith","endsWith","validateEmail","warning","handleDeleteEmail","newEmails","wrapperRef","inputRef","prevInputRef","allSelected","setAllSelected","handleGlobalKeyDown","isMeta","metaKey","ctrlKey","isInputFocused","activeElement","navigator","clipboard","writeText","then","catch","info","focus","preventScroll","handleDocumentClick","handleMenuOpen","handleBeforeUnload","returnValue","wrap","tabIndex","flexWrap","outline","onContextMenu","TextField","tmp","native","nativeEvent","inputType","isComposing","maybeEmail","autofillLike","test","jumpedIn","onKeyUp","onPaste","pastedText","clipboardData","getData","emails","placeholder","InputProps","disableUnderline","enterTouchDelay","_emails","mutate","isPending","CircularProgress","disableShrink","emailToCopy","handleCopyEmail","AlertTypes","threshold","name","tableColumnHeader","SpeedIcon","daily","CalendarMonthIcon","ThresholdAlertTypes","below_threshold","sign","above_threshold","CrudTypes","SharedColumnHeader","AirQualityAlertKeys","getAlertDefaultPlaceholder","localAlertType","localOppositeAlertType","alert_type","addChildToAlerts","processed","alert","parent","a","AlertDeletionDialog","onConfirmedDelete","DialogContentText","DialogData","primaryButtonLabel","errorMessage","successMessage","contentText","maxLength","showTip","currentLength","multiline","minRows","maxRows","inputProps","DAYS_OF_WEEK","CustomPickersDay","PickersDay","common","white","dark","CustomDayComponent","selectedDates","other","isSelected","dayjs","MultiDaysCalendarPicker","parsedSelectedDates","len","LocalizationProvider","dateAdapter","AdapterDayjs","localeText","calendarWeekNumberHeaderText","calendarWeekNumberText","weekNumber","DateCalendar","displayWeekNumber","slots","dayProps","selectionState","disableHighlightToday","startOf","DateSelector","daysOfWeek","excludedDates","handleDaysOfWeekChange","handleExcludedDatesChange","rowSpacing","columnSpacing","arrow","ThresholdSlider","defaultValue","stepsForThreshold","marks","backgroundCssGradient","invertSelection","showInput","inputUnit","valueLabelDisplay","sliderRangeMin","setSliderRangeMin","sliderRangeMax","setSliderRangeMax","nearestDataIndex","setNearestDataIndex","setError","helperText","setHelperText","findNearestDataIndex","val","greaterMarks","mark","nearestMark","curr","indexOf","localSliderRangeMin","localSliderRangeMax","stripedGradient","sliderSX","black","paper","paperBackgroundGradient","Number","step","Slider","getAriaLabel","handleSliderChange","newValue","AirQualityAlertContext","AirQualityAlertProvider","selectedAlert","setSelectedAlert","editingAlert","setEditingAlert","allowedDataTypesForSensor","setAllowedDataTypesForSensor","returnAllowedDataTypesForThisSensor","sensors","sensorData","elem","sensor_id","allowedDataTypesForThisSensor","ThresholdComponentWrapper","handleValueChange","placeholderValueBeforeDataTypeSelection","disabledSlider","thresholdSlider","currentDataTypeKey","dataTypeColorAxis","color_axis","defaultValueForAlert","database","DataTypeKeys","voc","VOC_Database","aqi","pm2_5","pm10_raw","co2","heat_index_C","HeatIndex_Database","threshold_mapping_name","MaxOnceADayCheckbox","FormGroup","FormControlLabel","FormHelperText","ThresholdTypeToggle","currentAlertType","others","thresholdAlertType","ThresholdType","_excluded2","returnFormattedStatusString","status","tense","AlertPropertyComponents","_schoolMetadata$senso","_DialogData$crudType","_editingAlert$AirQual","_editingAlert$AirQual2","alertTypeKey","crudType","allSensorsOfSchool","capitalizePhrase","isDisabled","PlaceIcon","_theme$palette$chart$","_theme$palette$chart$2","selectedDataTypeKey","defaultValueForChildAlert","validDaysOfWeek","isArray","sort","valueArray","currentExcludedDates","updatedExcludedDates","excludedDate","displayHourPicker","AccessTimeIcon","selectedAlertType","oppositeAlertTypeForChildAlert","disabledToggle","OptionalMessage","useEditAlertMutation","alertId","alertToEdit","alerts","PUT","editedAlert","username","openAlertModificationDialog","shouldDisableButton","setShouldDisableButton","removeChildAlertFromParentAlertBody","newBody","formatChildAlertBody","parent_alert_id","handleSuccess","passedCrudType","handleError","handleAlertModification","sanityCheckAlertBeforeSaving","valid","isAbove","childThreshold","message","createAlertMutation","alertToCreate","createdAlert","alert_id","editAlertMutation","child_alert_id","formattedChildAlert","deleteAlertMutation","_editingAlert$AirQual3","_editingAlert$AirQual4","alertVal","datatypeKeyVal","isEqual","useCreateAlertMutation","useDeleteAlertMutation","DELETE","updated","returnDaysOfWeekString","days_of_week","missingDays","d","_DAYS_OF_WEEK$find","returnAlertNotModifiableString","owner_role","is_allowed_to_modify","UserRoles","_AlertTypes$alertType","alertsForTable","setOpenAlertModificationDialog","setCrudType","handleModifyClick","TransitionGroup","Grow","newIsEnabled","handleAlertEnableToggling","EditIcon","self_is_owner","returnCreatedByString","startIcon","AddAlarmIcon","AlertModificationDialog","AlertTab","alertType","alertsArray","hidden","AlertsTable","AlertsTabs","useAlerts","_queryResult$data","queryResult","refetchOnWindowFocus","returnFilteredAlerts","filteredAlerts","_alert$AirQualityAler","parentAlertId","array","alertsLength","newVal","_AlertTypes$Object$ke","_Object$keys","iconPosition","AirQualityAlerts","isModifiable","admin","user_role","NotificationImportantIcon","onLoginSuccess","popupRef","setAuthenticationState","setUser","showVerificationDialog","setShowVerificationDialog","setEmail","popup","AppRoutes","login","intervalId","setInterval","closed","clearInterval","handleMessage","origin","location","LoginTypes","password","is_verified","EmailVerificationDialog","ProjectReservedArea","LoginPopupHandler","handleLoginSuccess","duration","tooltipTitle","chip","returnChipLabel","ArrowDropUpIcon","SchoolSelector","CustomChip","clickable","MenuList","dense","newSchoolID","localStorage","setItem","LocalStorage","schoolID","internalNavigation","origin_school","destination_school_id","origin_id","dashboard","GridOfMetadataChips","PersonIcon","contactPerson","contactEmail","ProjectDescription","LoadMoreButton","loadMoreCharts","setLoadMoreCharts","KeyboardArrowDownIcon","Project","chartsToRender","ChartAPIendpointsOrder","NUMBER_OF_CHARTS_TO_LOAD_INITIALLY","temperatureUnitPreference","FullWidthBox","Container","getDashboardTitle","has_map","CurrentAQIMapWithGrid","isOnBannerPage","minMapHeight","CurrentAQIGrid","isScreen","AQIexplanation","sectionData","ThemePreferences","ChartComponentWrapper","Divider","setCurrentPage","MetadataContext","Explanation","ExpandableSection","InfoIcon"],"sourceRoot":""}